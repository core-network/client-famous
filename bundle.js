!function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){"use strict";function r(t){i.call(this,t);var e=t.getAlign();this._x.set(e[0]),this._y.set(e[1]),this._z.set(e[2])}var i=t("./Position");r.prototype.toString=function(){return"Align"},r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.update=function(){this._node.setAlign(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},r.prototype.onUpdate=r.prototype.update,e.exports=r},{"./Position":7}],2:[function(t,e,n){"use strict";function r(t){this._node=t,this._projectionType=r.ORTHOGRAPHIC_PROJECTION,this._focalDepth=0,this._near=0,this._far=0,this._requestingUpdate=!1,this._id=t.addComponent(this),this._viewTransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._viewDirty=!1,this._perspectiveDirty=!1,this.setFlat()}var i=t("../core/Commands");r.FRUSTUM_PROJECTION=0,r.PINHOLE_PROJECTION=1,r.ORTHOGRAPHIC_PROJECTION=2,r.prototype.toString=function(){return"Camera"},r.prototype.getValue=function(){return{component:this.toString(),projectionType:this._projectionType,focalDepth:this._focalDepth,near:this._near,far:this._far}},r.prototype.setValue=function(t){return this.toString()===t.component?(this.set(t.projectionType,t.focalDepth,t.near,t.far),!0):!1},r.prototype.set=function(t,e,n,r){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._projectionType=t,this._focalDepth=e,this._near=n,this._far=r},r.prototype.setDepth=function(t){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=r.PINHOLE_PROJECTION,this._focalDepth=t,this._near=0,this._far=0,this},r.prototype.setFrustum=function(t,e){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=r.FRUSTUM_PROJECTION,this._focalDepth=0,this._near=t,this._far=e,this},r.prototype.setFlat=function(){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=r.ORTHOGRAPHIC_PROJECTION,this._focalDepth=0,this._near=0,this._far=0,this},r.prototype.onUpdate=function(){this._requestingUpdate=!1;var t=this._node.getLocation();if(this._node.sendDrawCommand(i.WITH).sendDrawCommand(t),this._perspectiveDirty)switch(this._perspectiveDirty=!1,this._projectionType){case r.FRUSTUM_PROJECTION:this._node.sendDrawCommand(i.FRUSTRUM_PROJECTION),this._node.sendDrawCommand(this._near),this._node.sendDrawCommand(this._far);break;case r.PINHOLE_PROJECTION:this._node.sendDrawCommand(i.PINHOLE_PROJECTION),this._node.sendDrawCommand(this._focalDepth);break;case r.ORTHOGRAPHIC_PROJECTION:this._node.sendDrawCommand(i.ORTHOGRAPHIC_PROJECTION)}this._viewDirty&&(this._viewDirty=!1,this._node.sendDrawCommand(i.CHANGE_VIEW_TRANSFORM),this._node.sendDrawCommand(this._viewTransform[0]),this._node.sendDrawCommand(this._viewTransform[1]),this._node.sendDrawCommand(this._viewTransform[2]),this._node.sendDrawCommand(this._viewTransform[3]),this._node.sendDrawCommand(this._viewTransform[4]),this._node.sendDrawCommand(this._viewTransform[5]),this._node.sendDrawCommand(this._viewTransform[6]),this._node.sendDrawCommand(this._viewTransform[7]),this._node.sendDrawCommand(this._viewTransform[8]),this._node.sendDrawCommand(this._viewTransform[9]),this._node.sendDrawCommand(this._viewTransform[10]),this._node.sendDrawCommand(this._viewTransform[11]),this._node.sendDrawCommand(this._viewTransform[12]),this._node.sendDrawCommand(this._viewTransform[13]),this._node.sendDrawCommand(this._viewTransform[14]),this._node.sendDrawCommand(this._viewTransform[15]))},r.prototype.onTransformChange=function(t){var e=t;this._viewDirty=!0,this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],l=e[9],p=e[10],f=e[11],d=e[12],g=e[13],v=e[14],m=e[15],_=n*a-r*s,y=n*u-i*s,b=n*h-o*s,w=r*u-i*a,x=r*h-o*a,T=i*h-o*u,E=c*g-l*d,I=c*v-p*d,A=c*m-f*d,C=l*v-p*g,R=l*m-f*g,S=p*m-f*v,O=1/(_*S-y*R+b*C+w*A-x*I+T*E);this._viewTransform[0]=(a*S-u*R+h*C)*O,this._viewTransform[1]=(i*R-r*S-o*C)*O,this._viewTransform[2]=(g*T-v*x+m*w)*O,this._viewTransform[3]=(p*x-l*T-f*w)*O,this._viewTransform[4]=(u*A-s*S-h*I)*O,this._viewTransform[5]=(n*S-i*A+o*I)*O,this._viewTransform[6]=(v*b-d*T-m*y)*O,this._viewTransform[7]=(c*T-p*b+f*y)*O,this._viewTransform[8]=(s*R-a*A+h*E)*O,this._viewTransform[9]=(r*A-n*R-o*E)*O,this._viewTransform[10]=(d*x-g*b+m*_)*O,this._viewTransform[11]=(l*b-c*x-f*_)*O,this._viewTransform[12]=(a*I-s*C-u*E)*O,this._viewTransform[13]=(n*C-r*I+i*E)*O,this._viewTransform[14]=(g*y-d*w-v*_)*O,this._viewTransform[15]=(c*w-l*y+p*_)*O},e.exports=r},{"../core/Commands":15}],3:[function(t,e,n){"use strict";function r(t,e){this.node=t,this.id=t.addComponent(this),this._events=new u,this.last1=new h,this.last2=new h,this.delta1=new h,this.delta2=new h,this.velocity1=new h,this.velocity2=new h,this.dist=0,this.diff12=new h,this.center=new h,this.centerDelta=new h,this.centerVelocity=new h,this.pointer1={position:this.last1,delta:this.delta1,velocity:this.velocity1},this.pointer2={position:this.last2,delta:this.delta2,velocity:this.velocity2},this.event={status:null,time:0,pointers:[],center:this.center,centerDelta:this.centerDelta,centerVelocity:this.centerVelocity,points:0,current:0},this.trackedPointerIDs=[-1,-1],this.timeOfPointer=0,this.multiTap=0,this.mice=[],this.gestures=[],this.options={},this.trackedGestures={};var n,r;if(e)for(n=0,r=e.length;r>n;n++)this.on(e[n],e[n].callback);t.addUIEvent("touchstart"),t.addUIEvent("mousedown"),t.addUIEvent("touchmove"),t.addUIEvent("mousemove"),t.addUIEvent("touchend"),t.addUIEvent("mouseup"),t.addUIEvent("mouseleave")}function i(t){var e;if(t.targetTouches?e=t.targetTouches:(this.mice[0]=t,e=this.mice,t.identifier=1),!e[0]||!e[1]||this.trackedPointerIDs[0]!==e[0].identifier||this.trackedPointerIDs[1]!==e[1].identifier){this.event.time=Date.now();var n,r;this.trackedPointerIDs[0]!==e[0].identifier&&(this.trackedGestures.tap&&(n=this.options.tap&&this.options.tap.threshold||250,this.event.time-this.timeOfPointer<n?this.event.taps++:this.event.taps=1,this.timeOfPointer=this.event.time,this.multiTap=1),this.event.current=1,this.event.points=1,r=e[0].identifier,this.trackedPointerIDs[0]=r,this.last1.set(e[0].pageX,e[0].pageY),this.velocity1.clear(),this.delta1.clear(),this.event.pointers.push(this.pointer1)),e[1]&&this.trackedPointerIDs[1]!==e[1].identifier&&(this.trackedGestures.tap&&(n=this.options.tap&&this.options.tap.threshold||250,this.event.time-this.timeOfPointer<n&&(this.multiTap=2)),this.event.current=2,this.event.points=2,r=e[1].identifier,this.trackedPointerIDs[1]=r,this.last2.set(e[1].pageX,e[1].pageY),this.velocity2.clear(),this.delta2.clear(),h.add(this.last1,this.last2,this.center).scale(.5),this.centerDelta.clear(),this.centerVelocity.clear(),h.subtract(this.last2,this.last1,this.diff12),this.dist=this.diff12.length(),this.trackedGestures.pinch&&(this.event.scale=this.event.scale||1,this.event.scaleDelta=0,this.event.scaleVelocity=0),this.trackedGestures.rotate&&(this.event.rotation=this.event.rotation||0,this.event.rotationDelta=0,this.event.rotationVelocity=0),this.event.pointers.push(this.pointer2)),this.event.status="start",1===this.event.points&&(this.center.copy(this.last1),this.centerDelta.clear(),this.centerVelocity.clear(),this.trackedGestures.pinch&&(this.event.scale=1,this.event.scaleDelta=0,this.event.scaleVelocity=0),this.trackedGestures.rotate&&(this.event.rotation=0,this.event.rotationDelta=0,this.event.rotationVelocity=0)),this.triggerGestures()}}function o(t){var e;if(t.targetTouches)e=t.targetTouches;else{if(!this.event.current)return;this.mice[0]=t,e=this.mice,t.identifier=1}var n=Date.now(),r=n-this.event.time;if(0!==r){var i=1e3/r;if(this.event.time=n,this.event.current=1,this.event.points=1,this.trackedPointerIDs[0]===e[0].identifier&&(c.set(e[0].pageX,e[0].pageY),h.subtract(c,this.last1,this.delta1),h.scale(this.delta1,i,this.velocity1),this.last1.copy(c)),e[1]){if(this.event.current=2,this.event.points=2,c.set(e[1].pageX,e[1].pageY),h.subtract(c,this.last2,this.delta2),h.scale(this.delta2,i,this.velocity2),this.last2.copy(c),h.add(this.last1,this.last2,c).scale(.5),h.subtract(c,this.center,this.centerDelta),h.add(this.velocity1,this.velocity2,this.centerVelocity).scale(.5),this.center.copy(c),h.subtract(this.last2,this.last1,c),this.trackedGestures.rotate){var o=c.dot(this.diff12),s=c.cross(this.diff12),a=-Math.atan2(s,o);this.event.rotation+=a,this.event.rotationDelta=a,this.event.rotationVelocity=a*i}var u=c.length(),l=u/this.dist;this.diff12.copy(c),this.dist=u,this.trackedGestures.pinch&&(this.event.scale*=l,l-=1,this.event.scaleDelta=l,this.event.scaleVelocity=l*i)}this.event.status="move",1===this.event.points&&(this.center.copy(this.last1),this.centerDelta.copy(this.delta1),this.centerVelocity.copy(this.velocity1),this.trackedGestures.pinch&&(this.event.scale=1,this.event.scaleDelta=0,this.event.scaleVelocity=0),this.trackedGestures.rotate&&(this.event.rotation=0,this.event.rotationDelta=0,this.event.rotationVelocity=0)),this.triggerGestures()}}function s(t){var e;if(t.targetTouches)e=t.targetTouches;else{if(!this.event.current)return;this.mice.pop(),e=this.mice}if(!e[0]||!e[1]||this.trackedPointerIDs[0]!==e[0].identifier||this.trackedPointerIDs[1]!==e[1].identifier){var n;if(this.event.status="end",!e[0])return this.event.current=0,this.trackedPointerIDs[0]=-1,this.trackedPointerIDs[1]=-1,this.triggerGestures(),this.event.pointers.pop(),void this.event.pointers.pop();this.trackedPointerIDs[0]!==e[0].identifier&&(this.trackedPointerIDs[0]=-1,n=e[0].identifier,this.trackedPointerIDs[0]=n,this.last1.set(e[0].pageX,e[0].pageY),this.velocity1.clear(),this.delta1.clear()),e[1]?this.trackedPointerIDs[1]!==e[1].identifier&&(this.trackedPointerIDs[1]=-1,this.event.points=2,n=e[1].identifier,this.trackedPointerIDs[1]=n,this.last2.set(e[1].pageX,e[1].pageY),this.velocity2.clear(),this.delta2.clear(),h.add(this.last1,this.last2,this.center).scale(.5),this.centerDelta.clear(),this.centerVelocity.clear(),h.subtract(this.last2,this.last1,this.diff12),this.dist=this.diff12.length()):(this.event.current=1,this.trackedPointerIDs[1]=-1,this.triggerGestures(),this.event.points=1,this.event.pointers.pop())}}function a(){this.event.current&&(this.event.status="end",this.event.current=0,this.trackedPointerIDs[0]=-1,this.triggerGestures(),this.event.pointers.pop())}var u=t("../utilities/CallbackStore"),h=t("../math/Vec2"),c=new h,l={drag:!0,tap:!0,rotate:!0,pinch:!0};r.prototype.onReceive=function(t,e){switch(t){case"touchstart":case"mousedown":i.call(this,e);break;case"touchmove":case"mousemove":o.call(this,e);break;case"touchend":case"mouseup":s.call(this,e);break;case"mouseleave":a.call(this,e)}},r.prototype.toString=function(){return"GestureHandler"},r.prototype.on=function(t,e){var n=t.event||t;l[n]&&(this.trackedGestures[n]=!0,this.gestures.push(n),t.event&&(this.options[n]=t),this._events.on(n,e))},r.prototype.triggerGestures=function(){for(var t=this.event,e=0,n=this.gestures.length;n>e;e++){var r=this.gestures[e];switch(r){case"rotate":case"pinch":2===t.points&&this.trigger(r,t);break;case"tap":if("start"===t.status)if(this.options.tap){var i=this.options.tap.points||1;this.multiTap>=i&&t.points>=i&&this.trigger(r,t)}else this.trigger(r,t);break;default:this.trigger(r,t)}}},r.prototype.trigger=function(t,e){this._events.trigger(t,e)},e.exports=r},{"../math/Vec2":49,"../utilities/CallbackStore":94}],4:[function(t,e,n){"use strict";function r(t){i.call(this,t);var e=t.getMountPoint();this._x.set(e[0]),this._y.set(e[1]),this._z.set(e[2])}var i=t("./Position");r.prototype.toString=function(){return"MountPoint"},r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.update=function(){this._node.setMountPoint(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},r.prototype.onUpdate=r.prototype.update,e.exports=r},{"./Position":7}],5:[function(t,e,n){"use strict";function r(t){this._node=t,this._id=t.addComponent(this),this._value=new i(1),this._requestingUpdate=!1}var i=t("../transitions/Transitionable");r.prototype.toString=function(){return"Opacity"},r.prototype.getValue=function(){return{component:this.toString(),value:this._value.get()}},r.prototype.setValue=function(t){return this.toString()===t.component?(this.set(t.value),!0):!1},r.prototype.set=function(t,e,n){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._value.set(t,e,n),this},r.prototype.get=function(){return this._value.get()},r.prototype.halt=function(){return this._value.halt(),this},r.prototype.isActive=function(){return this._value.isActive()},r.prototype.update=function(){this._node.setOpacity(this._value.get()),this._value.isActive()?this._node.requestUpdateOnNextTick(this._id):this._requestingUpdate=!1},r.prototype.onUpdate=r.prototype.update,e.exports=r},{"../transitions/Transitionable":92}],6:[function(t,e,n){"use strict";function r(t){i.call(this,t);var e=t.getOrigin();this._x.set(e[0]),this._y.set(e[1]),this._z.set(e[2])}var i=t("./Position");r.prototype.toString=function(){return"Origin"},r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.update=function(){this._node.setOrigin(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},r.prototype.onUpdate=r.prototype.update,e.exports=r},{"./Position":7}],7:[function(t,e,n){"use strict";function r(t){this._node=t,this._id=t.addComponent(this),this._requestingUpdate=!1;var e=t.getPosition();this._x=new i(e[0]),this._y=new i(e[1]),this._z=new i(e[2])}var i=t("../transitions/Transitionable");r.prototype.toString=function(){return"Position"},r.prototype.getValue=function(){return{component:this.toString(),x:this._x.get(),y:this._y.get(),z:this._z.get()}},r.prototype.setValue=function(t){return this.toString()===t.component?(this.set(t.x,t.y,t.z),!0):!1},r.prototype.getX=function(){return this._x.get()},r.prototype.getY=function(){return this._y.get()},r.prototype.getZ=function(){return this._z.get()},r.prototype.isActive=function(){return this._x.isActive()||this._y.isActive()||this._z.isActive()},r.prototype._checkUpdate=function(){this.isActive()?this._node.requestUpdateOnNextTick(this._id):this._requestingUpdate=!1},r.prototype.update=function(){this._node.setPosition(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},r.prototype.onUpdate=r.prototype.update,r.prototype.setX=function(t,e,n){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._x.set(t,e,n),this},r.prototype.setY=function(t,e,n){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._y.set(t,e,n),this},r.prototype.setZ=function(t,e,n){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._z.set(t,e,n),this},r.prototype.set=function(t,e,n,r,i){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var o,s,a;return null!=n?a=i:null!=e?s=i:null!=t&&(o=i),null!=t&&this._x.set(t,r,o),null!=e&&this._y.set(e,r,s),null!=n&&this._z.set(n,r,a),this},r.prototype.halt=function(){return this._x.halt(),this._y.halt(),this._z.halt(),this},e.exports=r},{"../transitions/Transitionable":92}],8:[function(t,e,n){"use strict";function r(t){i.call(this,t);var e=t.getRotation(),n=e[0],r=e[1],o=e[2],s=e[3],a=n*n,u=r*r,h=o*o,c=2*(n*o+r*s);c=-1>c?-1:c>1?1:c;var l=Math.atan2(2*(n*s-r*o),1-2*(a+u)),p=Math.asin(c),f=Math.atan2(2*(o*s-n*r),1-2*(u+h));this._x.set(l),this._y.set(p),this._z.set(f)}var i=t("./Position");r.prototype.toString=function(){return"Rotation"},r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.update=function(){this._node.setRotation(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},r.prototype.onUpdate=r.prototype.update,e.exports=r},{"./Position":7}],9:[function(t,e,n){"use strict";function r(t){i.call(this,t),this._x.set(1),this._y.set(1),this._z.set(1)}var i=t("./Position");r.prototype.toString=function(){return"Scale"},r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.update=function(){this._node.setScale(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},r.prototype.onUpdate=r.prototype.update,e.exports=r},{"./Position":7}],10:[function(t,e,n){"use strict";function r(t){this._node=t,this._id=t.addComponent(this),this._requestingUpdate=!1;var e=t.getProportionalSize(),n=t.getDifferentialSize(),r=t.getAbsoluteSize();this._proportional={x:new i(e[0]),y:new i(e[1]),z:new i(e[2])},this._differential={x:new i(n[0]),y:new i(n[1]),z:new i(n[2])},this._absolute={x:new i(r[0]),y:new i(r[1]),z:new i(r[2])}}var i=t("../transitions/Transitionable");r.RELATIVE=0,r.ABSOLUTE=1,r.RENDER=2,r.DEFAULT=r.RELATIVE,r.prototype.setMode=function(t,e,n){return this._node.setSizeMode(t,e,n),this},r.prototype.toString=function(){return"Size"},r.prototype.getValue=function(){return{sizeMode:this._node.value.sizeMode,absolute:{x:this._absolute.x.get(),y:this._absolute.y.get(),z:this._absolute.z.get()},differential:{x:this._differential.x.get(),y:this._differential.y.get(),z:this._differential.z.get()},proportional:{x:this._proportional.x.get(),y:this._proportional.y.get(),z:this._proportional.z.get()}}},r.prototype.setValue=function(t){return this.toString()===t.component&&(this.setMode.apply(this,t.sizeMode),t.absolute&&this.setAbsolute(t.absolute.x,t.absolute.y,t.absolute.z),t.differential&&this.setAbsolute(t.differential.x,t.differential.y,t.differential.z),t.proportional&&this.setAbsolute(t.proportional.x,t.proportional.y,t.proportional.z)),!1},r.prototype._isActive=function(t){return t.x.isActive()||t.y.isActive()||t.z.isActive()},r.prototype.isActive=function(){return this._isActive(this._absolute)||this._isActive(this._proportional)||this._isActive(this._differential)},r.prototype.onUpdate=function(){var t=this._absolute;this._node.setAbsoluteSize(t.x.get(),t.y.get(),t.z.get());var e=this._proportional,n=this._differential;this._node.setProportionalSize(e.x.get(),e.y.get(),e.z.get()),this._node.setDifferentialSize(n.x.get(),n.y.get(),n.z.get()),this.isActive()?this._node.requestUpdateOnNextTick(this._id):this._requestingUpdate=!1},r.prototype.setAbsolute=function(t,e,n,r,i){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var o,s,a;null!=n?a=i:null!=e?s=i:null!=t&&(o=i);var u=this._absolute;null!=t&&u.x.set(t,r,o),null!=e&&u.y.set(e,r,s),null!=n&&u.z.set(n,r,a)},r.prototype.setProportional=function(t,e,n,r,i){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var o,s,a;null!=n?a=i:null!=e?s=i:null!=t&&(o=i);var u=this._proportional;return null!=t&&u.x.set(t,r,o),null!=e&&u.y.set(e,r,s),null!=n&&u.z.set(n,r,a),this},r.prototype.setDifferential=function(t,e,n,r,i){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var o,s,a;null!=n?a=i:null!=e?s=i:null!=t&&(o=i);var u=this._differential;return null!=t&&u.x.set(t,r,o),null!=e&&u.y.set(e,r,s),null!=n&&u.z.set(n,r,a),this},r.prototype.get=function(){return this._node.getSize()},r.prototype.halt=function(){return this._proportional.x.halt(),this._proportional.y.halt(),this._proportional.z.halt(),this._differential.x.halt(),this._differential.y.halt(),this._differential.z.halt(),this._absolute.x.halt(),this._absolute.y.halt(),this._absolute.z.halt(),this},e.exports=r},{"../transitions/Transitionable":92}],11:[function(t,e,n){"use strict";function r(t,e,n,r){this._transform=r,this._dirty=!1,this.x=new s(t),this.y=new s(e),this.z=new s(n),this._values={x:t,y:e,z:n}}function i(t,e,n,r,i){this._transform=i,this._dirty=!1,this._t=new s([t,e,n,r])}function o(t){this._node=t,this._id=t.addComponent(this),this.origin=null,this.mountPoint=null,this.align=null,this.scale=null,this.position=null,this.rotation=null,this._dirty=!1}var s=t("../transitions/Transitionable"),a=t("../math/Quaternion"),u=new a,h=new a;r.prototype.get=function(){return this._values.x=this.x.get(),this._values.y=this.y.get(),this._values.z=this.z.get(),this._values},r.prototype.set=function(t,e,n,r,i){this._transform._dirty||(this._transform._node.requestUpdate(this._transform._id),this._transform._dirty=!0),this._dirty=!0;var o=null,s=null,a=null;return null!=n?a=i:null!=e?s=i:null!=t&&(o=i),null!=t&&this.x.set(t,r,o),null!=e&&this.y.set(e,r,s),null!=n&&this.z.set(n,r,a),this},r.prototype.isActive=function(){return this.x.isActive()||this.y.isActive()||this.z.isActive()},r.prototype.pause=function(){return this.x.pause(),this.y.pause(),this.z.pause(),this},r.prototype.resume=function(){return this.x.resume(),this.y.resume(),this.z.resume(),this},r.prototype.halt=function(){return this.x.halt(),this.y.halt(),this.z.halt(),this},i.prototype.get=function(){return this._t.get()},i.prototype.set=function(t,e,n,r,i,o){this._transform._dirty||(this._transform._node.requestUpdate(this._transform._id),this._transform._dirty=!0),this._dirty=!0,i.method="slerp",this._t.set([t,e,n,r],i,o)},i.prototype.isActive=function(){return this._t.isActive()},i.prototype.pause=function(){return this._t.pause(),this},i.prototype.resume=function(){return this._t.resume(),this},i.prototype.halt=function(){return this._dirty=!1,this._t.halt(),this},o.prototype.toString=function(){return"Transform"},o.prototype.getValue=function(){return{component:this.toString(),origin:this.origin&&this.origin.get(),mountPoint:this.mountPoint&&this.mountPoint.get(),align:this.align&&this.align.get(),scale:this.scale&&this.scale.get(),position:this.position&&this.position.get(),rotation:this.rotation&&this.rotation.get()}},o.prototype.setState=function(t){return this.toString()===t.component?(t.origin&&this.setOrigin(t.origin.x,t.origin.y,t.origin.z),t.mountPoint&&this.setMountPoint(t.mountPoint.x,t.mountPoint.y,t.mountPoint.z),t.align&&this.setAlign(t.align.x,t.align.y,t.align.z),t.scale&&this.setScale(t.scale.x,t.scale.y,t.scale.z),t.position&&this.setPosition(t.position.x,t.position.y,t.position.z),t.rotation&&this.setRotation(t.rotation.x,t.rotation.y,t.rotation.z,t.rotation.w),!0):!1},o.prototype.setOrigin=function(t,e,n,i,o){if(!this.origin){var s=this._node.getOrigin();this.origin=new r(s[0],s[1],s[2],this)}return this.origin.set(t,e,n,i,o),this},o.prototype.setMountPoint=function(t,e,n,i,o){if(!this.mountPoint){var s=this._node.getMountPoint();this.mountPoint=new r(s[0],s[1],s[2],this)}return this.mountPoint.set(t,e,n,i,o),this},o.prototype.setAlign=function(t,e,n,i,o){if(!this.align){var s=this._node.getAlign();this.align=new r(s[0],s[1],s[2],this)}return this.align.set(t,e,n,i,o),this},o.prototype.setScale=function(t,e,n,i,o){if(!this.scale){var s=this._node.getScale();this.scale=new r(s[0],s[1],s[2],this)}return this.scale.set(t,e,n,i,o),this},o.prototype.setPosition=function(t,e,n,i,o){if(!this.position){var s=this._node.getPosition();this.position=new r(s[0],s[1],s[2],this)}return this.position.set(t,e,n,i,o),this},o.prototype.translate=function(t,e,n,i,o){if(!this.position){var s=this._node.getPosition();this.position=new r(s[0],s[1],s[2],this)}var a=this.position,u=a.x._queue,h=a.y._queue,c=a.z._queue,l=null==t?null:t+(u.length>0?u[u.length-5]:a.x._state),p=null==e?null:e+(h.length>0?h[h.length-5]:a.y._state),f=null==n?null:n+(c.length>0?c[c.length-5]:a.z._state);return this.position.set(l,p,f,i,o),this},o.prototype.setRotation=function(t,e,n,r,o,s){if(!this.rotation){var a=this._node.getRotation();this.rotation=new i(a[0],a[1],a[2],a[3],this)}var h=u;return"number"==typeof r?h.set(r,t,e,n):(h.fromEuler(t,e,n),s=o,o=r),this.rotation.set(h.x,h.y,h.z,h.w,o,s),this},o.prototype.rotate=function(t,e,n,r,o,s){if(!this.rotation){var a=this._node.getRotation();this.rotation=new i(a[0],a[1],a[2],a[3],this)}var c,l,p=this.rotation._t._queue,f=p.length;l=0!==f?p[f-5]:this.rotation._t._state,c=h.set(l[3],l[0],l[1],l[2]);var d=u;"number"==typeof r?d.set(r,t,e,n):(d.fromEuler(t,e,n),s=o,o=r);var g=c.multiply(d);return this.rotation.set(g.x,g.y,g.z,g.w,o,s),this},o.prototype.clean=function(){var t,e=this._node,n=!1;if((t=this.origin)&&t._dirty&&(e.setOrigin(t.x.get(),t.y.get(),t.z.get()),t._dirty=t.isActive(),n=n||t._dirty),(t=this.mountPoint)&&t._dirty&&(e.setMountPoint(t.x.get(),t.y.get(),t.z.get()),t._dirty=t.isActive(),n=n||t._dirty),(t=this.align)&&t._dirty&&(e.setAlign(t.x.get(),t.y.get(),t.z.get()),t._dirty=t.isActive(),n=n||t._dirty),(t=this.scale)&&t._dirty&&(e.setScale(t.x.get(),t.y.get(),t.z.get()),t._dirty=t.isActive(),n=n||t._dirty),(t=this.position)&&t._dirty&&(e.setPosition(t.x.get(),t.y.get(),t.z.get()),t._dirty=t.isActive(),n=n||t._dirty),(t=this.rotation)&&t._dirty){var r=t.get();e.setRotation(r[0],r[1],r[2],r[3]),t._dirty=t.isActive(),n=n||t._dirty}n?this._node.requestUpdateOnNextTick(this._id):this._dirty=!1},o.prototype.onUpdate=o.prototype.clean,e.exports=o},{"../math/Quaternion":48,"../transitions/Transitionable":92}],12:[function(t,e,n){"use strict";e.exports={Align:t("./Align"),Camera:t("./Camera"),GestureHandler:t("./GestureHandler"),MountPoint:t("./MountPoint"),Opacity:t("./Opacity"),Origin:t("./Origin"),Position:t("./Position"),Rotation:t("./Rotation"),Scale:t("./Scale"),Size:t("./Size"),Transform:t("./Transform")}},{"./Align":1,"./Camera":2,"./GestureHandler":3,"./MountPoint":4,"./Opacity":5,"./Origin":6,"./Position":7,"./Rotation":8,"./Scale":9,"./Size":10,"./Transform":11}],13:[function(t,e,n){"use strict";function r(){"undefined"!=typeof self&&self.window!==self&&this._enterWorkerMode()}r.prototype._enterWorkerMode=function(){this._workerMode=!0;var t=this;self.addEventListener("message",function(e){t.onMessage(e.data)})},r.prototype.onMessage=null,r.prototype.sendMessage=function(t){this._workerMode?self.postMessage(t):this.onmessage(t)},r.prototype.onmessage=null,r.prototype.postMessage=function(t){return this.onMessage(t)},e.exports=r},{}],14:[function(t,e,n){"use strict";function r(){this._time=0,this._frame=0,this._timerQueue=[],this._updatingIndex=0,this._scale=1,this._scaledTime=this._time}r.prototype.setScale=function(t){return this._scale=t,this},r.prototype.getScale=function(){return this._scale},r.prototype.step=function(t){this._frame++,this._scaledTime=this._scaledTime+(t-this._time)*this._scale,this._time=t;for(var e=0;e<this._timerQueue.length;e++)this._timerQueue[e](this._scaledTime)&&this._timerQueue.splice(e,1);return this},r.prototype.now=function(){return this._scaledTime},r.prototype.getTime=r.prototype.now,r.prototype.getFrame=function(){return this._frame},r.prototype.setTimeout=function(t,e){var n=Array.prototype.slice.call(arguments,2),r=this._time,i=function(i){return i-r>=e?(t.apply(null,n),!0):!1};return this._timerQueue.push(i),i},r.prototype.setInterval=function(t,e){var n=Array.prototype.slice.call(arguments,2),r=this._time,i=function(i){return i-r>=e&&(t.apply(null,n),r=i),!1};return this._timerQueue.push(i),i},r.prototype.clearTimer=function(t){var e=this._timerQueue.indexOf(t);return-1!==e&&this._timerQueue.splice(e,1),this},e.exports=r},{}],15:[function(t,e,n){"use strict";var r={INIT_DOM:0,DOM_RENDER_SIZE:1,CHANGE_TRANSFORM:2,CHANGE_SIZE:3,CHANGE_PROPERTY:4,CHANGE_CONTENT:5,CHANGE_ATTRIBUTE:6,ADD_CLASS:7,REMOVE_CLASS:8,SUBSCRIBE:9,GL_SET_DRAW_OPTIONS:10,GL_AMBIENT_LIGHT:11,GL_LIGHT_POSITION:12,GL_LIGHT_COLOR:13,MATERIAL_INPUT:14,GL_SET_GEOMETRY:15,GL_UNIFORMS:16,GL_BUFFER_DATA:17,GL_CUTOUT_STATE:18,GL_MESH_VISIBILITY:19,GL_REMOVE_MESH:20,PINHOLE_PROJECTION:21,ORTHOGRAPHIC_PROJECTION:22,CHANGE_VIEW_TRANSFORM:23,WITH:24,FRAME:25,ENGINE:26,START:27,STOP:28,TIME:29,TRIGGER:30,NEED_SIZE_FOR:31,DOM:32,READY:33,ALLOW_DEFAULT:34,PREVENT_DEFAULT:35};e.exports=r},{}],16:[function(t,e,n){"use strict";function r(){this._nodes={},this._queue=[]}function i(t,e){e.length=0;var n,r=0,i=t.length;for(n=0;i>n;n++)"/"===t[n]&&(e.push(t.substring(r,n)),r=n+1);return n-r>0&&e.push(t.substring(r,n)),e}var o=t("./Event"),s=t("./Path");r.prototype._setUpdater=function(t){this._updater=t;for(var e in this._nodes)this._nodes[e]._setUpdater(t)},r.prototype.addChildrenToQueue=function(t){for(var e,n=t.getChildren(),r=0,i=n.length;i>r;r++)e=n[r],e&&this._queue.push(e)},r.prototype.next=function(){return this._queue.shift()},r.prototype.breadthFirstNext=function(){var t=this._queue.shift();return t?(this.addChildrenToQueue(t),t):void 0},r.prototype.mount=function(t,e){if(!e)throw new Error("Dispatch: no node passed to mount at: "+t);if(this._nodes[t])throw new Error("Dispatch: there is a node already registered at: "+t);e._setUpdater(this._updater),this._nodes[t]=e;var n=s.parent(t),r=n?this._nodes[n]:e;if(!r)throw new Error("Parent to path: "+t+" doesn't exist at expected path: "+n);var i,o,a=e.getChildren(),u=e.getComponents();if(r.isMounted()&&e._setMounted(!0,t),r.isShown()&&e._setShown(!0),r.isMounted()){for(e._setParent(r),e.onMount&&e.onMount(t),i=0,o=u.length;o>i;i++)u[i]&&u[i].onMount&&u[i].onMount(e,i);for(i=0,o=a.length;o>i;i++)a[i]&&a[i].mount?a[i].mount(t+"/"+i):a[i]&&this.mount(t+"/"+i,a[i])}if(r.isShown())for(e.onShow&&e.onShow(),i=0,o=u.length;o>i;i++)u[i]&&u[i].onShow&&u[i].onShow()},r.prototype.dismount=function(t){var e=this._nodes[t];if(!e)throw new Error("No node registered to path: "+t);var n,r,i=e.getChildren(),o=e.getComponents();if(e.isShown())for(e._setShown(!1),e.onHide&&e.onHide(),n=0,r=o.length;r>n;n++)o[n]&&o[n].onHide&&o[n].onHide();if(e.isMounted()){for(e.onDismount&&e.onDismount(t),n=0,r=i.length;r>n;n++)i[n]&&i[n].dismount?i[n].dismount():i[n]&&this.dismount(t+"/"+n);for(n=0,r=o.length;r>n;n++)o[n]&&o[n].onDismount&&o[n].onDismount();e._setMounted(!1),e._setParent(null)}this._nodes[t]=null},r.prototype.getNode=function(t){return this._nodes[t]},r.prototype.show=function(t){var e=this._nodes[t];if(!e)throw new Error("No node registered to path: "+t);e.onShow&&e.onShow(),this.addChildrenToQueue(e);for(var n;n=this.breadthFirstNext();)this.show(n.getLocation())},r.prototype.hide=function(t){var e=this._nodes[t];if(!e)throw new Error("No node registered to path: "+t);e.onHide&&e.onHide(),this.addChildrenToQueue(e);for(var n;n=this.breadthFirstNext();)this.hide(n.getLocation())},r.prototype.lookupNode=function(t){if(!t)throw new Error("lookupNode must be called with a path");this._queue.length=0;var e=this._queue;i(t,e);for(var n=0,r=e.length;r>n;n++)e[n]=this._nodes[e[n]];return e[e.length-1]},r.prototype.dispatch=function(t,e,n){if(!t)throw new Error("dispatch requires a path as it's first argument");if(!e)throw new Error("dispatch requires an event name as it's second argument");var r=this._nodes[t];if(!r)throw new Error("No node registered at path: "+t);this.addChildrenToQueue(r);for(var i;i=this.breadthFirstNext();)i.onReceive&&i.onReceive(e,n)},r.prototype.dispatchUIEvent=function(t,e,n){if(!t)throw new Error("dispatchUIEvent needs a valid path to dispatch to");if(!e)throw new Error("dispatchUIEvent needs an event name as its second argument");var r;if(o.call(n),r=this.getNode(t)){var i,s,a,u;for(n.node=r;r;){for(r.onReceive&&r.onReceive(e,n),s=r.getComponents(),a=0,u=s.length;u>a;a++)s[a]&&s[a].onReceive&&s[a].onReceive(e,n);if(n.propagationStopped)break;if(i=r.getParent(),i===r)return;r=i}}},e.exports=new r},{"./Event":17,"./Path":20}],17:[function(t,e,n){"use strict";function r(){this.propagationStopped=!1,this.stopPropagation=i}function i(){this.propagationStopped=!0}e.exports=r},{}],18:[function(t,e,n){
"use strict";function r(){var t=this;a._setUpdater(this),this._updateQueue=[],this._nextUpdateQueue=[],this._scenes={},this._messages=v,this._inUpdate=!1,this._clock=new i,this._channel=new s,this._channel.onMessage=function(e){t.handleMessage(e)}}var i=t("./Clock"),o=t("./Scene"),s=t("./Channel"),a=t("./Dispatch"),u=t("../renderers/UIManager"),h=t("../renderers/Compositor"),c=t("../render-loops/RequestAnimationFrameLoop"),l=t("./TransformSystem"),p=t("./SizeSystem"),f=t("./Commands"),d=[f.ENGINE,f.START],g=[f.ENGINE,f.STOP],v=[f.TIME,null];r.prototype.init=function(t){return this.compositor=t&&t.compositor||new h,this.renderLoop=t&&t.renderLoop||new c,this.uiManager=new u(this.getChannel(),this.compositor,this.renderLoop),this},r.prototype.setChannel=function(t){return this._channel=t,this},r.prototype.getChannel=function(){return this._channel},r.prototype._update=function(){this._inUpdate=!0;var t,e=this._clock.now(),n=this._nextUpdateQueue,r=this._updateQueue;for(this._messages[1]=e,p.update(),l.onUpdate();n.length;)r.unshift(n.pop());for(;r.length;)t=r.shift(),t&&t.update&&t.update(e),t&&t.onUpdate&&t.onUpdate(e);this._inUpdate=!1},r.prototype.requestUpdate=function(t){if(!t)throw new Error("requestUpdate must be called with a class to be updated");this._inUpdate?this.requestUpdateOnNextTick(t):this._updateQueue.push(t)},r.prototype.requestUpdateOnNextTick=function(t){this._nextUpdateQueue.push(t)},r.prototype.handleMessage=function(t){if(!t)throw new Error("onMessage must be called with an array of messages");for(var e;t.length>0;)switch(e=t.shift()){case f.WITH:this.handleWith(t);break;case f.FRAME:this.handleFrame(t);break;default:throw new Error("received unknown command: "+e)}return this},r.prototype.handleWith=function(t){var e=t.shift(),n=t.shift();switch(n){case f.TRIGGER:var r=t.shift(),i=t.shift();a.dispatchUIEvent(e,r,i);break;default:throw new Error("received unknown command: "+n)}return this},r.prototype.handleFrame=function(t){if(!t)throw new Error("handleFrame must be called with an array of messages");if(!t.length)throw new Error("FRAME must be sent with a time");return this.step(t.shift()),this},r.prototype.step=function(t){if(null==t)throw new Error("step must be called with a time");if(this._clock.step(t),this._update(),this._messages.length)for(this._channel.sendMessage(this._messages);this._messages.length>2;)this._messages.pop();return this},r.prototype.getContext=function(t){if(!t)throw new Error("getContext must be called with a selector");var e=t.indexOf("/");return t=-1===e?t:t.substring(0,e),this._scenes[t]},r.prototype.getClock=function(){return this._clock},r.prototype.message=function(t){return this._messages.push(t),this},r.prototype.createScene=function(t){return t=t||"body",this._scenes[t]&&this._scenes[t].dismount(),this._scenes[t]=new o(t,this),this._scenes[t]},r.prototype.addScene=function(t){var e=t._selector,n=this._scenes[e];return n&&n!==t&&n.dismount(),t.isMounted()||t.mount(),this._scenes[e]=t,this},r.prototype.removeScene=function(t){var e=t._selector,n=this._scenes[e];return n&&n===t&&(t.isMounted()&&t.dismount(),delete this._scenes[e]),this},r.prototype.startRenderLoop=function(){return this._channel.sendMessage(d),this},r.prototype.stopRenderLoop=function(){return this._channel.sendMessage(g),this},r.prototype.startEngine=function(){return console.warn("FamousEngine.startEngine is deprecated! Use FamousEngine.startRenderLoop instead!"),this.startRenderLoop()},r.prototype.stopEngine=function(){return console.warn("FamousEngine.stopEngine is deprecated! Use FamousEngine.stopRenderLoop instead!"),this.stopRenderLoop()},e.exports=new r},{"../render-loops/RequestAnimationFrameLoop":83,"../renderers/Compositor":86,"../renderers/UIManager":88,"./Channel":13,"./Clock":14,"./Commands":15,"./Dispatch":16,"./Scene":22,"./SizeSystem":24,"./TransformSystem":26}],19:[function(t,e,n){"use strict";function r(){this._requestingUpdate=!1,this._inUpdate=!1,this._mounted=!1,this._shown=!1,this._updater=null,this._opacity=1,this._UIEvents=[],this._updateQueue=[],this._nextUpdateQueue=[],this._freedComponentIndicies=[],this._components=[],this._freedChildIndicies=[],this._children=[],this._parent=null,this._id=null,this._transformID=null,this._sizeID=null,this.constructor.INIT_DEFAULT_COMPONENTS&&this._init()}var i=t("./SizeSystem"),o=t("./Dispatch"),s=t("./TransformSystem"),a=t("./Size"),u=t("./Transform");r.RELATIVE_SIZE=0,r.ABSOLUTE_SIZE=1,r.RENDER_SIZE=2,r.DEFAULT_SIZE=0,r.INIT_DEFAULT_COMPONENTS=!0,r.prototype._init=function(){this._transformID=this.addComponent(new u),this._sizeID=this.addComponent(new a)},r.prototype._setParent=function(t){this._parent&&-1!==this._parent.getChildren().indexOf(this)&&this._parent.removeChild(this),this._parent=t},r.prototype._setMounted=function(t,e){this._mounted=t,this._id=e?e:null},r.prototype._setShown=function(t){this._shown=t},r.prototype._setUpdater=function(t){this._updater=t,this._requestingUpdate&&this._updater.requestUpdate(this)},r.prototype.getLocation=function(){return this._id},r.prototype.getId=r.prototype.getLocation,r.prototype.emit=function(t,e){return o.dispatch(this.getLocation(),t,e),this},r.prototype.sendDrawCommand=function(t){return this._updater.message(t),this},r.prototype.getValue=function(){var t=this._children.length,e=this._components.length,n=0,r={location:this.getId(),spec:{location:this.getId(),showState:{mounted:this.isMounted(),shown:this.isShown(),opacity:this.getOpacity()||null},offsets:{mountPoint:[0,0,0],align:[0,0,0],origin:[0,0,0]},vectors:{position:[0,0,0],rotation:[0,0,0,1],scale:[1,1,1]},size:{sizeMode:[0,0,0],proportional:[1,1,1],differential:[0,0,0],absolute:[0,0,0],render:[0,0,0]}},UIEvents:this._UIEvents,components:[],children:[]};if(r.location){var o=s.get(this.getId()),a=i.get(this.getId());for(n=0;3>n;n++)r.spec.offsets.mountPoint[n]=o.offsets.mountPoint[n],r.spec.offsets.align[n]=o.offsets.align[n],r.spec.offsets.origin[n]=o.offsets.origin[n],r.spec.vectors.position[n]=o.vectors.position[n],r.spec.vectors.rotation[n]=o.vectors.rotation[n],r.spec.vectors.scale[n]=o.vectors.scale[n],r.spec.size.sizeMode[n]=a.sizeMode[n],r.spec.size.proportional[n]=a.proportionalSize[n],r.spec.size.differential[n]=a.differentialSize[n],r.spec.size.absolute[n]=a.absoluteSize[n],r.spec.size.render[n]=a.renderSize[n];r.spec.vectors.rotation[3]=o.vectors.rotation[3]}for(n=0;t>n;n++)this._children[n]&&this._children[n].getValue&&r.children.push(this._children[n].getValue());for(n=0;e>n;n++)this._components[n]&&this._components[n].getValue&&r.components.push(this._components[n].getValue());return r},r.prototype.getComputedValue=function(){console.warn("Node.getComputedValue is depricated. Use Node.getValue instead");for(var t=this._children.length,e={location:this.getId(),computedValues:{transform:this.isMounted()?s.get(this.getLocation()).getLocalTransform():null,size:this.isMounted()?i.get(this.getLocation()).get():null},children:[]},n=0;t>n;n++)this._children[n]&&this._children[n].getComputedValue&&e.children.push(this._children[n].getComputedValue());return e},r.prototype.getChildren=function(){return this._children},r.prototype.getParent=function(){return this._parent},r.prototype.requestUpdate=function(t){return this._inUpdate||!this.isMounted()?this.requestUpdateOnNextTick(t):(this._updateQueue.push(t),this._requestingUpdate||this._requestUpdate(),this)},r.prototype.requestUpdateOnNextTick=function(t){return this._nextUpdateQueue.push(t),this},r.prototype.isMounted=function(){return this._mounted},r.prototype.isShown=function(){return this._shown},r.prototype.getOpacity=function(){return this._opacity},r.prototype.getMountPoint=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._transformID).getMountPoint();if(this.isMounted())return s.get(this.getLocation()).getMountPoint();throw new Error("This node does not have access to a transform component")},r.prototype.getAlign=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._transformID).getAlign();if(this.isMounted())return s.get(this.getLocation()).getAlign();throw new Error("This node does not have access to a transform component")},r.prototype.getOrigin=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._transformID).getOrigin();if(this.isMounted())return s.get(this.getLocation()).getOrigin();throw new Error("This node does not have access to a transform component")},r.prototype.getPosition=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._transformID).getPosition();if(this.isMounted())return s.get(this.getLocation()).getPosition();throw new Error("This node does not have access to a transform component")},r.prototype.getRotation=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._transformID).getRotation();if(this.isMounted())return s.get(this.getLocation()).getRotation();throw new Error("This node does not have access to a transform component")},r.prototype.getScale=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._transformID).getScale();if(this.isMounted())return s.get(this.getLocation()).getScale();throw new Error("This node does not have access to a transform component")},r.prototype.getSizeMode=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._sizeID).getSizeMode();if(this.isMounted())return i.get(this.getLocation()).getSizeMode();throw new Error("This node does not have access to a size component")},r.prototype.getProportionalSize=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._sizeID).getProportional();if(this.isMounted())return i.get(this.getLocation()).getProportional();throw new Error("This node does not have access to a size component")},r.prototype.getDifferentialSize=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._sizeID).getDifferential();if(this.isMounted())return i.get(this.getLocation()).getDifferential();throw new Error("This node does not have access to a size component")},r.prototype.getAbsoluteSize=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._sizeID).getAbsolute();if(this.isMounted())return i.get(this.getLocation()).getAbsolute();throw new Error("This node does not have access to a size component")},r.prototype.getRenderSize=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._sizeID).getRender();if(this.isMounted())return i.get(this.getLocation()).getRender();throw new Error("This node does not have access to a size component")},r.prototype.getSize=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._sizeID).get();if(this.isMounted())return i.get(this.getLocation()).get();throw new Error("This node does not have access to a size component")},r.prototype.getTransform=function(){return s.get(this.getLocation())},r.prototype.getUIEvents=function(){return this._UIEvents},r.prototype.addChild=function(t){var e=t?this._children.indexOf(t):-1;return t=t?t:new r,-1===e&&(e=this._freedChildIndicies.length?this._freedChildIndicies.pop():this._children.length,this._children[e]=t),this.isMounted()&&t.mount(this.getLocation()+"/"+e),t},r.prototype.removeChild=function(t){var e=this._children.indexOf(t);if(e>-1)return this._freedChildIndicies.push(e),this._children[e]=null,t.isMounted()&&t.dismount(),!0;throw new Error("Node is not a child of this node")},r.prototype.addComponent=function(t){var e=this._components.indexOf(t);return-1===e&&(e=this._freedComponentIndicies.length?this._freedComponentIndicies.pop():this._components.length,this._components[e]=t,this.isMounted()&&t.onMount&&t.onMount(this,e),this.isShown()&&t.onShow&&t.onShow()),e},r.prototype.getComponent=function(t){return this._components[t]},r.prototype.removeComponent=function(t){var e=this._components.indexOf(t);return-1!==e&&(this._freedComponentIndicies.push(e),this.isShown()&&t.onHide&&t.onHide(),this.isMounted()&&t.onDismount&&t.onDismount(),this._components[e]=null),t},r.prototype.removeUIEvent=function(t){var e,n=this.getUIEvents(),r=this._components,i=n.indexOf(t);if(-1!==i){n.splice(i,1);for(var o=0,s=r.length;s>o;o++)e=r[o],e&&e.onRemoveUIEvent&&e.onRemoveUIEvent(t)}},r.prototype.addUIEvent=function(t){var e,n=this.getUIEvents(),r=this._components,i=-1!==n.indexOf(t);if(!i){n.push(t);for(var o=0,s=r.length;s>o;o++)e=r[o],e&&e.onAddUIEvent&&e.onAddUIEvent(t)}},r.prototype._requestUpdate=function(t){(t||!this._requestingUpdate)&&(this._updater&&this._updater.requestUpdate(this),this._requestingUpdate=!0)},r.prototype._vecOptionalSet=function(t,e,n){return null!=n&&t[e]!==n?(t[e]=n,this._requestingUpdate||this._requestUpdate(),!0):!1},r.prototype.show=function(){return o.show(this.getLocation()),this._shown=!0,this},r.prototype.hide=function(){return o.hide(this.getLocation()),this._shown=!1,this},r.prototype.setAlign=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._transformID).setAlign(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a transform component");s.get(this.getLocation()).setAlign(t,e,n)}return this},r.prototype.setMountPoint=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._transformID).setMountPoint(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a transform component");s.get(this.getLocation()).setMountPoint(t,e,n)}return this},r.prototype.setOrigin=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._transformID).setOrigin(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a transform component");s.get(this.getLocation()).setOrigin(t,e,n)}return this},r.prototype.setPosition=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._transformID).setPosition(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a transform component");s.get(this.getLocation()).setPosition(t,e,n)}return this},r.prototype.setRotation=function(t,e,n,r){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._transformID).setRotation(t,e,n,r);else{if(!this.isMounted())throw new Error("This node does not have access to a transform component");s.get(this.getLocation()).setRotation(t,e,n,r)}return this},r.prototype.setScale=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._transformID).setScale(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a transform component");s.get(this.getLocation()).setScale(t,e,n)}return this},r.prototype.setOpacity=function(t){if(t!==this._opacity){this._opacity=t,this._requestingUpdate||this._requestUpdate();for(var e,n=0,r=this._components,i=r.length;i>n;n++)e=r[n],e&&e.onOpacityChange&&e.onOpacityChange(t)}return this},r.prototype.setSizeMode=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._sizeID).setSizeMode(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a size component");i.get(this.getLocation()).setSizeMode(t,e,n)}return this},r.prototype.setProportionalSize=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._sizeID).setProportional(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a size component");i.get(this.getLocation()).setProportional(t,e,n)}return this},r.prototype.setDifferentialSize=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._sizeID).setDifferential(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a size component");i.get(this.getLocation()).setDifferential(t,e,n)}return this},r.prototype.setAbsoluteSize=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._sizeID).setAbsolute(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a size component");i.get(this.getLocation()).setAbsolute(t,e,n)}return this},r.prototype.getFrame=function(){return this._updater.getFrame()},r.prototype.getComponents=function(){return this._components},r.prototype.update=function(t){this._inUpdate=!0;var e,n=this._nextUpdateQueue,r=this._updateQueue;for(this.onUpdate&&this.onUpdate();n.length;)r.unshift(n.pop());for(;r.length;)e=this._components[r.shift()],e&&e.onUpdate&&e.onUpdate(t);return this._inUpdate=!1,this._requestingUpdate=!1,this.isMounted()?this._nextUpdateQueue.length&&(this._updater.requestUpdateOnNextTick(this),this._requestingUpdate=!0):(this._parent=null,this._id=null),this},r.prototype.mount=function(t){if(this.isMounted())throw new Error("Node is already mounted at: "+this.getLocation());return this.constructor.INIT_DEFAULT_COMPONENTS?(s.registerTransformAtPath(t,this.getComponent(this._transformID)),i.registerSizeAtPath(t,this.getComponent(this._sizeID))):(s.registerTransformAtPath(t),i.registerSizeAtPath(t)),o.mount(t,this),this._requestingUpdate||this._requestUpdate(),this},r.prototype.dismount=function(){if(!this.isMounted())throw new Error("Node is not mounted");var t=this.getLocation();s.deregisterTransformAtPath(t),i.deregisterSizeAtPath(t),o.dismount(t),this._requestingUpdate||this._requestUpdate()},e.exports=r},{"./Dispatch":16,"./Size":23,"./SizeSystem":24,"./Transform":25,"./TransformSystem":26}],20:[function(t,e,n){"use strict";function r(){}r.prototype.hasTrailingSlash=function(t){return"/"===t[t.length-1]},r.prototype.depth=function(t){for(var e=0,n=t.length,r=this.hasTrailingSlash(t)?n-1:n,i=0;r>i;i++)e+="/"===t[i]?1:0;return e},r.prototype.index=function(t){for(var e=t.length,n=this.hasTrailingSlash(t)?e-1:e;n--&&"/"!==t[n];);var r=parseInt(t.substring(n+1));return isNaN(r)?0:r},r.prototype.indexAtDepth=function(t,e){for(var n=0,r=t.length,i=0;r>n;n++)if("/"===t[n]&&i++,i===e)return t=t.substring(n?n+1:n),i=t.indexOf("/"),t=-1===i?t:t.substring(0,i),i=parseInt(t),isNaN(i)?t:i},r.prototype.parent=function(t){return t.substring(0,t.lastIndexOf("/",t.length-2))},r.prototype.isChildOf=function(t,e){return this.isDescendentOf(t,e)&&this.depth(t)===this.depth(e)+1},r.prototype.isDescendentOf=function(t,e){return t===e?!1:(t=this.hasTrailingSlash(t)?t:t+"/",e=this.hasTrailingSlash(e)?e:e+"/",this.depth(e)<this.depth(t)&&0===t.indexOf(e))},r.prototype.getSelector=function(t){var e=t.indexOf("/");return-1===e?t:t.substring(0,e)},e.exports=new r},{}],21:[function(t,e,n){"use strict";function r(){this.items=[],this.paths=[],this.memo={}}var i=t("./Path");r.prototype.insert=function(t,e){var n=this.paths,r=n.indexOf(t);if(-1!==r)throw new Error("item already exists at path: "+t);for(var o=0,s=i.depth(t),a=i.index(t);n[o]&&s>=i.depth(n[o]);)o++;for(;n[o]&&s===i.depth(n[o])&&a<i.index(n[o]);)o++;n.splice(o,0,t),this.items.splice(o,0,e),this.memo[t]=o;for(var u=this.paths.length;u>o;o++)this.memo[this.paths[o]]=null},r.prototype.remove=function(t){var e=this.paths,n=this.memo[t]?this.memo[t]:e.indexOf(t);if(-1===n)throw new Error("Cannot remove. No item exists at path: "+t);e.splice(n,1),this.items.splice(n,1),this.memo[t]=null;for(var r=this.paths.length;r>n;n++)this.memo[this.paths[n]]=null},r.prototype.get=function(t){if(this.memo[t])return this.items[this.memo[t]];var e=this.paths.indexOf(t);return-1===e?void 0:(this.memo[t]=e,this.items[e])},r.prototype.getItems=function(){return this.items},r.prototype.getPaths=function(){return this.paths},e.exports=r},{"./Path":20}],22:[function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error("Scene needs to be created with a DOM selector");if(!e)throw new Error("Scene needs to be created with a class like Famous");i.call(this),this._globalUpdater=e,this._selector=t,this.mount(t),this._globalUpdater.message(s.NEED_SIZE_FOR).message(t),this.show()}var i=t("./Node"),o=t("./Dispatch"),s=t("./Commands"),a=t("./TransformSystem"),u=t("./SizeSystem");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.getUpdater=function(){return this._updater},r.prototype.getSelector=function(){return this._selector},r.prototype.getDispatch=function(){return console.warn("Scene#getDispatch is deprecated, require the dispatch directly"),o},r.prototype.onReceive=function(t,e){if("CONTEXT_RESIZE"===t){if(e.length<2)throw new Error("CONTEXT_RESIZE's payload needs to be at least a pair of pixel sizes");this.setSizeMode("absolute","absolute","absolute"),this.setAbsoluteSize(e[0],e[1],e[2]?e[2]:0),this._updater.message(s.WITH).message(this._selector).message(s.READY)}},r.prototype.mount=function(t){if(this.isMounted())throw new Error("Scene is already mounted at: "+this.getLocation());o.mount(t,this),this._id=t,this._mounted=!0,this._parent=this,a.registerTransformAtPath(t),u.registerSizeAtPath(t)},e.exports=r},{"./Commands":15,"./Dispatch":16,"./Node":19,"./SizeSystem":24,"./TransformSystem":26}],23:[function(t,e,n){"use strict";function r(t){this.finalSize=new Float32Array(3),this.sizeChanged=!1,this.sizeMode=new Uint8Array(3),this.sizeModeChanged=!1,this.absoluteSize=new Float32Array(3),this.absoluteSizeChanged=!1,this.proportionalSize=new Float32Array(a),this.proportionalSizeChanged=!1,this.differentialSize=new Float32Array(3),this.differentialSizeChanged=!1,this.renderSize=new Float32Array(3),this.renderSizeChanged=!1,this.parent=null!=t?t:null}function i(t,e,n){return null!=n&&t[e]!==n?(t[e]=n,!0):!1}function o(t,e,n,r){var o=!1;return o=i(t,0,e)||o,o=i(t,1,n)||o,o=i(t,2,r)||o}function s(t){if(t.constructor===String)switch(t.toLowerCase()){case"relative":case"default":return r.RELATIVE;case"absolute":return r.ABSOLUTE;case"render":return r.RENDER;default:throw new Error("unknown size mode: "+t)}else if(0>t||t>r.RENDER)throw new Error("unknown size mode: "+t);return t}var a=[1,1,1],u=[0,0,0];r.RELATIVE=0,r.ABSOLUTE=1,r.RENDER=2,r.DEFAULT=r.RELATIVE,r.prototype.setParent=function(t){return this.parent=t,this},r.prototype.getParent=function(){return this.parent},r.prototype.setSizeMode=function(t,e,n){return null!=t&&(t=s(t)),null!=e&&(e=s(e)),null!=n&&(n=s(n)),this.sizeModeChanged=o(this.sizeMode,t,e,n),this},r.prototype.getSizeMode=function(){return this.sizeMode},r.prototype.setAbsolute=function(t,e,n){return this.absoluteSizeChanged=o(this.absoluteSize,t,e,n),this},r.prototype.getAbsolute=function(){return this.absoluteSize},r.prototype.setProportional=function(t,e,n){return this.proportionalSizeChanged=o(this.proportionalSize,t,e,n),this},r.prototype.getProportional=function(){return this.proportionalSize},r.prototype.setDifferential=function(t,e,n){return this.differentialSizeChanged=o(this.differentialSize,t,e,n),this},r.prototype.getDifferential=function(){return this.differentialSize},r.prototype.get=function(){return this.finalSize},r.prototype.fromComponents=function(t){for(var e,n,i=this.sizeMode,o=this.finalSize,s=this.parent?this.parent.get():u,a=!1,h=t.length,c=0;3>c;c++){switch(e=o[c],i[c]){case r.RELATIVE:o[c]=s[c]*this.proportionalSize[c]+this.differentialSize[c];break;case r.ABSOLUTE:o[c]=this.absoluteSize[c];break;case r.RENDER:var l,p;for(n=0;h>n;n++)p=t[n],p&&p.getRenderSize&&(l=p.getRenderSize()[c],o[c]=o[c]<l||0===o[c]?l:o[c])}a=a||e!==o[c]}return this.sizeChanged=a,a},e.exports=r},{}],24:[function(t,e,n){"use strict";function r(){this.pathStore=new c}function i(t,e,n){var r=n.getSizeMode(),i=r[0],o=r[1],s=r[2];t.onSizeModeChange&&t.onSizeModeChange(i,o,s);for(var a=0,u=e.length;u>a;a++)e[a]&&e[a].onSizeModeChange&&e[a].onSizeModeChange(i,o,s);n.sizeModeChanged=!1}function o(t,e,n){var r=n.getAbsolute(),i=r[0],o=r[1],s=r[2];t.onAbsoluteSizeChange&&t.onAbsoluteSizeChange(i,o,s);for(var a=0,u=e.length;u>a;a++)e[a]&&e[a].onAbsoluteSizeChange&&e[a].onAbsoluteSizeChange(i,o,s);n.absoluteSizeChanged=!1}function s(t,e,n){var r=n.getProportional(),i=r[0],o=r[1],s=r[2];t.onProportionalSizeChange&&t.onProportionalSizeChange(i,o,s);for(var a=0,u=e.length;u>a;a++)e[a]&&e[a].onProportionalSizeChange&&e[a].onProportionalSizeChange(i,o,s);n.proportionalSizeChanged=!1}function a(t,e,n){var r=n.getDifferential(),i=r[0],o=r[1],s=r[2];t.onDifferentialSizeChange&&t.onDifferentialSizeChange(i,o,s);for(var a=0,u=e.length;u>a;a++)e[a]&&e[a].onDifferentialSizeChange&&e[a].onDifferentialSizeChange(i,o,s);n.differentialSizeChanged=!1}function u(t,e,n){var r=n.getRenderSize(),i=r[0],o=r[1],s=r[2];t.onRenderSizeChange&&t.onRenderSizeChange(i,o,s);for(var a=0,u=e.length;u>a;a++)e[a]&&e[a].onRenderSizeChange&&e[a].onRenderSizeChange(i,o,s);n.renderSizeChanged=!1}function h(t,e,n){var r=n.get(),i=r[0],o=r[1],s=r[2];t.onSizeChange&&t.onSizeChange(i,o,s);for(var a=0,u=e.length;u>a;a++)e[a]&&e[a].onSizeChange&&e[a].onSizeChange(i,o,s);n.sizeChanged=!1}var c=t("./PathStore"),l=t("./Size"),p=t("./Dispatch"),f=t("./Path");r.prototype.registerSizeAtPath=function(t,e){if(!f.depth(t))return this.pathStore.insert(t,e?e:new l);var n=this.pathStore.get(f.parent(t));if(!n)throw new Error("No parent size registered at expected path: "+f.parent(t));e&&e.setParent(n),this.pathStore.insert(t,e?e:new l(n))},r.prototype.deregisterSizeAtPath=function(t){this.pathStore.remove(t)},r.prototype.get=function(t){return this.pathStore.get(t)},r.prototype.update=function(){var t,e,n,r,c,l=this.pathStore.getItems(),f=this.pathStore.getPaths();for(n=0,r=l.length;r>n;n++)t=p.getNode(f[n]),c=t.getComponents(),t&&(e=l[n],e.sizeModeChanged&&i(t,c,e),e.absoluteSizeChanged&&o(t,c,e),e.proportionalSizeChanged&&s(t,c,e),e.differentialSizeChanged&&a(t,c,e),e.renderSizeChanged&&u(t,c,e),e.fromComponents(c)&&h(t,c,e))},e.exports=new r},{"./Dispatch":16,"./Path":20,"./PathStore":21,"./Size":23}],25:[function(t,e,n){"use strict";function r(t){this.local=new Float32Array(r.IDENT),this.global=new Float32Array(r.IDENT),this.offsets={align:new Float32Array(3),alignChanged:!1,mountPoint:new Float32Array(3),mountPointChanged:!1,origin:new Float32Array(3),originChanged:!1},this.vectors={position:new Float32Array(3),positionChanged:!1,rotation:new Float32Array(h),rotationChanged:!1,scale:new Float32Array(c),scaleChanged:!1},this._lastEulerVals=[0,0,0],this._lastEuler=!1,this.parent=t?t:null,this.breakPoint=!1}function i(t,e,n){return null!=n&&t[e]!==n?(t[e]=n,!0):!1}function o(t,e,n,r,o){var s=!1;return s=i(t,0,e)||s,s=i(t,1,n)||s,s=i(t,2,r)||s,null!=o&&(s=i(t,3,o)||s),s}function s(t,e){var n=e.getLocalTransform(),i=t.getSize(),o=e.vectors,s=e.offsets,a=t.getParent().getSize(),u=0,h=n[0],c=n[1],l=n[2],p=n[4],f=n[5],d=n[6],g=n[8],v=n[9],m=n[10],_=n[12],y=n[13],b=n[14],w=o.position[0],x=o.position[1],T=o.position[2],E=o.rotation[0],I=o.rotation[1],A=o.rotation[2],C=o.rotation[3],R=o.scale[0],S=o.scale[1],O=o.scale[2],M=s.align[0]*a[0],z=s.align[1]*a[1],L=s.align[2]*a[2],N=s.mountPoint[0]*i[0],D=s.mountPoint[1]*i[1],U=s.mountPoint[2]*i[2],P=s.origin[0]*i[0],F=s.origin[1]*i[1],k=s.origin[2]*i[2],G=C*E,B=C*I,V=C*A,H=E*E,q=I*I,j=A*A,W=E*I,Y=E*A,Q=I*A;return n[0]=(1-2*(q+j))*R,n[1]=2*(W+V)*R,n[2]=2*(Y-B)*R,n[3]=0,n[4]=2*(W-V)*S,n[5]=(1-2*(H+j))*S,n[6]=2*(Q+G)*S,n[7]=0,n[8]=2*(Y+B)*O,n[9]=2*(Q-G)*O,n[10]=(1-2*(H+q))*O,n[11]=0,n[12]=M+w-N+P-(n[0]*P+n[4]*F+n[8]*k),n[13]=z+x-D+F-(n[1]*P+n[5]*F+n[9]*k),n[14]=L+T-U+k-(n[2]*P+n[6]*F+n[10]*k),n[15]=1,e.isBreakPoint()&&e.calculateWorldMatrix()&&(u|=r.WORLD_CHANGED),(h!==n[0]||c!==n[1]||l!==n[2]||p!==n[4]||f!==n[5]||d!==n[6]||g!==n[8]||v!==n[9]||m!==n[10]||_!==n[12]||y!==n[13]||b!==n[14])&&(u|=r.LOCAL_CHANGED),u}function a(t,e){var n=e.getLocalTransform(),i=e.parent.getLocalTransform(),o=t.getSize(),s=e.vectors,a=e.offsets,u=t.getParent().getSize(),h=!1,c=n[0],l=n[1],p=n[2],f=n[4],d=n[5],g=n[6],v=n[8],m=n[9],_=n[10],y=n[12],b=n[13],w=n[14],x=i[0],T=i[1],E=i[2],I=i[4],A=i[5],C=i[6],R=i[8],S=i[9],O=i[10],M=i[12],z=i[13],L=i[14],N=s.position[0],D=s.position[1],U=s.position[2],P=s.rotation[0],F=s.rotation[1],k=s.rotation[2],G=s.rotation[3],B=s.scale[0],V=s.scale[1],H=s.scale[2],q=a.align[0]*u[0],j=a.align[1]*u[1],W=a.align[2]*u[2],Y=a.mountPoint[0]*o[0],Q=a.mountPoint[1]*o[1],K=a.mountPoint[2]*o[2],X=a.origin[0]*o[0],$=a.origin[1]*o[1],J=a.origin[2]*o[2],Z=G*P,tt=G*F,et=G*k,nt=P*P,rt=F*F,it=k*k,ot=P*F,st=P*k,at=F*k,ut=(1-2*(rt+it))*B,ht=2*(ot+et)*B,ct=2*(st-tt)*B,lt=2*(ot-et)*V,pt=(1-2*(nt+it))*V,ft=2*(at+Z)*V,dt=2*(st+tt)*H,gt=2*(at-Z)*H,vt=(1-2*(nt+rt))*H,mt=q+N-Y+X-(ut*X+lt*$+dt*J),_t=j+D-Q+$-(ht*X+pt*$+gt*J),yt=W+U-K+J-(ct*X+ft*$+vt*J);return n[0]=x*ut+I*ht+R*ct,n[1]=T*ut+A*ht+S*ct,n[2]=E*ut+C*ht+O*ct,n[3]=0,n[4]=x*lt+I*pt+R*ft,n[5]=T*lt+A*pt+S*ft,n[6]=E*lt+C*pt+O*ft,n[7]=0,n[8]=x*dt+I*gt+R*vt,n[9]=T*dt+A*gt+S*vt,n[10]=E*dt+C*gt+O*vt,n[11]=0,n[12]=x*mt+I*_t+R*yt+M,n[13]=T*mt+A*_t+S*yt+z,n[14]=E*mt+C*_t+O*yt+L,n[15]=1,e.isBreakPoint()&&e.calculateWorldMatrix()&&(h|=r.WORLD_CHANGED),(c!==n[0]||l!==n[1]||p!==n[2]||f!==n[4]||d!==n[5]||g!==n[6]||v!==n[8]||m!==n[9]||_!==n[10]||y!==n[12]||b!==n[13]||w!==n[14])&&(h|=r.LOCAL_CHANGED),h}function u(t,e,n){var r,i=e[0],o=e[1],s=e[2],a=e[4],u=e[5],h=e[6],c=e[8],l=e[9],p=e[10],f=e[12],d=e[13],g=e[14],v=!1,m=n[0],_=n[1],y=n[2],b=n[3];return r=m*i+_*a+y*c+b*f,v=v?v:t[0]===r,t[0]=r,r=m*o+_*u+y*l+b*d,v=v?v:t[1]===r,t[1]=r,r=m*s+_*h+y*p+b*g,v=v?v:t[2]===r,t[2]=r,t[3]=0,m=n[4],_=n[5],y=n[6],b=n[7],r=m*i+_*a+y*c+b*f,v=v?v:t[4]===r,t[4]=r,r=m*o+_*u+y*l+b*d,v=v?v:t[5]===r,t[5]=r,r=m*s+_*h+y*p+b*g,v=v?v:t[6]===r,t[6]=r,t[7]=0,m=n[8],_=n[9],y=n[10],b=n[11],r=m*i+_*a+y*c+b*f,v=v?v:t[8]===r,t[8]=r,r=m*o+_*u+y*l+b*d,v=v?v:t[9]===r,t[9]=r,r=m*s+_*h+y*p+b*g,v=v?v:t[10]===r,t[10]=r,t[11]=0,m=n[12],_=n[13],y=n[14],b=n[15],r=m*i+_*a+y*c+b*f,v=v?v:t[12]===r,t[12]=r,r=m*o+_*u+y*l+b*d,v=v?v:t[13]===r,t[13]=r,r=m*s+_*h+y*p+b*g,v=v?v:t[14]===r,t[14]=r,t[15]=1,v}var h=[0,0,0,1],c=[1,1,1];r.IDENT=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.WORLD_CHANGED=1,r.LOCAL_CHANGED=2,r.prototype.reset=function(){this.parent=null,this.breakPoint=!1},r.prototype.setParent=function(t){this.parent=t},r.prototype.getParent=function(){return this.parent},r.prototype.setBreakPoint=function(){this.breakPoint=!0},r.prototype.isBreakPoint=function(){return this.breakPoint},r.prototype.getLocalTransform=function(){return this.local},r.prototype.getWorldTransform=function(){if(!this.isBreakPoint())throw new Error("This transform is not calculating world transforms");return this.global},r.prototype.calculate=function(t){return!this.parent||this.parent.isBreakPoint()?s(t,this):a(t,this)},r.prototype.getPosition=function(){return this.vectors.position},r.prototype.setPosition=function(t,e,n){this.vectors.positionChanged=o(this.vectors.position,t,e,n)},r.prototype.getRotation=function(){return this.vectors.rotation},r.prototype.setRotation=function(t,e,n,r){var i,s,a,u,h=this.vectors.rotation;if(null!=r)i=t,s=e,a=n,u=r,this._lastEulerVals[0]=null,this._lastEulerVals[1]=null,this._lastEulerVals[2]=null,this._lastEuler=!1;else{if(null==t||null==e||null==n)if(this._lastEuler)t=null==t?this._lastEulerVals[0]:t,e=null==e?this._lastEulerVals[1]:e,n=null==n?this._lastEulerVals[2]:n;else{var c=-2*(h[1]*h[2]-h[3]*h[0]);Math.abs(c)>.99999?(e=null==e?.5*Math.PI*c:e,t=null==t?Math.atan2(-h[0]*h[2]+h[3]*h[1],.5-h[1]*h[1]-h[2]*h[2]):t,n=null==n?0:n):(e=null==e?Math.asin(c):e,t=null==t?Math.atan2(h[0]*h[2]+h[3]*h[1],.5-h[0]*h[0]-h[1]*h[1]):t,n=null==n?Math.atan2(h[0]*h[1]+h[3]*h[2],.5-h[0]*h[0]-h[2]*h[2]):n)}var l=.5*t,p=.5*e,f=.5*n,d=Math.sin(l),g=Math.sin(p),v=Math.sin(f),m=Math.cos(l),_=Math.cos(p),y=Math.cos(f),b=g*v,w=_*v,x=g*y,T=_*y;i=d*T+m*b,s=m*x-d*w,a=m*w+d*x,u=m*T-d*b,this._lastEuler=!0,this._lastEulerVals[0]=t,this._lastEulerVals[1]=e,this._lastEulerVals[2]=n}this.vectors.rotationChanged=o(h,i,s,a,u)},r.prototype.getScale=function(){return this.vectors.scale},r.prototype.setScale=function(t,e,n){this.vectors.scaleChanged=o(this.vectors.scale,t,e,n)},r.prototype.getAlign=function(){return this.offsets.align},r.prototype.setAlign=function(t,e,n){this.offsets.alignChanged=o(this.offsets.align,t,e,null!=n?n-.5:n);
},r.prototype.getMountPoint=function(){return this.offsets.mountPoint},r.prototype.setMountPoint=function(t,e,n){this.offsets.mountPointChanged=o(this.offsets.mountPoint,t,e,null!=n?n-.5:n)},r.prototype.getOrigin=function(){return this.offsets.origin},r.prototype.setOrigin=function(t,e,n){this.offsets.originChanged=o(this.offsets.origin,t,e,null!=n?n-.5:n)},r.prototype.calculateWorldMatrix=function(){for(var t=this.parent;t&&!t.isBreakPoint();)t=t.parent;if(t)return u(this.global,t.getWorldTransform(),this.local);for(var e=0;16>e;e++)this.global[e]=this.local[e];return!1},e.exports=r},{}],26:[function(t,e,n){"use strict";function r(){this.pathStore=new v}function i(t,e,n){var r=n.align[0],i=n.align[1],o=n.align[2];t.onAlignChange&&t.onAlignChange(r,i,o);for(var s=0,a=e.length;a>s;s++)e[s]&&e[s].onAlignChange&&e[s].onAlignChange(r,i,o);n.alignChanged=!1}function o(t,e,n){var r=n.mountPoint[0],i=n.mountPoint[1],o=n.mountPoint[2];t.onMountPointChange&&t.onMountPointChange(r,i,o);for(var s=0,a=e.length;a>s;s++)e[s]&&e[s].onMountPointChange&&e[s].onMountPointChange(r,i,o);n.mountPointChanged=!1}function s(t,e,n){var r=n.origin[0],i=n.origin[1],o=n.origin[2];t.onOriginChange&&t.onOriginChange(r,i,o);for(var s=0,a=e.length;a>s;s++)e[s]&&e[s].onOriginChange&&e[s].onOriginChange(r,i,o);n.originChanged=!1}function a(t,e,n){var r=n.position[0],i=n.position[1],o=n.position[2];t.onPositionChange&&t.onPositionChange(r,i,o);for(var s=0,a=e.length;a>s;s++)e[s]&&e[s].onPositionChange&&e[s].onPositionChange(r,i,o);n.positionChanged=!1}function u(t,e,n){var r=n.rotation[0],i=n.rotation[1],o=n.rotation[2],s=n.rotation[3];t.onRotationChange&&t.onRotationChange(r,i,o,s);for(var a=0,u=e.length;u>a;a++)e[a]&&e[a].onRotationChange&&e[a].onRotationChange(r,i,o,s);n.rotationChanged=!1}function h(t,e,n){var r=n.scale[0],i=n.scale[1],o=n.scale[2];t.onScaleChange&&t.onScaleChange(r,i,o);for(var s=0,a=e.length;a>s;s++)e[s]&&e[s].onScaleChange&&e[s].onScaleChange(r,i,o);n.scaleChanged=!1}function c(t,e,n){t.onTransformChange&&t.onTransformChange(n);for(var r=0,i=e.length;i>r;r++)e[r]&&e[r].onTransformChange&&e[r].onTransformChange(n)}function l(t,e,n){t.onLocalTransformChange&&t.onLocalTransformChange(n);for(var r=0,i=e.length;i>r;r++)e[r]&&e[r].onLocalTransformChange&&e[r].onLocalTransformChange(n)}function p(t,e,n){t.onWorldTransformChange&&t.onWorldTransformChange(n);for(var r=0,i=e.length;i>r;r++)e[r]&&e[r].onWorldTransformChange&&e[r].onWorldTransformChange(n)}var f=t("./Path"),d=t("./Transform"),g=t("./Dispatch"),v=t("./PathStore");r.prototype.registerTransformAtPath=function(t,e){if(!f.depth(t))return this.pathStore.insert(t,e?e:new d);var n=this.pathStore.get(f.parent(t));if(!n)throw new Error("No parent transform registered at expected path: "+f.parent(t));e&&e.setParent(n),this.pathStore.insert(t,e?e:new d(n))},r.prototype.deregisterTransformAtPath=function(t){this.pathStore.remove(t)},r.prototype.makeBreakPointAt=function(t){var e=this.pathStore.get(t);if(!e)throw new Error("No transform Registered at path: "+t);e.setBreakPoint()},r.prototype.get=function(t){return this.pathStore.get(t)},r.prototype.onUpdate=function(){for(var t,e,n,r,f,v,m=this.pathStore.getItems(),_=this.pathStore.getPaths(),y=0,b=m.length;b>y;y++)n=g.getNode(_[y]),n&&(v=n.getComponents(),t=m[y],r=t.vectors,f=t.offsets,f.alignChanged&&i(n,v,f),f.mountPointChanged&&o(n,v,f),f.originChanged&&s(n,v,f),r.positionChanged&&a(n,v,r),r.rotationChanged&&u(n,v,r),r.scaleChanged&&h(n,v,r),(e=t.calculate(n))&&(c(n,v,t),e&d.LOCAL_CHANGED&&l(n,v,t.getLocalTransform()),e&d.WORLD_CHANGED&&p(n,v,t.getWorldTransform())))},e.exports=new r},{"./Dispatch":16,"./Path":20,"./PathStore":21,"./Transform":25}],27:[function(t,e,n){"use strict";e.exports={Channel:t("./Channel"),Clock:t("./Clock"),Commands:t("./Commands"),Dispatch:t("./Dispatch"),Event:t("./Event"),FamousEngine:t("./FamousEngine"),Node:t("./Node"),Path:t("./Path"),PathStore:t("./PathStore"),Scene:t("./Scene"),Size:t("./Size"),SizeSystem:t("./SizeSystem"),Transform:t("./Transform"),TransformSystem:t("./TransformSystem")}},{"./Channel":13,"./Clock":14,"./Commands":15,"./Dispatch":16,"./Event":17,"./FamousEngine":18,"./Node":19,"./Path":20,"./PathStore":21,"./Scene":22,"./Size":23,"./SizeSystem":24,"./Transform":25,"./TransformSystem":26}],28:[function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error("DOMElement must be instantiated on a node");if(this._changeQueue=[],this._requestingUpdate=!1,this._renderSized=!1,this._requestRenderSize=!1,this._UIEvents=t.getUIEvents().slice(0),this._classes=["famous-dom-element"],this._requestingEventListeners=[],this._styles={},this._attributes={},this._content="",this._tagName=e&&e.tagName?e.tagName:"div",this._renderSize=[0,0,0],this._id=t?t.addComponent(this):null,this._node=t,this.onSizeModeChange.apply(this,t.getSizeMode()),this._callbacks=new i,this.setProperty("display",t.isShown()?"block":"none"),this.onOpacityChange(t.getOpacity()),e){var n,r;if(e.classes)for(n=0;n<e.classes.length;n++)this.addClass(e.classes[n]);if(e.attributes)for(r in e.attributes)this.setAttribute(r,e.attributes[r]);if(e.properties)for(r in e.properties)this.setProperty(r,e.properties[r]);e.id&&this.setId(e.id),e.content&&this.setContent(e.content),e.cutout===!1&&this.setCutoutState(e.cutout)}}var i=t("../utilities/CallbackStore"),o=t("../core/TransformSystem"),s=t("../core/Commands"),a=2;r.prototype.getValue=function(){return{classes:this._classes,styles:this._styles,attributes:this._attributes,content:this._content,id:this._attributes.id,tagName:this._tagName}},r.prototype.onUpdate=function(){var t=this._node,e=this._changeQueue,n=e.length;if(n&&t){for(t.sendDrawCommand(s.WITH),t.sendDrawCommand(t.getLocation());n--;)t.sendDrawCommand(e.shift());this._requestRenderSize&&(t.sendDrawCommand(s.DOM_RENDER_SIZE),t.sendDrawCommand(t.getLocation()),this._requestRenderSize=!1)}this._requestingUpdate=!1},r.prototype.onMount=function(t,e){this._node=t,this._id=e,this._UIEvents=t.getUIEvents().slice(0),o.makeBreakPointAt(t.getLocation()),this.draw(),this.setAttribute("data-fa-path",t.getLocation())},r.prototype.onDismount=function(){this.setProperty("display","none"),this.setAttribute("data-fa-path",""),this.setCutoutState(!1),this.onUpdate(),this._initialized=!1},r.prototype.onShow=function(){this.setProperty("display","block")},r.prototype.onHide=function(){this.setProperty("display","none")},r.prototype.setCutoutState=function(t){return this._initialized&&this._changeQueue.push(s.GL_CUTOUT_STATE,t),this._requestingUpdate||this._requestUpdate(),this},r.prototype.onTransformChange=function(t){this._changeQueue.push(s.CHANGE_TRANSFORM),t=t.getLocalTransform();for(var e=0,n=t.length;n>e;e++)this._changeQueue.push(t[e]);this._requestingUpdate||this._requestUpdate()},r.prototype.onSizeChange=function(t,e){var n=this._node.getSizeMode(),r=n[0]!==a,i=n[1]!==a;return this._initialized&&this._changeQueue.push(s.CHANGE_SIZE,r?t:r,i?e:i),this._requestingUpdate||this._requestUpdate(),this},r.prototype.onOpacityChange=function(t){return this.setProperty("opacity",t)},r.prototype.onAddUIEvent=function(t){return-1===this._UIEvents.indexOf(t)?(this._subscribe(t),this._UIEvents.push(t)):this._inDraw&&this._subscribe(t),this},r.prototype.onRemoveUIEvent=function(t){var e=this._UIEvents.indexOf(t);return-1!==e?(this._unsubscribe(t),this._UIEvents.splice(e,1)):this._inDraw&&this._unsubscribe(t),this},r.prototype._subscribe=function(t){this._initialized&&this._changeQueue.push(s.SUBSCRIBE,t),this._requestingUpdate||this._requestUpdate()},r.prototype.preventDefault=function(t){this._initialized&&this._changeQueue.push(s.PREVENT_DEFAULT,t),this._requestingUpdate||this._requestUpdate()},r.prototype.allowDefault=function(t){this._initialized&&this._changeQueue.push(s.ALLOW_DEFAULT,t),this._requestingUpdate||this._requestUpdate()},r.prototype._unsubscribe=function(t){this._initialized&&this._changeQueue.push("UNSUBSCRIBE",t),this._requestingUpdate||this._requestUpdate()},r.prototype.onSizeModeChange=function(t,e,n){(t===a||e===a||n===a)&&(this._renderSized=!0,this._requestRenderSize=!0);var r=this._node.getSize();this.onSizeChange(r[0],r[1])},r.prototype.getRenderSize=function(){return this._renderSize},r.prototype._requestUpdate=function(){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0)},r.prototype.init=function(){this._changeQueue.push(s.INIT_DOM,this._tagName),this._initialized=!0,this.onTransformChange(o.get(this._node.getLocation()));var t=this._node.getSize();this.onSizeChange(t[0],t[1]),this._requestingUpdate||this._requestUpdate()},r.prototype.setId=function(t){return this.setAttribute("id",t),this},r.prototype.addClass=function(t){return this._classes.indexOf(t)<0?(this._initialized&&this._changeQueue.push(s.ADD_CLASS,t),this._classes.push(t),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0),this):(this._inDraw&&(this._initialized&&this._changeQueue.push(s.ADD_CLASS,t),this._requestingUpdate||this._requestUpdate()),this)},r.prototype.removeClass=function(t){var e=this._classes.indexOf(t);return 0>e?this:(this._changeQueue.push(s.REMOVE_CLASS,t),this._classes.splice(e,1),this._requestingUpdate||this._requestUpdate(),this)},r.prototype.hasClass=function(t){return-1!==this._classes.indexOf(t)},r.prototype.setAttribute=function(t,e){return(this._attributes[t]!==e||this._inDraw)&&(this._attributes[t]=e,this._initialized&&this._changeQueue.push(s.CHANGE_ATTRIBUTE,t,e),this._requestUpdate||this._requestUpdate()),this},r.prototype.setProperty=function(t,e){return(this._styles[t]!==e||this._inDraw)&&(this._styles[t]=e,this._initialized&&this._changeQueue.push(s.CHANGE_PROPERTY,t,e),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0)),this},r.prototype.setContent=function(t){return(this._content!==t||this._inDraw)&&(this._content=t,this._initialized&&this._changeQueue.push(s.CHANGE_CONTENT,t),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0)),this},r.prototype.on=function(t,e){return this._callbacks.on(t,e)},r.prototype.onReceive=function(t,e){"resize"===t&&(this._renderSize[0]=e.val[0],this._renderSize[1]=e.val[1],this._requestingUpdate||this._requestUpdate()),this._callbacks.trigger(t,e)},r.prototype.draw=function(){var t,e,n;for(this._inDraw=!0,this.init(),e=0,n=this._classes.length;n>e;e++)this.addClass(this._classes[e]);this._content&&this.setContent(this._content);for(t in this._styles)null!=this._styles[t]&&this.setProperty(t,this._styles[t]);for(t in this._attributes)null!=this._attributes[t]&&this.setAttribute(t,this._attributes[t]);for(e=0,n=this._UIEvents.length;n>e;e++)this.onAddUIEvent(this._UIEvents[e]);this._inDraw=!1},e.exports=r},{"../core/Commands":15,"../core/TransformSystem":26,"../utilities/CallbackStore":94}],29:[function(t,e,n){"use strict";e.exports={DOMElement:t("./DOMElement")}},{"./DOMElement":28}],30:[function(t,e,n){"use strict";function r(t,e,n){var r=this;t.classList.add("famous-dom-renderer"),c=c||u("transform"),this._compositor=n,this._target=null,this._parent=null,this._path=null,this._children=[],this._root=new o(t,e),this._boundTriggerEvent=function(t){return r._triggerEvent(t)},this._selector=e,this._elements={},this._elements[e]=this._root,this.perspectiveTransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._VPtransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._lastEv=null}function i(t){for(var e=[],n=t.target;n!==document.body;)e.push(n),n=n.parentNode;return e}var o=t("./ElementCache"),s=t("./Math"),a=t("../core/Path"),u=t("../utilities/vendorPrefix"),h=t("./events/EventMap"),c=null;r.prototype.subscribe=function(t){this._assertTargetLoaded(),this._listen(t),this._target.subscribe[t]=!0},r.prototype.unsubscribe=function(t){this._assertTargetLoaded(),this._listen(t),this._target.subscribe[t]=!1},r.prototype.preventDefault=function(t){this._assertTargetLoaded(),this._listen(t),this._target.preventDefault[t]=!0},r.prototype.allowDefault=function(t){this._assertTargetLoaded(),this._listen(t),this._target.preventDefault[t]=!1},r.prototype._listen=function(t){if(this._assertTargetLoaded(),!this._target.listeners[t]&&!this._root.listeners[t]){var e=h[t][1]?this._root:this._target;e.listeners[t]=this._boundTriggerEvent,e.element.addEventListener(t,this._boundTriggerEvent)}},r.prototype.unsubscribe=function(t){this._assertTargetLoaded(),this._target.subscribe[t]=!1},r.prototype._triggerEvent=function(t){if(this._lastEv!==t)for(var e=t.path?t.path:i(t),n=0;n<e.length;n++)if(e[n].dataset){var r=e[n].dataset.faPath;if(r&&(this._elements[r].preventDefault[t.type]&&t.preventDefault(),this._elements[r]&&this._elements[r].subscribe[t.type])){this._lastEv=t;var o=h[t.type][0];this._compositor.sendEvent(r,t.type,new o(t));break}}},r.prototype.getSizeOf=function(t){var e=this._elements[t];if(!e)return null;var n={val:e.size};return this._compositor.sendEvent(t,"resize",n),n},r.prototype.draw=function(t){t.perspectiveDirty&&(this.perspectiveDirty=!0,this.perspectiveTransform[0]=t.perspectiveTransform[0],this.perspectiveTransform[1]=t.perspectiveTransform[1],this.perspectiveTransform[2]=t.perspectiveTransform[2],this.perspectiveTransform[3]=t.perspectiveTransform[3],this.perspectiveTransform[4]=t.perspectiveTransform[4],this.perspectiveTransform[5]=t.perspectiveTransform[5],this.perspectiveTransform[6]=t.perspectiveTransform[6],this.perspectiveTransform[7]=t.perspectiveTransform[7],this.perspectiveTransform[8]=t.perspectiveTransform[8],this.perspectiveTransform[9]=t.perspectiveTransform[9],this.perspectiveTransform[10]=t.perspectiveTransform[10],this.perspectiveTransform[11]=t.perspectiveTransform[11],this.perspectiveTransform[12]=t.perspectiveTransform[12],this.perspectiveTransform[13]=t.perspectiveTransform[13],this.perspectiveTransform[14]=t.perspectiveTransform[14],this.perspectiveTransform[15]=t.perspectiveTransform[15]),(t.viewDirty||t.perspectiveDirty)&&(s.multiply(this._VPtransform,this.perspectiveTransform,t.viewTransform),this._root.element.style[c]=this._stringifyMatrix(this._VPtransform))},r.prototype._assertPathLoaded=function(){if(!this._path)throw new Error("path not loaded")},r.prototype._assertParentLoaded=function(){if(!this._parent)throw new Error("parent not loaded")},r.prototype._assertChildrenLoaded=function(){if(!this._children)throw new Error("children not loaded")},r.prototype._assertTargetLoaded=function(){if(!this._target)throw new Error("No target loaded")},r.prototype.findParent=function(){this._assertPathLoaded();for(var t,e=this._path;!t&&e.length;)e=e.substring(0,e.lastIndexOf("/")),t=this._elements[e];return this._parent=t,t},r.prototype.findTarget=function(){return this._target=this._elements[this._path],this._target},r.prototype.loadPath=function(t){return this._path=t,this._path},r.prototype.resolveChildren=function(t,e){for(var n,r,i=0,o=this._path;n=e.childNodes[i];)n.dataset?(r=n.dataset.faPath,r&&a.isDescendentOf(r,o)?t.appendChild(n):i++):i++},r.prototype.insertEl=function(t){if(!this._target||this._target.element.tagName.toLowerCase()!==t.toLowerCase()){if(this.findParent(),this._assertParentLoaded(),this._parent.void)throw new Error(this._parent.path+" is a void element. Void elements are not allowed to have children.");this._target&&this._parent.element.removeChild(this._target.element),this._target=new o(document.createElement(t),this._path);var e=this._target.element,n=this._parent.element;this.resolveChildren(e,n),this._parent.element.appendChild(this._target.element),this._elements[this._path]=this._target}},r.prototype.setProperty=function(t,e){this._assertTargetLoaded(),this._target.element.style[t]=e},r.prototype.setSize=function(t,e){this._assertTargetLoaded(),this.setWidth(t),this.setHeight(e)},r.prototype.setWidth=function(t){this._assertTargetLoaded();var e=this._target.content;t===!1?(this._target.explicitWidth=!0,e&&(e.style.width=""),t=e?e.offsetWidth:0,this._target.element.style.width=t+"px"):(this._target.explicitWidth=!1,e&&(e.style.width=t+"px"),this._target.element.style.width=t+"px"),this._target.size[0]=t},r.prototype.setHeight=function(t){this._assertTargetLoaded();var e=this._target.content;t===!1?(this._target.explicitHeight=!0,e&&(e.style.height=""),t=e?e.offsetHeight:0,this._target.element.style.height=t+"px"):(this._target.explicitHeight=!1,e&&(e.style.height=t+"px"),this._target.element.style.height=t+"px"),this._target.size[1]=t},r.prototype.setAttribute=function(t,e){this._assertTargetLoaded(),this._target.element.setAttribute(t,e)},r.prototype.setContent=function(t){this._assertTargetLoaded(),this._target.formElement?this._target.element.value=t:(this._target.content||(this._target.content=document.createElement("div"),this._target.content.classList.add("famous-dom-element-content"),this._target.element.insertBefore(this._target.content,this._target.element.firstChild)),this._target.content.innerHTML=t),this.setSize(this._target.explicitWidth?!1:this._target.size[0],this._target.explicitHeight?!1:this._target.size[1])},r.prototype.setMatrix=function(t){this._assertTargetLoaded(),this._target.element.style[c]=this._stringifyMatrix(t)},r.prototype.addClass=function(t){this._assertTargetLoaded(),this._target.element.classList.add(t)},r.prototype.removeClass=function(t){this._assertTargetLoaded(),this._target.element.classList.remove(t)},r.prototype._stringifyMatrix=function(t){var e="matrix3d(";return e+=t[0]<1e-6&&t[0]>-1e-6?"0,":t[0]+",",e+=t[1]<1e-6&&t[1]>-1e-6?"0,":t[1]+",",e+=t[2]<1e-6&&t[2]>-1e-6?"0,":t[2]+",",e+=t[3]<1e-6&&t[3]>-1e-6?"0,":t[3]+",",e+=t[4]<1e-6&&t[4]>-1e-6?"0,":t[4]+",",e+=t[5]<1e-6&&t[5]>-1e-6?"0,":t[5]+",",e+=t[6]<1e-6&&t[6]>-1e-6?"0,":t[6]+",",e+=t[7]<1e-6&&t[7]>-1e-6?"0,":t[7]+",",e+=t[8]<1e-6&&t[8]>-1e-6?"0,":t[8]+",",e+=t[9]<1e-6&&t[9]>-1e-6?"0,":t[9]+",",e+=t[10]<1e-6&&t[10]>-1e-6?"0,":t[10]+",",e+=t[11]<1e-6&&t[11]>-1e-6?"0,":t[11]+",",e+=t[12]<1e-6&&t[12]>-1e-6?"0,":t[12]+",",e+=t[13]<1e-6&&t[13]>-1e-6?"0,":t[13]+",",e+=t[14]<1e-6&&t[14]>-1e-6?"0,":t[14]+",",e+=t[15]+")"},e.exports=r},{"../core/Path":20,"../utilities/vendorPrefix":104,"./ElementCache":31,"./Math":32,"./events/EventMap":36}],31:[function(t,e,n){"use strict";function r(t,e){this.tagName=t.tagName.toLowerCase(),this.void=i[this.tagName];var n=t.constructor;this.formElement=n===HTMLInputElement||n===HTMLTextAreaElement||n===HTMLSelectElement,this.element=t,this.path=e,this.content=null,this.size=new Int16Array(3),this.explicitHeight=!1,this.explicitWidth=!1,this.postRenderSize=new Float32Array(2),this.listeners={},this.preventDefault={},this.subscribe={}}var i=t("./VoidElements");e.exports=r},{"./VoidElements":33}],32:[function(t,e,n){"use strict";function r(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],l=e[9],p=e[10],f=e[11],d=e[12],g=e[13],v=e[14],m=e[15],_=n*a-r*s,y=n*u-i*s,b=n*h-o*s,w=r*u-i*a,x=r*h-o*a,T=i*h-o*u,E=c*g-l*d,I=c*v-p*d,A=c*m-f*d,C=l*v-p*g,R=l*m-f*g,S=p*m-f*v,O=_*S-y*R+b*C+w*A-x*I+T*E;return O?(O=1/O,t[0]=(a*S-u*R+h*C)*O,t[1]=(i*R-r*S-o*C)*O,t[2]=(g*T-v*x+m*w)*O,t[3]=(p*x-l*T-f*w)*O,t[4]=(u*A-s*S-h*I)*O,t[5]=(n*S-i*A+o*I)*O,t[6]=(v*b-d*T-m*y)*O,t[7]=(c*T-p*b+f*y)*O,t[8]=(s*R-a*A+h*E)*O,t[9]=(r*A-n*R-o*E)*O,t[10]=(d*x-g*b+m*_)*O,t[11]=(l*b-c*x-f*_)*O,t[12]=(a*I-s*C-u*E)*O,t[13]=(n*C-r*I+i*E)*O,t[14]=(g*y-d*w-v*_)*O,t[15]=(c*w-l*y+p*_)*O,t):null}function i(t,e,n){var r,i,o,s,a=e[0],u=e[1],h=e[2],c=e[3],l=e[4],p=e[5],f=e[6],d=e[7],g=e[8],v=e[9],m=e[10],_=e[11],y=e[12],b=e[13],w=e[14],x=e[15],T=n[0],E=n[1],I=n[2],A=n[3],C=n[4],R=n[5],S=n[6],O=n[7],M=n[8],z=n[9],L=n[10],N=n[11],D=n[12],U=n[13],P=n[14],F=n[15],k=!1;return r=T*a+E*l+I*g+A*y,i=T*u+E*p+I*v+A*b,o=T*h+E*f+I*m+A*w,s=T*c+E*d+I*_+A*x,k=k?k:r===t[0]||i===t[1]||o===t[2]||s===t[3],t[0]=r,t[1]=i,t[2]=o,t[3]=s,T=C,E=R,I=S,A=O,r=T*a+E*l+I*g+A*y,i=T*u+E*p+I*v+A*b,o=T*h+E*f+I*m+A*w,s=T*c+E*d+I*_+A*x,k=k?k:r===t[4]||i===t[5]||o===t[6]||s===t[7],t[4]=r,t[5]=i,t[6]=o,t[7]=s,T=M,E=z,I=L,A=N,r=T*a+E*l+I*g+A*y,i=T*u+E*p+I*v+A*b,o=T*h+E*f+I*m+A*w,s=T*c+E*d+I*_+A*x,k=k?k:r===t[8]||i===t[9]||o===t[10]||s===t[11],t[8]=r,t[9]=i,t[10]=o,t[11]=s,T=D,E=U,I=P,A=F,r=T*a+E*l+I*g+A*y,i=T*u+E*p+I*v+A*b,o=T*h+E*f+I*m+A*w,s=T*c+E*d+I*_+A*x,k=k?k:r===t[12]||i===t[13]||o===t[14]||s===t[15],t[12]=r,t[13]=i,t[14]=o,t[15]=s,t}e.exports={multiply:i,invert:r}},{}],33:[function(t,e,n){"use strict";var r={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};e.exports=r},{}],34:[function(t,e,n){"use strict";function r(t){i.call(this,t),this.data=t.data}var i=t("./UIEvent");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return"CompositionEvent"},e.exports=r},{"./UIEvent":42}],35:[function(t,e,n){"use strict";function r(t){this.type=t.type,this.defaultPrevented=t.defaultPrevented,this.timeStamp=t.timeStamp;var e=t.target.constructor;(e===HTMLInputElement||e===HTMLTextAreaElement||e===HTMLSelectElement)&&(this.value=t.target.value)}r.prototype.toString=function(){return"Event"},e.exports=r},{}],36:[function(t,e,n){"use strict";var r=t("./CompositionEvent"),i=t("./Event"),o=t("./FocusEvent"),s=t("./InputEvent"),a=t("./KeyboardEvent"),u=t("./MouseEvent"),h=t("./TouchEvent"),c=t("./UIEvent"),l=t("./WheelEvent"),p={change:[i,!0],submit:[i,!0],abort:[i,!1],beforeinput:[s,!0],blur:[o,!1],click:[u,!0],compositionend:[r,!0],compositionstart:[r,!0],compositionupdate:[r,!0],dblclick:[u,!0],focus:[o,!1],focusin:[o,!0],focusout:[o,!0],input:[s,!0],keydown:[a,!0],keyup:[a,!0],load:[i,!1],mousedown:[u,!0],mouseenter:[u,!1],mouseleave:[u,!1],mousemove:[u,!1],mouseout:[u,!0],mouseover:[u,!0],mouseup:[u,!0],resize:[c,!1],scroll:[c,!1],select:[i,!0],unload:[i,!1],wheel:[l,!0],touchcancel:[h,!0],touchend:[h,!0],touchmove:[h,!0],touchstart:[h,!0]};e.exports=p},{"./CompositionEvent":34,"./Event":35,"./FocusEvent":37,"./InputEvent":38,"./KeyboardEvent":39,"./MouseEvent":40,"./TouchEvent":41,"./UIEvent":42,"./WheelEvent":43}],37:[function(t,e,n){"use strict";function r(t){i.call(this,t)}var i=t("./UIEvent");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return"FocusEvent"},e.exports=r},{"./UIEvent":42}],38:[function(t,e,n){"use strict";function r(t){i.call(this,t),this.inputType=t.inputType,this.data=t.data,this.isComposing=t.isComposing,this.targetRange=t.targetRange}var i=t("./UIEvent");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return"InputEvent"},e.exports=r},{"./UIEvent":42}],39:[function(t,e,n){"use strict";function r(t){i.call(this,t),this.DOM_KEY_LOCATION_STANDARD=0,this.DOM_KEY_LOCATION_LEFT=1,this.DOM_KEY_LOCATION_RIGHT=2,this.DOM_KEY_LOCATION_NUMPAD=3,this.key=t.key,this.code=t.code,this.location=t.location,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.repeat=t.repeat,this.isComposing=t.isComposing,this.keyCode=t.keyCode}var i=t("./UIEvent");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return"KeyboardEvent"},e.exports=r},{"./UIEvent":42}],40:[function(t,e,n){"use strict";function r(t){i.call(this,t),this.screenX=t.screenX,this.screenY=t.screenY,this.clientX=t.clientX,this.clientY=t.clientY,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.button=t.button,this.buttons=t.buttons,this.pageX=t.pageX,this.pageY=t.pageY,this.x=t.x,this.y=t.y,this.offsetX=t.offsetX,this.offsetY=t.offsetY}var i=t("./UIEvent");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return"MouseEvent"},e.exports=r},{"./UIEvent":42}],41:[function(t,e,n){"use strict";function r(t){this.identifier=t.identifier,this.screenX=t.screenX,this.screenY=t.screenY,this.clientX=t.clientX,this.clientY=t.clientY,this.pageX=t.pageX,this.pageY=t.pageY}function i(t){if(!t)return a;for(var e=[],n=0;n<t.length;n++)e[n]=new r(t[n]);return e}function o(t){s.call(this,t),this.touches=i(t.touches),this.targetTouches=i(t.targetTouches),this.changedTouches=i(t.changedTouches),this.altKey=t.altKey,this.metaKey=t.metaKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey}var s=t("./UIEvent"),a=[];o.prototype=Object.create(s.prototype),o.prototype.constructor=o,o.prototype.toString=function(){return"TouchEvent"},e.exports=o},{"./UIEvent":42}],42:[function(t,e,n){"use strict";function r(t){i.call(this,t),this.detail=t.detail}var i=t("./Event");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return"UIEvent"},e.exports=r},{"./Event":35}],43:[function(t,e,n){"use strict";function r(t){i.call(this,t),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2,this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.deltaZ=t.deltaZ,this.deltaMode=t.deltaMode}var i=t("./MouseEvent");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return"WheelEvent"},e.exports=r},{"./MouseEvent":40}],44:[function(t,e,n){"use strict";e.exports={CompositionEvent:t("./CompositionEvent"),Event:t("./Event"),EventMap:t("./EventMap"),FocusEvent:t("./FocusEvent"),InputEvent:t("./InputEvent"),KeyboardEvent:t("./KeyboardEvent"),MouseEvent:t("./MouseEvent"),TouchEvent:t("./TouchEvent"),UIEvent:t("./UIEvent"),WheelEvent:t("./WheelEvent")}},{"./CompositionEvent":34,"./Event":35,"./EventMap":36,"./FocusEvent":37,"./InputEvent":38,"./KeyboardEvent":39,"./MouseEvent":40,"./TouchEvent":41,"./UIEvent":42,"./WheelEvent":43}],45:[function(t,e,n){"use strict";e.exports={DOMRenderer:t("./DOMRenderer"),ElementCache:t("./ElementCache"),Events:t("./events"),Math:t("./Math"),VoidElements:t("./VoidElements")}},{"./DOMRenderer":30,"./ElementCache":31,"./Math":32,"./VoidElements":33,"./events":44}],46:[function(t,e,n){e.exports={components:t("./components"),core:t("./core"),renderLoops:t("./render-loops"),domRenderables:t("./dom-renderables"),domRenderers:t("./dom-renderers"),math:t("./math"),physics:t("./physics"),renderers:t("./renderers"),transitions:t("./transitions"),utilities:t("./utilities"),webglRenderables:t("./webgl-renderables"),webglRenderers:t("./webgl-renderers"),webglGeometries:t("./webgl-geometries"),webglMaterials:t("./webgl-materials"),webglShaders:t("./webgl-shaders"),polyfills:t("./polyfills")}},{"./components":12,"./core":27,"./dom-renderables":29,"./dom-renderers":45,"./math":51,"./physics":79,"./polyfills":81,"./render-loops":84,"./renderers":89,"./transitions":93,"./utilities":100,"./webgl-geometries":109,"./webgl-materials":123,"./webgl-renderables":125,"./webgl-renderers":138,"./webgl-shaders":140}],47:[function(t,e,n){"use strict";function r(t){this.values=t||[1,0,0,0,1,0,0,0,1]}r.prototype.get=function(){return this.values},r.prototype.set=function(t){return this.values=t,this},r.prototype.copy=function(t){var e=this.values,n=t.values;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},r.prototype.vectorMultiply=function(t,e){var n=this.values,r=t.x,i=t.y,o=t.z;return e.x=n[0]*r+n[1]*i+n[2]*o,e.y=n[3]*r+n[4]*i+n[5]*o,e.z=n[6]*r+n[7]*i+n[8]*o,e},r.prototype.multiply=function(t){var e=this.values,n=t.values,r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],l=e[8],p=n[0],f=n[1],d=n[2],g=n[3],v=n[4],m=n[5],_=n[6],y=n[7],b=n[8];return e[0]=r*p+i*g+o*_,e[1]=r*f+i*v+o*y,e[2]=r*d+i*m+o*b,e[3]=s*p+a*g+u*_,e[4]=s*f+a*v+u*y,e[5]=s*d+a*m+u*b,e[6]=h*p+c*g+l*_,e[7]=h*f+c*v+l*y,e[8]=h*d+c*m+l*b,this},r.prototype.transpose=function(){var t=this.values,e=t[1],n=t[2],r=t[3],i=t[5],o=t[6],s=t[7];return t[1]=r,t[2]=o,t[3]=e,t[5]=s,t[6]=n,t[7]=i,this},r.prototype.getDeterminant=function(){var t=this.values,e=t[3],n=t[4],r=t[5],i=t[6],o=t[7],s=t[8],a=t[0]*(n*s-r*o)-t[1]*(e*s-r*i)+t[2]*(e*o-n*i);return a},r.prototype.inverse=function(){var t=this.values,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],h=t[8],c=e*(o*h-s*u)-n*(i*h-s*a)+r*(i*u-o*a);return Math.abs(c)<1e-40?null:(c=1/c,t[0]=(o*h-s*u)*c,t[3]=(-i*h+s*a)*c,t[6]=(i*u-o*a)*c,t[1]=(-n*h+r*u)*c,t[4]=(e*h-r*a)*c,t[7]=(-e*u+n*a)*c,t[2]=(n*s-r*o)*c,t[5]=(-e*s+r*i)*c,t[8]=(e*o-n*i)*c,this)},r.clone=function(t){return new r(t.values.slice())},r.inverse=function(t,e){var n=t.values,r=e.values,i=n[0],o=n[1],s=n[2],a=n[3],u=n[4],h=n[5],c=n[6],l=n[7],p=n[8],f=i*(u*p-h*l)-o*(a*p-h*c)+s*(a*l-u*c);return Math.abs(f)<1e-40?null:(f=1/f,r[0]=(u*p-h*l)*f,r[3]=(-a*p+h*c)*f,r[6]=(a*l-u*c)*f,r[1]=(-o*p+s*l)*f,r[4]=(i*p-s*c)*f,r[7]=(-i*l+o*c)*f,r[2]=(o*h-s*u)*f,r[5]=(-i*h+s*a)*f,r[8]=(i*u-o*a)*f,e)},r.transpose=function(t,e){var n=t.values,r=e.values,i=n[0],o=n[1],s=n[2],a=n[3],u=n[4],h=n[5],c=n[6],l=n[7],p=n[8];return r[0]=i,r[1]=a,r[2]=c,r[3]=o,r[4]=u,r[5]=l,r[6]=s,r[7]=h,r[8]=p,e},r.add=function(t,e,n){var r=t.values,i=e.values,o=n.values,s=r[0],a=r[1],u=r[2],h=r[3],c=r[4],l=r[5],p=r[6],f=r[7],d=r[8],g=i[0],v=i[1],m=i[2],_=i[3],y=i[4],b=i[5],w=i[6],x=i[7],T=i[8];return o[0]=s+g,o[1]=a+v,o[2]=u+m,o[3]=h+_,o[4]=c+y,o[5]=l+b,o[6]=p+w,o[7]=f+x,o[8]=d+T,n},r.subtract=function(t,e,n){var r=t.values,i=e.values,o=n.values,s=r[0],a=r[1],u=r[2],h=r[3],c=r[4],l=r[5],p=r[6],f=r[7],d=r[8],g=i[0],v=i[1],m=i[2],_=i[3],y=i[4],b=i[5],w=i[6],x=i[7],T=i[8];return o[0]=s-g,o[1]=a-v,o[2]=u-m,o[3]=h-_,o[4]=c-y,o[5]=l-b,o[6]=p-w,o[7]=f-x,o[8]=d-T,n},r.multiply=function(t,e,n){var r=t.values,i=e.values,o=n.values,s=r[0],a=r[1],u=r[2],h=r[3],c=r[4],l=r[5],p=r[6],f=r[7],d=r[8],g=i[0],v=i[1],m=i[2],_=i[3],y=i[4],b=i[5],w=i[6],x=i[7],T=i[8];return o[0]=s*g+a*_+u*w,o[1]=s*v+a*y+u*x,o[2]=s*m+a*b+u*T,o[3]=h*g+c*_+l*w,o[4]=h*v+c*y+l*x,o[5]=h*m+c*b+l*T,o[6]=p*g+f*_+d*w,o[7]=p*v+f*y+d*x,o[8]=p*m+f*b+d*T,n},e.exports=r},{}],48:[function(t,e,n){"use strict";function r(t,e,n,r){this.w=t||1,this.x=e||0,this.y=n||0,this.z=r||0}var i=Math.sin,o=Math.cos,s=Math.asin,a=Math.acos,u=Math.atan2,h=Math.sqrt;r.prototype.multiply=function(t){var e=this.x,n=this.y,r=this.z,i=this.w,o=t.x,s=t.y,a=t.z,u=t.w||0;return this.w=i*u-e*o-n*s-r*a,this.x=e*u+o*i+s*r-n*a,this.y=n*u+s*i+e*a-o*r,this.z=r*u+a*i+o*n-e*s,this},r.prototype.leftMultiply=function(t){var e=t.x,n=t.y,r=t.z,i=t.w||0,o=this.x,s=this.y,a=this.z,u=this.w;return this.w=i*u-e*o-n*s-r*a,this.x=e*u+o*i+s*r-n*a,this.y=n*u+s*i+e*a-o*r,this.z=r*u+a*i+o*n-e*s,this},r.prototype.rotateVector=function(t,e){var n=this.w,r=-this.x,i=-this.y,o=-this.z,s=t.x,a=t.y,u=t.z,h=-r*s-i*a-o*u,c=s*n+a*o-i*u,l=a*n+r*u-s*o,p=u*n+s*i-r*a,f=n,d=-r,g=-i,v=-o;return e.x=c*f+d*h+g*p-l*v,e.y=l*f+g*h+c*v-d*p,e.z=p*f+v*h+d*l-c*g,e},r.prototype.invert=function(){return this.w=-this.w,this.x=-this.x,this.y=-this.y,this.z=-this.z,this},r.prototype.conjugate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},r.prototype.length=function(){var t=this.w,e=this.x,n=this.y,r=this.z;return h(t*t+e*e+n*n+r*r)},r.prototype.normalize=function(){var t=this.w,e=this.x,n=this.y,r=this.z,i=h(t*t+e*e+n*n+r*r);return 0===i?this:(i=1/i,this.w*=i,this.x*=i,this.y*=i,this.z*=i,this)},r.prototype.set=function(t,e,n,r){return null!=t&&(this.w=t),null!=e&&(this.x=e),null!=n&&(this.y=n),null!=r&&(this.z=r),this},r.prototype.copy=function(t){return this.w=t.w,this.x=t.x,this.y=t.y,this.z=t.z,this},r.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},r.prototype.dot=function(t){return this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z},r.prototype.slerp=function(t,e,n){var r,o,s,u,h,c=this.w,l=this.x,p=this.y,f=this.z,d=t.w,g=t.x,v=t.y,m=t.z;return o=c*d+l*g+p*v+f*m,1-o>1e-5?(r=a(o),s=i(r),u=i((1-e)*r)/s,h=i(e*r)/s):(u=1-e,h=e),n.w=c*u+d*h,n.x=l*u+g*h,n.y=p*u+v*h,n.z=f*u+m*h,n},r.prototype.toMatrix=function(t){var e=this.w,n=this.x,r=this.y,i=this.z,o=n*n,s=r*r,a=i*i,u=n*r,h=n*i,c=r*i;return t.set([1-2*(s+a),2*(u-e*i),2*(h+e*r),2*(u+e*i),1-2*(o+a),2*(c-e*n),2*(h-e*r),2*(c+e*n),1-2*(o+s)])},r.prototype.toEuler=function(t){var e=this.w,n=this.x,r=this.y,i=this.z,o=n*n,a=r*r,h=i*i,c=2*(n*i+r*e);return c=-1>c?-1:c>1?1:c,
t.x=u(2*(n*e-r*i),1-2*(o+a)),t.y=s(c),t.z=u(2*(i*e-n*r),1-2*(a+h)),t},r.prototype.fromEuler=function(t,e,n){var r=.5*t,s=.5*e,a=.5*n,u=i(r),h=i(s),c=i(a),l=o(r),p=o(s),f=o(a);return this.w=l*p*f-u*h*c,this.x=u*p*f+l*h*c,this.y=l*h*f-u*p*c,this.z=l*p*c+u*h*f,this},r.prototype.fromAngleAxis=function(t,e,n,r){var s=h(e*e+n*n+r*r);if(0===s)this.w=1,this.x=this.y=this.z=0;else{s=1/s;var a=.5*t,u=i(a);this.w=o(a),this.x=u*e*s,this.y=u*n*s,this.z=u*r*s}return this},r.multiply=function(t,e,n){var r=t.w||0,i=t.x,o=t.y,s=t.z,a=e.w||0,u=e.x,h=e.y,c=e.z;return n.w=r*a-i*u-o*h-s*c,n.x=i*a+u*r+h*s-o*c,n.y=o*a+h*r+i*c-u*s,n.z=s*a+c*r+u*o-i*h,n},r.normalize=function(t,e){var n=t.w,r=t.x,i=t.y,o=t.z,s=h(n*n+r*r+i*i+o*o);return 0===s?this:(s=1/s,e.w*=s,e.x*=s,e.y*=s,e.z*=s,e)},r.conjugate=function(t,e){return e.w=t.w,e.x=-t.x,e.y=-t.y,e.z=-t.z,e},r.clone=function(t){return new r(t.w,t.x,t.y,t.z)},r.dot=function(t,e){return t.w*e.w+t.x*e.x+t.y*e.y+t.z*e.z},e.exports=r},{}],49:[function(t,e,n){"use strict";var r=function(t,e){t instanceof Array||t instanceof Float32Array?(this.x=t[0]||0,this.y=t[1]||0):(this.x=t||0,this.y=e||0)};r.prototype.set=function(t,e){return null!=t&&(this.x=t),null!=e&&(this.y=e),this},r.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},r.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},r.prototype.scale=function(t){return t instanceof r?(this.x*=t.x,this.y*=t.y):(this.x*=t,this.y*=t),this},r.prototype.rotate=function(t){var e=this.x,n=this.y,r=Math.cos(t),i=Math.sin(t);return this.x=e*r-n*i,this.y=e*i+n*r,this},r.prototype.dot=function(t){return this.x*t.x+this.y*t.y},r.prototype.cross=function(t){return this.x*t.y-this.y*t.x},r.prototype.invert=function(){return this.x*=-1,this.y*=-1,this},r.prototype.map=function(t){return this.x=t(this.x),this.y=t(this.y),this},r.prototype.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},r.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},r.prototype.clear=function(){return this.x=0,this.y=0,this},r.prototype.isZero=function(){return 0!==this.x||0!==this.y?!1:!0},r.prototype.toArray=function(){return[this.x,this.y]},r.normalize=function(t,e){var n=t.x,r=t.y,i=Math.sqrt(n*n+r*r)||1;return i=1/i,e.x=t.x*i,e.y=t.y*i,e},r.clone=function(t){return new r(t.x,t.y)},r.add=function(t,e,n){return n.x=t.x+e.x,n.y=t.y+e.y,n},r.subtract=function(t,e,n){return n.x=t.x-e.x,n.y=t.y-e.y,n},r.scale=function(t,e,n){return n.x=t.x*e,n.y=t.y*e,n},r.dot=function(t,e){return t.x*e.x+t.y*e.y},r.cross=function(t,e){return t.x*e.y-t.y*e.x},e.exports=r},{}],50:[function(t,e,n){"use strict";var r=function(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0};r.prototype.set=function(t,e,n){return null!=t&&(this.x=t),null!=e&&(this.y=e),null!=n&&(this.z=n),this},r.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},r.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},r.prototype.rotateX=function(t){var e=this.y,n=this.z,r=Math.cos(t),i=Math.sin(t);return this.y=e*r-n*i,this.z=e*i+n*r,this},r.prototype.rotateY=function(t){var e=this.x,n=this.z,r=Math.cos(t),i=Math.sin(t);return this.x=n*i+e*r,this.z=n*r-e*i,this},r.prototype.rotateZ=function(t){var e=this.x,n=this.y,r=Math.cos(t),i=Math.sin(t);return this.x=e*r-n*i,this.y=e*i+n*r,this},r.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},r.prototype.cross=function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,s=t.z;return this.x=n*s-r*o,this.y=r*i-e*s,this.z=e*o-n*i,this},r.prototype.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},r.prototype.invert=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},r.prototype.map=function(t){return this.x=t(this.x),this.y=t(this.y),this.z=t(this.z),this},r.prototype.length=function(){var t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)},r.prototype.lengthSq=function(){var t=this.x,e=this.y,n=this.z;return t*t+e*e+n*n},r.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},r.prototype.clear=function(){return this.x=0,this.y=0,this.z=0,this},r.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z},r.prototype.toArray=function(){return[this.x,this.y,this.z]},r.prototype.normalize=function(){var t=this.x,e=this.y,n=this.z,r=Math.sqrt(t*t+e*e+n*n)||1;return r=1/r,this.x*=r,this.y*=r,this.z*=r,this},r.prototype.applyRotation=function(t){var e=t.w,n=-t.x,r=-t.y,i=-t.z,o=this.x,s=this.y,a=this.z,u=-n*o-r*s-i*a,h=o*e+s*i-r*a,c=s*e+n*a-o*i,l=a*e+o*r-n*s,p=e,f=-n,d=-r,g=-i;return this.x=h*p+f*u+d*l-c*g,this.y=c*p+d*u+h*g-f*l,this.z=l*p+g*u+f*c-h*d,this},r.prototype.applyMatrix=function(t){var e=t.get(),n=this.x,r=this.y,i=this.z;return this.x=e[0]*n+e[1]*r+e[2]*i,this.y=e[3]*n+e[4]*r+e[5]*i,this.z=e[6]*n+e[7]*r+e[8]*i,this},r.normalize=function(t,e){var n=t.x,r=t.y,i=t.z,o=Math.sqrt(n*n+r*r+i*i)||1;return o=1/o,e.x=n*o,e.y=r*o,e.z=i*o,e},r.applyRotation=function(t,e,n){var r=e.w,i=-e.x,o=-e.y,s=-e.z,a=t.x,u=t.y,h=t.z,c=-i*a-o*u-s*h,l=a*r+u*s-o*h,p=u*r+i*h-a*s,f=h*r+a*o-i*u,d=r,g=-i,v=-o,m=-s;return n.x=l*d+g*c+v*f-p*m,n.y=p*d+v*c+l*m-g*f,n.z=f*d+m*c+g*p-l*v,n},r.clone=function(t){return new r(t.x,t.y,t.z)},r.add=function(t,e,n){return n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n},r.subtract=function(t,e,n){return n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n},r.scale=function(t,e,n){return n.x=t.x*e,n.y=t.y*e,n.z=t.z*e,n},r.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},r.cross=function(t,e,n){var r=t.x,i=t.y,o=t.z,s=e.x,a=e.y,u=e.z;return n.x=i*u-o*a,n.y=o*s-r*u,n.z=r*a-i*s,n},r.project=function(t,e,n){var r=t.x,i=t.y,o=t.z,s=e.x,a=e.y,u=e.z,h=r*s+i*a+o*u;return h/=s*s+a*a+u*u,n.x=s*h,n.y=a*h,n.z=u*h,n},e.exports=r},{}],51:[function(t,e,n){e.exports={Mat33:t("./Mat33"),Quaternion:t("./Quaternion"),Vec2:t("./Vec2"),Vec3:t("./Vec3")}},{"./Mat33":47,"./Quaternion":48,"./Vec2":49,"./Vec3":50}],52:[function(t,e,n){"use strict";function r(t,e,n){var r=m;return p.cross(t,e,r),p.cross(r,n,r),r}function i(t,e){for(var n,r,i,o,s=-(1/0),a=0;a<t.length;a++)i=t[a],r=p.dot(i,e),r>s&&(n=i,s=r,o=a);return{vertex:n,index:o}}function o(t,e,n){this.distance=t,this.normal=e,this.vertexIndices=n}function s(){this.vertices=[],this.numVertices=0,this.features=[],this.numFeatures=0,this.lastVertexIndex=0,this._IDPool={vertices:[],features:[]}}function a(t,e,n,r){for(var i=t[n].vertex,o=t[r].vertex,s=0,a=e.length;a>s;s++){var u=e[s];if(u){var h=t[u[0]].vertex,c=t[u[1]].vertex;if(i===h&&o===c||i===c&&o===h)return void(e[s]=null)}}e.push([n,r])}function u(t,e){e=e||1e3;var n,r,i=h(t,e),o=[];for(n=0,r=i.features.length;r>n;n++){var s=i.features[n];s&&o.push(s.vertexIndices)}var a=l(i.vertices,o),u=a.centroid,c=[];for(n=0,r=i.vertices.length;r>n;n++)c.push(p.subtract(i.vertices[n].vertex,u,new p));var f=[];for(n=0,r=c.length;r>n;n++)f.push(p.normalize(c[n],new p));var d={},g={};for(n=0;n<o.length;n++){var v=o[n][0],m=o[n][1],_=o[n][2];g[v]=g[v]||{},g[m]=g[m]||{},g[_]=g[_]||{},d[v]=d[v]||[],d[m]=d[m]||[],d[_]=d[_]||[],g[v][m]||(g[v][m]=1,d[v].push(m)),g[v][_]||(g[v][_]=1,d[v].push(_)),g[m][v]||(g[m][v]=1,d[m].push(v)),g[m][_]||(g[m][_]=1,d[m].push(_)),g[_][v]||(g[_][v]=1,d[_].push(v)),g[_][m]||(g[_][m]=1,d[_].push(m))}this.indices=o,this.vertices=c,this.normals=f,this.polyhedralProperties=a,this.graph=d}function h(t,e){var n=new s;n.addVertex(i(t,new p(1,0,0))),n.addVertex(i(t,new p(-1,0,0)));var o,a,u,h,c,l,f=n.vertices[0].vertex,d=n.vertices[1].vertex,g=p.subtract(d,f,w),v=-(1/0);for(c=0;c<t.length;c++)if(a=t[c],a!==f&&a!==d){var m=p.subtract(a,f,_);o=p.dot(m,r(g,m,g)),o=0>o?-1*o:o,o>v&&(v=o,u=a,h=c)}n.addVertex({vertex:u,index:h});var y=u,b=p.subtract(y,f,x),A=p.cross(g,b,new p);for(A.normalize(),v=-(1/0),c=0;c<t.length;c++)a=t[c],a!==f&&a!==d&&a!==y&&(o=p.dot(p.subtract(a,f,_),A),o=0>o?-1*o:o,o>v&&(v=o,u=a,h=c));n.addVertex({vertex:u,index:h});var C=u,R=p.subtract(C,f,T),S=p.subtract(y,d,E),O=p.subtract(C,d,I),M=p.cross(b,R,new p),z=p.cross(g,R,new p),L=p.cross(S,O,new p);M.normalize(),z.normalize(),L.normalize(),p.dot(A,R)>0&&A.invert(),p.dot(M,g)>0&&M.invert(),p.dot(z,b)>0&&z.invert(),p.dot(L,g)<0&&L.invert();var N=0,D=1,U=2,P=3;n.addFeature(null,A,[N,D,U]),n.addFeature(null,M,[N,U,P]),n.addFeature(null,z,[N,D,P]),n.addFeature(null,L,[D,U,P]);var F={};for(c=0,l=n.vertices.length;l>c;c++)F[n.vertices[c].index]=!0;var k=f.x+d.x+y.x+C.x,G=f.y+d.y+y.y+C.y,B=f.z+d.z+y.z+C.z,V=new p(k,G,B);V.scale(.25);for(var H=n.features,q=0;q++<e;){var j=null;for(c=0,l=H.length;l>c;c++)if(H[c]&&!H[c].done){j=H[c],u=null,h=null,f=n.vertices[j.vertexIndices[0]].vertex;var W=i(t,j.normal);u=W.vertex,h=W.index;var Y=p.dot(p.subtract(u,f,_),j.normal);.001>Y||F[h]?j.done=!0:(F[h]=!0,n.addVertex(W),n.reshape(V))}if(null===j)break}return n}function c(t,e,n,r,i){var o=t+e;r[0]=o+n;var s=t*t,a=s+e*o;r[1]=a+n*r[0],r[2]=t*s+e*a+n*r[1],i[0]=r[1]+t*(r[0]+t),i[1]=r[1]+e*(r[0]+e),i[2]=r[1]+n*(r[0]+n)}function l(t,e){var n,r,i=[0,0,0,0,0,0,0,0,0,0],o=[],s=[],a=[],u=[],h=[],l=[];for(n=0,r=e.length;r>n;n++){var d=t[e[n][0]].vertex,g=t[e[n][1]].vertex,v=t[e[n][2]].vertex,m=p.subtract(g,d,w),_=p.subtract(v,d,x),y=m.cross(_);p.dot(d,y)<0&&y.invert();var b=y.x,T=y.y,E=y.z,I=d.x,A=d.y,C=d.z,R=g.x,S=g.y,O=g.z,M=v.x,z=v.y,L=v.z;c(I,R,M,o,u),c(A,S,z,s,h),c(C,O,L,a,l),i[0]+=b*o[0],i[1]+=b*o[1],i[2]+=T*s[1],i[3]+=E*a[1],i[4]+=b*o[2],i[5]+=T*s[2],i[6]+=E*a[2],i[7]+=b*(A*u[0]+S*u[1]+z*u[2]),i[8]+=T*(C*h[0]+O*h[1]+L*h[2]),i[9]+=E*(I*l[0]+R*l[1]+M*l[2])}i[0]/=6,i[1]/=24,i[2]/=24,i[3]/=24,i[4]/=60,i[5]/=60,i[6]/=60,i[7]/=120,i[8]/=120,i[9]/=120;var N=1/0,D=-(1/0),U=1/0,P=-(1/0),F=1/0,k=-(1/0);for(n=0,r=t.length;r>n;n++){var G=t[n].vertex;G.x<N&&(N=G.x),G.x>D&&(D=G.x),G.y<U&&(U=G.y),G.y>P&&(P=G.y),G.z<F&&(F=G.z),G.z>k&&(k=G.z)}var B=[D-N,P-U,k-F],V=i[0],H=new p(i[1],i[2],i[3]);H.scale(1/V);var q=new f([i[4],i[7],i[9],i[7],i[5],i[8],i[9],i[8],i[6]]);return{size:B,volume:V,centroid:H,eulerTensor:q}}var p=t("../math/Vec3"),f=t("../math/Mat33"),d=t("../utilities/ObjectManager");d.register("DynamicGeometry",s),d.register("DynamicGeometryFeature",o);var g=d.requestDynamicGeometryFeature,v=d.freeDynamicGeometryFeature,m=new p,_=new p,y=new p,b=new p,w=new p,x=new p,T=new p,E=new p,I=new p;o.prototype.reset=function(t,e,n){return this.distance=t,this.normal=e,this.vertexIndices=n,this},s.prototype.reset=function(){return this.vertices=[],this.numVertices=0,this.features=[],this.numFeatures=0,this.lastVertexIndex=0,this._IDPool={vertices:[],features:[]},this},s.prototype.addVertex=function(t){var e=this._IDPool.vertices.length?this._IDPool.vertices.pop():this.vertices.length;this.vertices[e]=t,this.lastVertexIndex=e,this.numVertices++},s.prototype.removeVertex=function(t){var e=this.vertices[t];return this.vertices[t]=null,this._IDPool.vertices.push(t),this.numVertices--,e},s.prototype.addFeature=function(t,e,n){var r=this._IDPool.features.length?this._IDPool.features.pop():this.features.length;this.features[r]=g().reset(t,e,n),this.numFeatures++},s.prototype.removeFeature=function(t){var e=this.features[t];this.features[t]=null,this._IDPool.features.push(t),this.numFeatures--,v(e)},s.prototype.getLastVertex=function(){return this.vertices[this.lastVertexIndex]},s.prototype.getFeatureClosestToOrigin=function(){for(var t=1/0,e=null,n=this.features,r=0,i=n.length;i>r;r++){var o=n[r];o&&o.distance<t&&(t=o.distance,e=o)}return e},s.prototype.reshape=function(t){var e,n,r,i,o,s=this.vertices,u=this.getLastVertex().vertex,h=this.features,c=[];for(r=0,o=h.length;o>r;r++)h[r]&&(n=h[r].vertexIndices,e=s[n[0]].vertex,p.dot(h[r].normal,p.subtract(u,e,y))>-.001&&(a(s,c,n[0],n[1]),a(s,c,n[1],n[2]),a(s,c,n[2],n[0]),this.removeFeature(r)));var l=u,f=this.lastVertexIndex;for(i=0,o=c.length;o>i;i++)if(c[i]){var d=c[i][0],g=c[i][1],v=s[d].vertex,m=s[g].vertex,b=p.subtract(v,l,w),T=p.subtract(m,l,x),E=p.cross(b,T,new p);if(E.normalize(),t){var I=p.subtract(t,l,_);p.dot(E,I)>-.001&&E.invert(),this.addFeature(null,E,[f,d,g])}else{var A=p.dot(E,l);0>A&&(E.invert(),A*=-1),this.addFeature(A,E,[f,d,g])}}},s.prototype.simplexContainsOrigin=function(t,e){var n=this.vertices.length,i=this.lastVertexIndex,o=i-1,s=i-2,a=i-3;o=0>o?o+n:o,s=0>s?s+n:s,a=0>a?a+n:a;var u,h,c,l,f,d,g,v,m,_,y,A,C,R=this.vertices[i].vertex,S=this.vertices[o].vertex,O=this.vertices[s].vertex,M=this.vertices[a].vertex,z=p.scale(R,-1,b),L=p.subtract(S,R,w);if(4===n){if(u=p.subtract(O,R,x),h=p.subtract(M,R,T),f=p.cross(L,u,new p),d=p.cross(u,h,new p),g=p.cross(L,h,new p),f.normalize(),d.normalize(),g.normalize(),p.dot(f,h)>0&&f.invert(),p.dot(d,L)>0&&d.invert(),p.dot(g,u)>0&&g.invert(),m=p.dot(f,z),_=p.dot(d,z),y=p.dot(g,z),.001>m&&.001>y&&.001>_)return c=p.subtract(O,S,E),l=p.subtract(M,S,I),v=p.cross(c,l,new p),v.normalize(),p.dot(v,L)<=0&&v.invert(),A=-1*p.dot(v,S),this.addFeature(-m,f,[i,o,s]),this.addFeature(-_,d,[i,s,a]),this.addFeature(-y,g,[i,a,o]),this.addFeature(-A,v,[o,s,a]),!0;m>=.001?(C=this.removeVertex(a),t.copy(f)):_>=.001?(C=this.removeVertex(o),t.copy(d)):(C=this.removeVertex(s),t.copy(g))}else 3===n?(u=p.subtract(O,R,x),p.cross(L,u,t),p.dot(t,z)<=0&&t.invert()):t.copy(r(L,z,L));return C&&e&&e(C),!1},e.exports={DynamicGeometry:s,ConvexHull:u}},{"../math/Mat33":47,"../math/Vec3":50,"../utilities/ObjectManager":97}],53:[function(t,e,n){"use strict";function r(t){this.events=new l,t=t||{},this.bodies=[],this.forces=[],this.constraints=[],this.step=t.step||1e3/60,this.iterations=t.iterations||10,this._indexPools={bodies:[],forces:[],constraints:[]},this._entityMaps={bodies:{},forces:{},constraints:{}},this.speed=t.speed||1,this.time=0,this.delta=0,this.origin=t.origin||new p,this.orientation=t.orientation?t.orientation.normalize():new f,this.frameDependent=t.frameDependent||!1,this.transformBuffers={position:[0,0,0],rotation:[0,0,0,1]}}function i(t,e,n){var r=t._entityMaps[n];if(null==r[e._ID]){var i=t[n],o=t._indexPools[n];o.length?r[e._ID]=o.pop():r[e._ID]=i.length,i[r[e._ID]]=e}}function o(t,e,n){var r=t._entityMaps[n],i=r[e._ID];null!=i&&(t._indexPools[n].push(i),t[n][i]=null,r[e._ID]=null)}function s(t,e){t.momentum.add(p.scale(t.force,e,v)),t.angularMomentum.add(p.scale(t.torque,e,v)),p.scale(t.momentum,t.inverseMass,t.velocity),t.inverseInertia.vectorMultiply(t.angularMomentum,t.angularVelocity),t.force.clear(),t.torque.clear()}function a(t,e){if(0!==t.restrictions){var n=t.restrictions,r=null,i=null,o=null,s=null,a=null,u=null;32&n&&(r=0),16&n&&(i=0),8&n&&(o=0),4&n&&(s=0),2&n&&(a=0),1&n&&(u=0),(null!==r||null!==i||null!==o)&&t.setVelocity(r,i,o),(null!==s||null!==a||null!==u)&&t.setAngularVelocity(s,a,u)}t.position.add(p.scale(t.velocity,e,v));var h=t.angularVelocity,c=t.orientation,l=h.x,f=h.y,d=h.z,g=c.w,m=c.x,_=c.y,y=c.z,b=.5*e;c.w+=(-l*m-f*_-d*y)*b,c.x+=(l*g+f*y-d*_)*b,c.y+=(f*g+d*m-l*y)*b,c.z+=(d*g+l*_-f*m)*b,c.normalize(),t.updateInertia()}var u=t("./bodies/Particle"),h=t("./constraints/Constraint"),c=t("./forces/Force"),l=t("../utilities/CallbackStore"),p=t("../math/Vec3"),f=t("../math/Quaternion"),d=new p,g=new f,v=new p;r.prototype.on=function(t,e){return this.events.on(t,e),this},r.prototype.off=function(t,e){return this.events.off(t,e),this},r.prototype.trigger=function(t,e){return this.events.trigger(t,e),this},r.prototype.setOrigin=function(t,e,n){return this.origin.set(t,e,n),this},r.prototype.setOrientation=function(t,e,n,r){return this.orientation.set(t,e,n,r).normalize(),this},r.prototype.add=function(){for(var t=0,e=arguments.length;e>t;t++){var n=arguments[t];if(n instanceof Array)for(var r=0,i=n.length;i>r;r++){var o=n[r];this.add(o)}else n instanceof u?this.addBody(n):n instanceof h?this.addConstraint(n):n instanceof c&&this.addForce(n)}return this},r.prototype.remove=function(){for(var t=0,e=arguments.length;e>t;t++){var n=arguments[t];if(n instanceof Array)for(var r=0,i=n.length;i>r;r++){var o=n[r];this.add(o)}else n instanceof u?this.removeBody(n):n instanceof h?this.removeConstraint(n):n instanceof c&&this.removeForce(n)}return this},r.prototype.addBody=function(t){i(this,t,"bodies")},r.prototype.addForce=function(t){i(this,t,"forces")},r.prototype.addConstraint=function(t){i(this,t,"constraints")},r.prototype.removeBody=function(t){o(this,t,"bodies")},r.prototype.removeForce=function(t){o(this,t,"forces")},r.prototype.removeConstraint=function(t){o(this,t,"constraints")},r.prototype.update=function(t){0===this.time&&(this.time=t);var e=this.bodies,n=this.forces,r=this.constraints,i=this.frameDependent,o=this.step,u=.001*o,h=this.speed,c=this.delta;c+=(t-this.time)*h,this.time=t;for(var l,p,f,d,g;c>o;){for(this.events.trigger("prestep",t),l=0,p=n.length;p>l;l++)f=n[l],null!==f&&f.update(t,u);for(l=0,p=e.length;p>l;l++)d=e[l],null!==d&&s(d,u);for(l=0,p=r.length;p>l;l++)g=r[l],null!==g&&g.update(t,u);for(var v=0,m=this.iterations;m>v;v++)for(l=0,p=r.length;p>l;l++)g=r[l],null!==g&&g.resolve(t,u);for(l=0,p=e.length;p>l;l++)d=e[l],null!==d&&a(d,u);this.events.trigger("poststep",t),i?c=0:c-=o}this.delta=c},r.prototype.getTransform=function(t){var e=this.origin,n=this.orientation,r=this.transformBuffers,i=t.position,o=t.orientation,s=o,a=i;return 1!==n.w&&(s=f.multiply(o,n,g),a=n.rotateVector(i,d)),r.position[0]=e.x+a.x,r.position[1]=e.y+a.y,r.position[2]=e.z+a.z,r.rotation[0]=s.x,r.rotation[1]=s.y,r.rotation[2]=s.z,r.rotation[3]=s.w,r},e.exports=r},{"../math/Quaternion":48,"../math/Vec3":50,"../utilities/CallbackStore":94,"./bodies/Particle":55,"./constraints/Constraint":62,"./forces/Force":73}],54:[function(t,e,n){"use strict";function r(t){s.call(this,t),this.normals=[new i(0,1,0),new i(1,0,0),new i(0,0,1)],this.type=2}var i=t("../../math/Vec3"),o=t("./convexBodyFactory"),s=o([new i(-100,-100,-100),new i(100,-100,-100),new i(-100,-100,100),new i(100,-100,100),new i(-100,100,-100),new i(100,100,-100),new i(-100,100,100),new i(100,100,100)]);r.prototype=Object.create(s.prototype),r.prototype.constructor=r,e.exports=r},{"../../math/Vec3":50,"./convexBodyFactory":58}],55:[function(t,e,n){"use strict";function r(t){this.events=new a,t=t||{},this.position=t.position||new i,this.orientation=t.orientation||new o,this.velocity=new i,this.momentum=new i,this.angularVelocity=new i,this.angularMomentum=new i,this.mass=t.mass||1,this.inverseMass=1/this.mass,this.force=new i,this.torque=new i,this.restitution=null!=t.restitution?t.restitution:.4,this.friction=null!=t.friction?t.friction:.2,this.inverseInertia=new s([0,0,0,0,0,0,0,0,0]),this.localInertia=new s([0,0,0,0,0,0,0,0,0]),this.localInverseInertia=new s([0,0,0,0,0,0,0,0,0]),this.size=t.size||[0,0,0];var e=t.velocity;e&&this.setVelocity(e.x,e.y,e.z),this.restrictions=0,this.setRestrictions.apply(this,t.restrictions||[]),this.collisionMask=t.collisionMask||1,this.collisionGroup=t.collisionGroup||1,this.type=1,this._ID=c++}var i=t("../../math/Vec3"),o=t("../../math/Quaternion"),s=t("../../math/Mat33"),a=t("../../utilities/CallbackStore"),u=new i,h=new s,c=0;r.prototype.on=function(t,e){return this.events.on(t,e),this},r.prototype.off=function(t,e){return this.events.off(t,e),this},r.prototype.trigger=function(t,e){return this.events.trigger(t,e),this},r.prototype.getRestrictions=function(){var t="",e="",n=this.restrictions;return 32&n&&(t+="x"),16&n&&(t+="y"),8&n&&(t+="z"),4&n&&(e+="x"),2&n&&(e+="y"),1&n&&(e+="z"),[t,e]},r.prototype.setRestrictions=function(t,e){return t=t||"",e=e||"",this.restrictions=0,t.indexOf("x")>-1&&(this.restrictions|=32),t.indexOf("y")>-1&&(this.restrictions|=16),t.indexOf("z")>-1&&(this.restrictions|=8),e.indexOf("x")>-1&&(this.restrictions|=4),e.indexOf("y")>-1&&(this.restrictions|=2),e.indexOf("z")>-1&&(this.restrictions|=1),this},r.prototype.getMass=function(){return this.mass},r.prototype.setMass=function(t){return this.mass=t,this.inverseMass=1/t,this},r.prototype.getInverseMass=function(){return this.inverseMass},r.prototype.updateLocalInertia=function(){return this.localInertia.set([0,0,0,0,0,0,0,0,0]),this.localInverseInertia.set([0,0,0,0,0,0,0,0,0]),this},r.prototype.updateInertia=function(){var t=this.localInverseInertia,e=this.orientation;if(t[0]===t[4]&&t[4]===t[8]||1===e.w)return this;var n=e.toMatrix(h);return s.multiply(n,this.inverseInertia,this.inverseInertia),s.multiply(this.localInverseInertia,n.transpose(),this.inverseInertia),this},r.prototype.getPosition=function(){return this.position},r.prototype.setPosition=function(t,e,n){return this.position.set(t,e,n),this},r.prototype.getVelocity=function(){return this.velocity},r.prototype.setVelocity=function(t,e,n){return this.velocity.set(t,e,n),i.scale(this.velocity,this.mass,this.momentum),this},r.prototype.getMomentum=function(){return this.momentum},r.prototype.setMomentum=function(t,e,n){return this.momentum.set(t,e,n),i.scale(this.momentum,this.inverseMass,this.velocity),this},r.prototype.getOrientation=function(){return this.orientation},r.prototype.setOrientation=function(t,e,n,r){return this.orientation.set(t,e,n,r).normalize(),this.updateInertia(),this},r.prototype.getAngularVelocity=function(){return this.angularVelocity},r.prototype.setAngularVelocity=function(t,e,n){this.angularVelocity.set(t,e,n);var r=s.inverse(this.inverseInertia,h);return r?r.vectorMultiply(this.angularVelocity,this.angularMomentum):this.angularMomentum.clear(),this},r.prototype.getAngularMomentum=function(){return this.angularMomentum},r.prototype.setAngularMomentum=function(t,e,n){return this.angularMomentum.set(t,e,n),this.inverseInertia.vectorMultiply(this.angularMomentum,this.angularVelocity),this},r.prototype.getForce=function(){return this.force},r.prototype.setForce=function(t,e,n){return this.force.set(t,e,n),this},r.prototype.getTorque=function(){return this.torque},r.prototype.setTorque=function(t,e,n){return this.torque.set(t,e,n),this},r.prototype.applyForce=function(t){return this.force.add(t),this},r.prototype.applyTorque=function(t){return this.torque.add(t),this},r.prototype.applyImpulse=function(t){return this.momentum.add(t),i.scale(this.momentum,this.inverseMass,this.velocity),this},r.prototype.applyAngularImpulse=function(t){return this.angularMomentum.add(t),this.inverseInertia.vectorMultiply(this.angularMomentum,this.angularVelocity),this},r.prototype.support=function(){return u},r.prototype.updateShape=function(){},e.exports=r},{"../../math/Mat33":47,"../../math/Quaternion":48,"../../math/Vec3":50,"../../utilities/CallbackStore":94}],56:[function(t,e,n){"use strict";function r(t){i.call(this,t);var e=t.radius||1;this.radius=e,this.size=[2*e,2*e,2*e],this.updateLocalInertia(),this.inverseInertia.copy(this.localInverseInertia);var n=t.angularVelocity;n&&this.setAngularVelocity(n.x,n.y,n.z),this.type=4}var i=t("./Particle"),o=t("../../math/Vec3"),s=new o;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.getRadius=function(){return this.radius},r.prototype.setRadius=function(t){return this.radius=t,this.size=[2*this.radius,2*this.radius,2*this.radius],this},r.prototype.updateLocalInertia=function(){var t=this.mass,e=this.radius,n=t*e*e;this.localInertia.set([.4*n,0,0,0,.4*n,0,0,0,.4*n]),this.localInverseInertia.set([2.5/n,0,0,0,2.5/n,0,0,0,2.5/n])},r.prototype.support=function(t){return o.scale(t,this.radius,s)},e.exports=r},{"../../math/Vec3":50,"./Particle":55}],57:[function(t,e,n){"use strict";function r(t){i.call(this,t);var e=this.normal=new o,n=this.direction=t.direction;switch(n){case r.DOWN:e.set(0,1,0);break;case r.UP:e.set(0,-1,0);break;case r.LEFT:e.set(-1,0,0);break;case r.RIGHT:e.set(1,0,0);break;case r.FORWARD:e.set(0,0,-1);break;case r.BACKWARD:e.set(0,0,1)}this.invNormal=o.clone(e,new o).invert(),this.mass=1/0,this.inverseMass=0,this.type=8}var i=t("./Particle"),o=t("../../math/Vec3");r.DOWN=0,r.UP=1,r.LEFT=2,r.RIGHT=3,r.FORWARD=4,r.BACKWARD=5,r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r},{"../../math/Vec3":50,"./Particle":55}],58:[function(t,e,n){"use strict";function r(t){function e(e){o.call(this,e);var n=t.polyhedralProperties.size,r=e.size||n,u=r[0]/n[0],h=r[1]/n[1],c=r[2]/n[2];this._scale=[u,h,c];var l=new s([u,0,0,0,h,0,0,0,c]);this.hull=t,this.vertices=[];for(var p=0,f=t.vertices.length;f>p;p++)this.vertices.push(l.vectorMultiply(t.vertices[p],new a));i.call(this,l),this.inverseInertia.copy(this.localInverseInertia),this.updateInertia();var d=e.angularVelocity;d&&this.setAngularVelocity(d.x,d.y,d.z)}if(!(t instanceof h)){if(!(t instanceof Array))throw new Error("convexBodyFactory requires a ConvexHull object or an array of Vec3's as input.");t=new h(t)}return e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype.setSize=function(e,n,r){var i=t.polyhedralProperties.size;this.size[0]=e,this.size[1]=n,this.size[2]=r;var o=e/i[0],a=n/i[1],u=r/i[2];this._scale=[o,a,u];for(var h=new s([o,0,0,0,a,0,0,0,u]),c=this.vertices,l=0,p=t.vertices.length;p>l;l++)h.vectorMultiply(t.vertices[l],c[l]);return this},e.prototype.updateLocalInertia=function(){var t=this._scale[0],e=this._scale[1],n=this._scale[2],r=new s([t,0,0,0,e,0,0,0,n]);return i.call(this,r),this},e.prototype.support=function(t){for(var e,n,r,i=this.vertices,o=-(1/0),s=0,u=i.length;u>s;s++)e=i[s],n=a.dot(e,t),n>o&&(r=e,o=n);return r},e.prototype.updateShape=function(){for(var t=this.vertices,e=this.orientation,n=this.hull.vertices,r=this._scale[0],i=this._scale[1],o=this._scale[2],s=c,u=0,h=t.length;h>u;u++)s.copy(n[u]),s.x*=r,s.y*=i,s.z*=o,a.applyRotation(s,e,t[u]);return this},e}function i(t){var e=this.hull.polyhedralProperties,n=t.get(),r=n[0]*n[4]*n[8],i=e.eulerTensor,o=new s;s.multiply(t,i,o),s.multiply(o,t,o);var a=o.get(),u=a[0],h=a[4],c=a[8],l=a[1],p=a[7],f=a[2],d=e.volume*r,g=this.mass,v=g/d,m=h+c,_=u+c,y=u+h,b=-l,w=-p,x=-f,T=e.centroid;m-=d*(T.y*T.y+T.z*T.z),_-=d*(T.z*T.z+T.x*T.x),y-=d*(T.x*T.x+T.y*T.y),b+=d*T.x*T.y,w+=d*T.y*T.z,x+=d*T.z*T.x,m*=v*r,_*=v*r,y*=v*r,b*=v*r,w*=v*r,x*=v*r;var E=[m,b,x,b,_,w,x,w,y];this.localInertia.set(E),s.inverse(this.localInertia,this.localInverseInertia)}var o=t("./Particle"),s=t("../../math/Mat33"),a=t("../../math/Vec3"),u=t("../Geometry"),h=u.ConvexHull,c=new a;e.exports=r},{"../../math/Mat33":47,"../../math/Vec3":50,"../Geometry":52,"./Particle":55}],59:[function(t,e,n){"use strict";function r(t,e,n){this.a=t,this.b=e,i.call(this,n),this.effectiveInertia=new s,this.angularImpulse=new o,this.error=0}var i=t("./Constraint"),o=t("../../math/Vec3"),s=t("../../math/Mat33"),a=new o;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.init=function(){this.cosAngle=this.cosAngle||this.a.orientation.dot(this.b.orientation)},r.prototype.update=function(){var t=this.a,e=this.b,n=t.orientation,r=e.orientation,i=n.dot(r),o=2*(i-this.cosAngle);this.error=o;var a=this.angularImpulse;e.applyAngularImpulse(a),t.applyAngularImpulse(a.invert()),s.add(t.inverseInertia,e.inverseInertia,this.effectiveInertia),this.effectiveInertia.inverse(),a.clear()},r.prototype.resolve=function(){var t=this.a,e=this.b,n=a,r=t.angularVelocity,i=e.angularVelocity;o.subtract(r,i,n),n.scale(1+this.error);var s=n.applyMatrix(this.effectiveInertia);e.applyAngularImpulse(s),t.applyAngularImpulse(s.invert()),s.invert(),this.angularImpulse.add(s)},e.exports=r},{"../../math/Mat33":47,"../../math/Vec3":50,"./Constraint":62}],60:[function(t,e,n){"use strict";function r(t,e,n){this.a=t,this.b=e,i.call(this,n),this.impulse=new o,this.angImpulseA=new o,this.angImpulseB=new o,this.error=new o,this.effMassMatrix=new s}var i=t("./Constraint"),o=t("../../math/Vec3"),s=t("../../math/Mat33"),a=t("../../math/Quaternion"),u=new o,h=new o,c=new o,l=new o,p=new o;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.init=function(){var t=this.anchor,e=this.a,n=this.b,r=a.conjugate(e.orientation,new a),i=a.conjugate(n.orientation,new a);this.rA=o.subtract(t,e.position,new o),this.rB=o.subtract(t,n.position,new o),this.bodyRA=r.rotateVector(this.rA,new o),this.bodyRB=i.rotateVector(this.rB,new o)},r.prototype.update=function(t,e){var n=this.a,r=this.b,i=n.orientation.rotateVector(this.bodyRA,this.rA),a=r.orientation.rotateVector(this.bodyRB,this.rB),u=new s([0,i.z,-i.y,-i.z,0,i.x,i.y,-i.x,0]),c=new s([0,a.z,-a.y,-a.z,0,a.x,a.y,-a.x,0]),l=s.multiply(u,n.inverseInertia,new s).multiply(u.transpose()),p=s.multiply(c,r.inverseInertia,new s).multiply(c.transpose()),f=s.add(l,p,l),d=o.add(n.position,this.rA,this.anchor),g=o.add(r.position,this.rB,h);o.subtract(g,d,this.error),this.error.scale(.2/e);var v=n.inverseMass,m=r.inverseMass,_=new s([v+m,0,0,0,v+m,0,0,0,v+m]);s.add(f,_,this.effMassMatrix),this.effMassMatrix.inverse();var y=this.impulse,b=this.angImpulseA,w=this.angImpulseB;r.applyImpulse(y),r.applyAngularImpulse(w),y.invert(),n.applyImpulse(y),n.applyAngularImpulse(b),y.clear(),b.clear(),w.clear()},r.prototype.resolve=function(){var t=this.a,e=this.b,n=this.rA,r=this.rB,i=o.add(t.velocity,o.cross(t.angularVelocity,n,p),c),s=o.add(e.velocity,o.cross(e.angularVelocity,r,p),l),a=i.subtract(s).subtract(this.error).applyMatrix(this.effMassMatrix),f=o.cross(r,a,u),d=o.cross(n,a,h).invert();e.applyImpulse(a),e.applyAngularImpulse(f),a.invert(),t.applyImpulse(a),t.applyAngularImpulse(d),a.invert(),this.impulse.add(a),this.angImpulseA.add(d),this.angImpulseB.add(f)},e.exports=r},{"../../math/Mat33":47,"../../math/Quaternion":48,"../../math/Vec3":50,"./Constraint":62}],61:[function(t,e,n){"use strict";function r(t,e,n){return e>t?e:t>n?n:t}function i(t,e,n,r,i,o){this.penetration=t,this.normal=e,this.worldContactA=n,this.worldContactB=r,this.localContactA=i,this.localContactB=o}function o(t,e){this.targets=[],t&&(this.targets=this.targets.concat(t)),l.call(this,e)}function s(t,e,n){var r=e.position,i=n.position,o=c.subtract(i,r,new c),s=o.length(),a=e.radius+n.radius,u=o.scale(1/s),h=a-s;if(!(0>h)){var l=c.scale(u,e.radius,new c),p=c.scale(u,-n.radius,new c),f=c.add(r,l,new c),d=c.add(i,p,new c),g=y().reset(h,u,f,d,l,p);t.contactManifoldTable.registerContact(e,n,g)}}function a(t,e,n){if(e.type===T){var i=n;n=e,e=i}var o=e.position,s=n.position,a=c.subtract(s,o,b),u=e.orientation,h=n.radius,l=e.size,p=.5*l[0],f=.5*l[1],d=.5*l[2],g=e.normals,v=u.rotateVector(g[1],new c),m=u.rotateVector(g[0],new c),_=u.rotateVector(g[2],new c),w=new c;w.x=r(c.dot(a,v),-p,p),w.y=r(c.dot(a,m),-f,f),w.z=r(c.dot(a,_),-d,d),w.applyRotation(u);var x=c.add(o,w,new c),E=c.subtract(x,s,x),I=E.length(),A=h-I;if(!(0>A)){var C=c.scale(E,-1/I,new c),R=w,S=E,O=c.add(o,R,new c),M=c.add(s,S,new c),z=y().reset(A,C,O,M,R,S);t.contactManifoldTable.registerContact(e,n,z)}}function u(t,e,n){var r=g(e,n);if(r){var i=v(e,n,r);null!==i&&t.contactManifoldTable.registerContact(e,n,i)}}function h(t,e,n){if(e.type===E){var r=n;n=e,e=r}var i=e.position,o=n.position,s=n.normal,a=n.invNormal,u=e.support(a),h=c.add(i,u,new c),l=c.subtract(h,o,b),p=c.dot(l,a);if(!(0>p)){var f=c.scale(s,p,new c).add(h),d=c.subtract(f,n.position,new c),g=y().reset(p,a,h,f,u,d);t.contactManifoldTable.registerContact(e,n,g)}}var c=t("../../math/Vec3"),l=t("./Constraint"),p=t("./collision/SweepAndPrune"),f=t("./collision/BruteForce"),d=t("./collision/ConvexCollisionDetection"),g=d.gjk,v=d.epa,m=t("./collision/ContactManifold"),_=t("../../utilities/ObjectManager");_.register("CollisionData",i);var y=_.requestCollisionData,b=new c;i.prototype.reset=function(t,e,n,r,i,o){return this.penetration=t,this.normal=e,this.worldContactA=n,this.worldContactB=r,this.localContactA=i,this.localContactB=o,this},o.prototype=Object.create(l.prototype),o.prototype.constructor=o,o.prototype.init=function(){if(this.broadPhase){var t=this.broadphase;t instanceof Function&&(this.broadPhase=new t(this.targets))}else this.broadPhase=new p(this.targets);this.contactManifoldTable=this.contactManifoldTable||new m},o.prototype.update=function(t,e){if(this.contactManifoldTable.update(e),0!==this.targets.length){var n,r;for(n=0,r=this.targets.length;r>n;n++)this.targets[n].updateShape();var i,o=this.broadPhase.update();for(n=0,r=o.length;r>n;n++)i=o[n],i&&this.applyNarrowPhase(i);this.contactManifoldTable.prepContacts(e)}},o.prototype.resolve=function(t,e){this.contactManifoldTable.resolveManifolds(e)},o.prototype.addTarget=function(t){
this.targets.push(t),this.broadPhase.add(t)},o.prototype.removeTarget=function(t){var e=this.targets.indexOf(t);0>e||(this.targets.splice(e,1),this.broadPhase.remove(t))};var w=1,x=2,T=4,E=8,I=w|w,A=x|x,C=x|w,R=T|T,S=x|T,O=w|T,M=w|E,z=x|E,L=T|E,N={};N[I]=u,N[A]=u,N[C]=u,N[O]=u,N[R]=s,N[S]=a,N[M]=h,N[z]=h,N[L]=h,o.prototype.applyNarrowPhase=function(t){for(var e=0,n=t.length;n>e;e++)for(var r=e+1;n>r;r++){var i=t[e],o=t[r];if(0!==(i.collisionMask&o.collisionGroup&&i.collisionGroup&o.collisionMask)){var s=i.type|o.type;N[s]&&N[s](this,i,o)}}},o.SweepAndPrune=p,o.BruteForce=f.BruteForce,o.BruteForceAABB=f.BruteForceAABB,e.exports=o},{"../../math/Vec3":50,"../../utilities/ObjectManager":97,"./Constraint":62,"./collision/BruteForce":68,"./collision/ContactManifold":69,"./collision/ConvexCollisionDetection":70,"./collision/SweepAndPrune":71}],62:[function(t,e,n){"use strict";function r(t){t=t||{},this.setOptions(t),this._ID=i++}var i=0;r.prototype.setOptions=function(t){for(var e in t)this[e]=t[e];this.init(t)},r.prototype.init=function(t){},r.prototype.update=function(t,e){},r.prototype.resolve=function(t,e){},e.exports=r},{}],63:[function(t,e,n){"use strict";function r(t,e){t?t instanceof Array?this.targets=t:this.targets=[t]:this.targets=[],i.call(this,e),this.impulses={},this.normals={},this.velocityBiases={},this.divisors={}}var i=t("./Constraint"),o=t("../../math/Vec3"),s=new o,a=new o,u=1e-7,h=Math.PI;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.init=function(){this.equation1=this.equation1||function(){return 0},this.equation2=this.equation2||function(t,e,n){return n},this.period=this.period||1,this.dampingRatio=this.dampingRatio||.5,this.stiffness=4*h*h/(this.period*this.period),this.damping=4*h*this.dampingRatio/this.period},r.prototype.update=function(t,e){for(var n=this.targets,r=this.normals,i=this.velocityBiases,h=this.divisors,c=this.impulses,l=s,p=a,f=this.equation1,d=this.equation2,g=this.damping,v=this.stiffness,m=0,_=n.length;_>m;m++){var y=n[m],b=y._ID;if(!y.immune){var w,x,T=y.position,E=y.mass;if(0===this.period)w=0,x=1;else{var I=g*E,A=v*E;w=1/(e*(I+e*A)),x=e*A/(I+e*A)}var C=T.x,R=T.y,S=T.z,O=f(C,R,S),M=(f(C+u,R,S)-O)/u,z=(f(C,R+u,S)-O)/u,L=(f(C,R,S+u)-O)/u,N=d(C,R,S),D=(d(C+u,R,S)-N)/u,U=(d(C,R+u,S)-N)/u,P=(d(C,R,S+u)-N)/u;p.set(M+D,z+U,L+P),p.normalize();var F=x*(O+N)/e,k=w+1/E,G=c[b]||0;o.scale(p,G,l),y.applyImpulse(l),r[b]=r[b]||new o,r[b].copy(p),i[b]=F,h[b]=k,c[b]=0}}},r.prototype.resolve=function(){for(var t=this.targets,e=this.normals,n=this.velocityBiases,r=this.divisors,i=this.impulses,a=s,u=0,h=t.length;h>u;u++){var c=t[u],l=c._ID;if(!c.immune){var p=c.velocity,f=e[l],d=-(o.dot(f,p)+n[l])/r[l];o.scale(f,d,a),c.applyImpulse(a),i[l]+=d}}},e.exports=r},{"../../math/Vec3":50,"./Constraint":62}],64:[function(t,e,n){"use strict";function r(t,e,n){this.a=t,this.b=e,i.call(this,n),this.impulse=0,this.distance=0,this.normal=new o,this.velocityBias=0,this.divisor=0}var i=t("./Constraint"),o=t("../../math/Vec3"),s=new o,a=new o,u=new o,h=new o,c=new o,l=Math.PI;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.init=function(){this.direction=this.direction||o.subtract(this.b.position,this.a.position,new o),this.direction.normalize(),this.minLength=this.minLength||0,this.period=this.period||.2,this.dampingRatio=this.dampingRatio||.5,this.stiffness=4*l*l/(this.period*this.period),this.damping=4*l*this.dampingRatio/this.period},r.prototype.update=function(t,e){var n=this.a,r=this.b,i=s,u=h,l=a,p=c,f=n.position,d=n.inverseMass,g=r.position,v=r.inverseMass,m=this.direction;o.subtract(g,f,u),o.scale(m,o.dot(m,u),p);var _=p.add(f);o.subtract(g,_,i);var y=i.length();i.normalize();var b,w,x=d+v,T=1/x;if(0===this.period)b=0,w=1;else{var E=this.damping*T,I=this.stiffness*T;b=1/(e*(E+e*I)),w=e*I/(E+e*I)}var A=w*y/e,C=b+x,R=this.impulse;o.scale(i,R,l),r.applyImpulse(l),n.applyImpulse(l.invert()),this.normal.copy(i),this.distance=y,this.velocityBias=A,this.divisor=C,this.impulse=0},r.prototype.resolve=function(){var t=this.a,e=this.b,n=a,r=u,i=this.minLength,s=this.distance;if(!(Math.abs(s)<i)){var h=t.velocity,c=e.velocity,l=this.normal;o.subtract(c,h,r);var p=-(o.dot(l,r)+this.velocityBias)/this.divisor;o.scale(l,p,n),e.applyImpulse(n),t.applyImpulse(n.invert()),this.impulse+=p}},e.exports=r},{"../../math/Vec3":50,"./Constraint":62}],65:[function(t,e,n){"use strict";function r(t,e,n){this.a=t,this.b=e,i.call(this,n),this.impulse=0,this.distance=0,this.normal=new o,this.velocityBias=0,this.divisor=0}var i=t("./Constraint"),o=t("../../math/Vec3"),s=new o,a=new o,u=new o,h=new o,c=Math.PI;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.init=function(){this.length=this.length||o.subtract(this.b.position,this.a.position,h).length(),this.minLength=this.minLength||0,this.period=this.period||.2,this.dampingRatio=this.dampingRatio||.5,this.stiffness=4*c*c/(this.period*this.period),this.damping=4*c*this.dampingRatio/this.period},r.prototype.update=function(t,e){var n=this.a,r=this.b,i=s,u=h,c=a,l=this.length,p=n.position,f=n.inverseMass,d=r.position,g=r.inverseMass;o.subtract(d,p,u);var v=u.length();o.scale(u,1/v,i);var m,_,y=v-l,b=f+g,w=1/b;if(0===this.period)m=0,_=1;else{var x=this.damping*w,T=this.stiffness*w;m=1/(e*(x+e*T)),_=e*T/(x+e*T)}var E=_*y/e,I=m+b,A=this.impulse;o.scale(i,A,c),r.applyImpulse(c),n.applyImpulse(c.invert()),this.normal.copy(i),this.distance=y,this.velocityBias=E,this.divisor=I,this.impulse=0},r.prototype.resolve=function(){var t=this.a,e=this.b,n=a,r=u,i=this.minLength,s=this.distance;if(!(Math.abs(s)<i)){var h=t.getVelocity(),c=e.getVelocity(),l=this.normal;o.subtract(c,h,r);var p=-(o.dot(l,r)+this.velocityBias)/this.divisor;o.scale(l,p,n),e.applyImpulse(n),t.applyImpulse(n.invert()),this.impulse+=p}},e.exports=r},{"../../math/Vec3":50,"./Constraint":62}],66:[function(t,e,n){"use strict";function r(t,e,n){this.a=t,this.b=e,i.call(this,n),this.impulse=new o,this.angImpulseA=new o,this.angImpulseB=new o,this.error=new o,this.errorRot=[0,0],this.effMassMatrix=new s,this.effMassMatrixRot=[]}var i=t("./Constraint"),o=t("../../math/Vec3"),s=t("../../math/Mat33"),a=t("../../math/Quaternion"),u=new o,h=new o,c=new o,l=new o,p=new o,f=new o,d=new o,g=new o;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.init=function(){var t=this.anchor,e=this.axis.normalize(),n=this.a,r=this.b,i=a.conjugate(n.orientation,new a),s=a.conjugate(r.orientation,new a);this.rA=o.subtract(t,n.position,new o),this.rB=o.subtract(t,r.position,new o),this.bodyRA=i.rotateVector(this.rA,new o),this.bodyRB=s.rotateVector(this.rB,new o),this.axisA=o.clone(e),this.axisB=o.clone(e),this.axisBTangent1=new o,this.axisBTangent2=new o,this.t1xA=new o,this.t2xA=new o,this.bodyAxisA=i.rotateVector(e,new o),this.bodyAxisB=s.rotateVector(e,new o)},r.prototype.update=function(t,e){var n=this.a,r=this.b,i=n.orientation.rotateVector(this.bodyAxisA,this.axisA),a=r.orientation.rotateVector(this.bodyAxisB,this.axisB);this.axis.copy(a);var p=a,f=this.axisBTangent1,d=this.axisBTangent2;p.x>=.57735?f.set(p.y,-p.x,0):f.set(0,p.z,-p.y),f.normalize(),o.cross(p,f,d);var g=o.cross(f,i,this.t1xA),v=o.cross(d,i,this.t2xA),m=n.orientation.rotateVector(this.bodyRA,this.rA),_=r.orientation.rotateVector(this.bodyRB,this.rB),y=new s([0,m.z,-m.y,-m.z,0,m.x,m.y,-m.x,0]),b=new s([0,_.z,-_.y,-_.z,0,_.x,_.y,-_.x,0]),w=s.multiply(y,n.inverseInertia,new s).multiply(y.transpose()),x=s.multiply(b,r.inverseInertia,new s).multiply(b.transpose()),T=s.add(w,x,w),E=o.add(n.position,this.rA,this.anchor),I=o.add(r.position,this.rB,u),A=1/e;o.subtract(I,E,this.error),this.error.scale(.2*A);var C=n.inverseMass,R=r.inverseMass,S=new s([C+R,0,0,0,C+R,0,0,0,C+R]);s.add(T,S,this.effMassMatrix),this.effMassMatrix.inverse();var O=n.inverseInertia.vectorMultiply(g,u),M=n.inverseInertia.vectorMultiply(v,h),z=r.inverseInertia.vectorMultiply(g,c),L=r.inverseInertia.vectorMultiply(v,l),N=o.dot(g,O)+o.dot(g,z),D=o.dot(g,M)+o.dot(g,L),U=o.dot(v,O)+o.dot(v,z),P=o.dot(v,M)+o.dot(v,L),F=1/(N*P-D*U);this.effMassMatrixRot[0]=P*F,this.effMassMatrixRot[1]=-U*F,this.effMassMatrixRot[2]=-D*F,this.effMassMatrixRot[3]=N*F,this.errorRot[0]=.2*o.dot(i,f)*A,this.errorRot[1]=.2*o.dot(i,d)*A;var k=this.impulse.scale(.5),G=this.angImpulseA.scale(.5),B=this.angImpulseB.scale(.5);r.applyImpulse(k),r.applyAngularImpulse(B),k.invert(),n.applyImpulse(k),n.applyAngularImpulse(G),k.clear(),G.clear(),B.clear()},r.prototype.resolve=function(){var t=this.a,e=this.b,n=this.rA,r=this.rB,i=this.t1xA,s=this.t2xA,a=t.angularVelocity,v=e.angularVelocity,m=o.add(t.velocity,o.cross(a,n,d),p),_=o.add(e.velocity,o.cross(v,r,d),f),y=m.subtract(_).subtract(this.error).applyMatrix(this.effMassMatrix),b=o.subtract(v,a,g),w=this.errorRot,x=o.dot(i,b)+w[0],T=o.dot(s,b)+w[1],E=this.effMassMatrixRot,I=-(E[0]*x+E[1]*T),A=-(E[2]*x+E[3]*T),C=o.scale(i,I,h).add(o.scale(s,A,c)),R=o.cross(r,y,u).add(C),S=o.cross(n,y,l).invert().subtract(C);e.applyImpulse(y),e.applyAngularImpulse(R),y.invert(),t.applyImpulse(y),t.applyAngularImpulse(S),y.invert(),this.impulse.add(y),this.angImpulseA.add(S),this.angImpulseB.add(R)},e.exports=r},{"../../math/Mat33":47,"../../math/Quaternion":48,"../../math/Vec3":50,"./Constraint":62}],67:[function(t,e,n){"use strict";function r(t){this._body=t,this._ID=t._ID,this.position=null,this.vertices={x:[],y:[],z:[]},this.update()}var i=4,o=8,s=0,a=1,u=2,h=3,c=4,l=5;r.prototype.update=function(){var t=this._body,e=this.position=t.position,n=1/0,r=-(1/0),p=1/0,f=-(1/0),d=1/0,g=-(1/0),v=t.type;if(v===i)r=f=g=t.radius,n=p=d=-t.radius;else if(v===o){var m=t.direction;switch(r=f=g=1e6,n=p=d=-1e6,m){case s:f=25,p=-1e3;break;case a:f=1e3,p=-25;break;case u:r=25,n=-1e3;break;case h:r=1e3,n=-25;break;case c:g=25,d=-1e3;break;case l:g=1e3,d=-25}}else if(t.vertices)for(var _=t.vertices,y=0,b=_.length;b>y;y++){var w=_[y];w.x<n&&(n=w.x),w.x>r&&(r=w.x),w.y<p&&(p=w.y),w.y>f&&(f=w.y),w.z<d&&(d=w.z),w.z>g&&(g=w.z)}else r=f=g=25,n=p=d=-25;var x=this.vertices;x.x[0]=n+e.x,x.x[1]=r+e.x,x.y[0]=p+e.y,x.y[1]=f+e.y,x.z[0]=d+e.z,x.z[1]=g+e.z},r.checkOverlap=function(t,e){var n=t.vertices,r=e.vertices,i=n.x[0],o=n.x[1],s=r.x[0],a=r.x[1];if(i>=s&&a>=i||s>=i&&o>=s){var u=n.y[0],h=n.y[1],c=r.y[0],l=r.y[1];if(u>=c&&l>=u||c>=u&&h>=c){var p=n.z[0],f=n.z[1],d=r.z[0],g=r.z[1];if(p>=d&&g>=p||d>=p&&f>=d)return!0}}return!1},r.vertexThreshold=100,e.exports=r},{}],68:[function(t,e,n){"use strict";function r(t){this._volumes=[],this._entityRegistry={};for(var e=0;e<t.length;e++)this.add(t[e])}function i(t){this.targets=t}var o=t("./AABB");r.prototype.add=function(t){var e=new o(t);this._entityRegistry[t._ID]=t,this._volumes.push(e)},r.prototype.update=function(){for(var t=this._volumes,e=this._entityRegistry,n=0,r=t.length;r>n;n++)t[n].update();for(var i=[],s=0,a=t.length;a>s;s++)for(var u=s+1;a>u;u++)o.checkOverlap(t[s],t[u])&&i.push([e[s],e[u]]);return i},i.prototype.add=function(t){this.targets.push(t)},i.prototype.update=function(){return[this.targets]},e.exports.BruteForceAABB=r,e.exports.BruteForce=i},{"./AABB":67}],69:[function(t,e,n){"use strict";function r(t,e,n){return e>t?e:t>n?n:t}function i(){this.manifolds=[],this.collisionMatrix={},this._IDPool=[]}function o(t,e,n,r){this.lowID=t,this.highID=e,this.contacts=[],this.numContacts=0,this.bodyA=n,this.bodyB=r,this.lru=0}function s(t,e,n){this.bodyA=t,this.bodyB=e,this.data=n,this.normalImpulse=0,this.tangentImpulse1=0,this.tangentImpulse2=0,this.impulse=new a,this.angImpulseA=new a,this.angImpulseB=new a,n&&this.init()}var a=t("../../../math/Vec3"),u=t("../../../utilities/ObjectManager");u.register("Manifold",o),u.register("Contact",s);var h=u.requestManifold,c=u.requestContact,l=u.freeManifold,p=u.freeContact,f=new a,d=new a,g=new a,v=new a,m=new a,_=new a,y=new a,b=new a,w=new a,x=new a,T=new a,E=new a,I=new a,A=new a,C=new a;i.prototype.addManifold=function(t,e,n,r){var i=this.collisionMatrix;i[t]=i[t]||{};var o=this._IDPool.length?this._IDPool.pop():this.manifolds.length;this.collisionMatrix[t][e]=o;var s=h().reset(t,e,n,r);return this.manifolds[o]=s,s},i.prototype.removeManifold=function(t,e){var n=this.collisionMatrix;this.manifolds[e]=null,n[t.lowID][t.highID]=null,this._IDPool.push(e),l(t)},i.prototype.update=function(t){for(var e=this.manifolds,n=0,r=e.length;r>n;n++){var i=e[n];if(i){var o=i.update(t);o||(this.removeManifold(i,n),i.bodyA.events.trigger("collision:end",i),i.bodyB.events.trigger("collision:end",i))}}},i.prototype.prepContacts=function(t){for(var e=this.manifolds,n=0,r=e.length;r>n;n++){var i=e[n];if(i)for(var o=i.contacts,s=0,a=o.length;a>s;s++){var u=o[s];u&&u.update(t)}}},i.prototype.resolveManifolds=function(){for(var t=this.manifolds,e=0,n=t.length;n>e;e++){var r=t[e];r&&r.resolveContacts()}},i.prototype.registerContact=function(t,e,n){var r,i;t._ID<e._ID?(r=t._ID,i=e._ID):(r=e._ID,i=t._ID);var o,s=this.manifolds,a=this.collisionMatrix;a[r]&&null!=a[r][i]?(o=s[a[r][i]],o.contains(n),o.addContact(t,e,n)):(o=this.addManifold(r,i,t,e),o.addContact(t,e,n),t.events.trigger("collision:start",o),e.events.trigger("collision:start",o))};var R=10;o.prototype.reset=function(t,e,n,r){return this.lowID=t,this.highID=e,this.contacts=[],this.numContacts=0,this.bodyA=n,this.bodyB=r,this.lru=0,this},o.prototype.addContact=function(t,e,n){var r=this.lru;this.contacts[r]&&this.removeContact(this.contacts[r],r),this.contacts[r]=c().reset(t,e,n),this.lru=(this.lru+1)%4,this.numContacts++},o.prototype.removeContact=function(t,e){this.contacts[e]=null,this.numContacts--,u.freeCollisionData(t.data),t.data=null,p(t)},o.prototype.contains=function(t){for(var e=t.worldContactA,n=t.worldContactB,r=this.contacts,i=0,o=r.length;o>i;i++){var s=r[i];if(s){var u=s.data,h=a.subtract(u.worldContactA,e,A).length(),c=a.subtract(u.worldContactB,n,C).length();if(R>h||R>c)return this.removeContact(s,i),!0}}return!1},o.prototype.update=function(){for(var t=this.contacts,e=this.bodyA,n=this.bodyB,r=e.position,i=n.position,o=0,s=t.length;s>o;o++){var u=t[o];if(u){var h=u.data,c=h.normal,l=h.localContactA,p=h.localContactB,f=h.worldContactA,d=h.worldContactB,g=a.add(r,l,T),v=a.add(i,p,E),m=a.dot(a.subtract(v,g,I),c)>0,_=a.subtract(f,g,A),y=a.subtract(d,v,C);(_.length()>=R||y.length()>=R||m)&&this.removeContact(u,o)}}return this.numContacts?!0:!1},o.prototype.resolveContacts=function(){for(var t=this.contacts,e=0,n=t.length;n>e;e++)t[e]&&t[e].resolve()},s.prototype.reset=function(t,e,n){return this.bodyA=t,this.bodyB=e,this.data=n,this.normalImpulse=0,this.tangentImpulse1=0,this.tangentImpulse2=0,this.impulse.clear(),this.angImpulseA.clear(),this.angImpulseB.clear(),this.init(),this},s.prototype.init=function(){var t=this.data,e=t.normal,n=new a;e.x>=.57735?n.set(e.y,-e.x,0):n.set(0,e.z,-e.y),n.normalize();var r=a.cross(e,n,new a);this.tangent1=n,this.tangent2=r;var i=this.bodyA,o=this.bodyB,s=t.localContactA,u=t.localContactB,h=i.inverseMass+o.inverseMass,c=a.cross(s,e,_),l=a.cross(u,e,y);this.effNormalMass=1/(h+a.dot(c,i.inverseInertia.vectorMultiply(c,f))+a.dot(l,o.inverseInertia.vectorMultiply(l,f)));var p=a.cross(s,n,_),d=a.cross(u,n,y);this.effTangentialMass1=1/(h+a.dot(p,i.inverseInertia.vectorMultiply(p,f))+a.dot(d,o.inverseInertia.vectorMultiply(d,f)));var g=a.cross(s,r,_),v=a.cross(u,r,y);this.effTangentialMass2=1/(h+a.dot(g,i.inverseInertia.vectorMultiply(g,f))+a.dot(v,o.inverseInertia.vectorMultiply(v,f))),this.restitution=Math.min(i.restitution,o.restitution),this.friction=i.friction*o.friction},s.prototype.update=function(t){var e=this.data,n=this.bodyA,r=this.bodyB,i=e.localContactA,o=e.localContactB,s=e.normal,u=a.add(n.velocity,a.cross(n.angularVelocity,i,m),g),h=a.add(r.velocity,a.cross(r.angularVelocity,o,m),v),c=h.subtract(u),l=a.dot(c,s),p=.15,f=1.5,d=20,_=Math.abs(l)<d?0:this.restitution;this.velocityBias=-p*Math.max(e.penetration-f,0)/t,this.velocityBias+=_*l;var y=this.impulse.scale(.25),b=this.angImpulseA.scale(.25),w=this.angImpulseB.scale(.25);r.applyImpulse(y),r.applyAngularImpulse(w),y.invert(),n.applyImpulse(y),n.applyAngularImpulse(b),this.normalImpulse=0,this.tangentImpulse1=0,this.tangentImpulse2=0,y.clear(),b.clear(),w.clear()},s.prototype.resolve=function(){var t=this.data,e=this.bodyA,n=this.bodyB,i=t.localContactA,o=t.localContactB,s=t.normal,u=this.tangent1,h=this.tangent2,c=a.add(e.velocity,a.cross(e.angularVelocity,i,m),g),l=a.add(n.velocity,a.cross(n.angularVelocity,o,m),v),p=l.subtract(c),_=-(a.dot(p,s)+this.velocityBias)*this.effNormalMass,y=Math.max(this.normalImpulse+_,0);_=y-this.normalImpulse;var T=this.friction*y,E=-a.dot(p,u)*this.effTangentialMass1,I=r(this.tangentImpulse1+E,-T,T);E=I-this.tangentImpulse1;var A=-a.dot(p,h)*this.effTangentialMass2,C=r(this.tangentImpulse2+A,-T,T);A=C-this.tangentImpulse2;var R=a.scale(s,_,b),S=a.scale(u,E,w),O=a.scale(h,A,x);R.add(S).add(O);var M=a.cross(o,R,f),z=a.cross(i,R,d).invert();n.applyImpulse(R),n.applyAngularImpulse(M),R.invert(),e.applyImpulse(R),e.applyAngularImpulse(z),this.normalImpulse=y,this.tangentImpulse1=I,this.tangentImpulse2=C,this.impulse.add(R),this.angImpulseA.add(z),this.angImpulseB.add(M)},e.exports=i},{"../../../math/Vec3":50,"../../../utilities/ObjectManager":97}],70:[function(t,e,n){"use strict";function r(t,e,n){this.vertex=t,this.worldVertexA=e,this.worldVertexB=n}function i(t){var e,n=t.vertices;for(e=n.length;e--;){var r=n.pop();null!==r&&p(r)}t.numVertices=0;var i=t.features;for(e=i.length;e--;){var o=i.pop();null!==o&&d(o)}t.numFeatures=0,f(t)}function o(t,e,n){var r=u.scale(n,-1,b),i=u.add(t.support(n),t.position,new u),o=u.add(e.support(r),e.position,new u);return c().reset(u.subtract(i,o,new u),i,o)}function s(t,e){var n=o,r=u.subtract(e.position,t.position,y).normalize(),s=l();s.addVertex(n(t,e,r)),r.invert();for(var a=0,h=1e3;a++<h&&(0!==r.x||0!==r.y||0!==r.z)&&(s.addVertex(n(t,e,r)),!(u.dot(s.getLastVertex().vertex,r)<0));)if(s.simplexContainsOrigin(r,p))return s;return i(s),!1}function a(t,e,n){for(var r=o,s=1/0,a=0,c=1e3;a++<c;){var l=n.getFeatureClosestToOrigin();if(null===l)return null;var f=l.normal,d=r(t,e,f);if(s=Math.min(s,u.dot(d.vertex,f)),s-l.distance<=.01){var y=n.vertices[l.vertexIndices[0]],b=n.vertices[l.vertexIndices[1]],w=n.vertices[l.vertexIndices[2]],x=y.vertex,T=b.vertex,E=w.vertex,I=u.scale(f,l.distance,g),A=u.subtract(T,x,v),C=u.subtract(E,x,m),R=u.subtract(I,x,_),S=u.dot(A,A),O=u.dot(A,C),M=u.dot(C,C),z=u.dot(R,A),L=u.dot(R,C),N=S*M-O*O,D=(M*z-O*L)/N,U=(S*L-O*z)/N,P=1-D-U,F=y.worldVertexA.scale(P).add(b.worldVertexA.scale(D)).add(w.worldVertexA.scale(U)),k=y.worldVertexB.scale(P).add(b.worldVertexB.scale(D)).add(w.worldVertexB.scale(U)),G=u.subtract(F,t.position,new u),B=u.subtract(k,e.position,new u);return i(n),p(d),h.requestCollisionData().reset(l.distance,f,F,k,G,B)}n.addVertex(d),n.reshape()}throw new Error("EPA failed to terminate in allotted iterations.")}var u=t("../../../math/Vec3"),h=t("../../../utilities/ObjectManager");h.register("GJK_EPASupportPoint",r);var c=h.requestGJK_EPASupportPoint,l=h.requestDynamicGeometry,p=h.freeGJK_EPASupportPoint,f=h.freeDynamicGeometry,d=h.freeDynamicGeometryFeature,g=new u,v=new u,m=new u,_=new u,y=new u,b=new u;r.prototype.reset=function(t,e,n){return this.vertex=t,this.worldVertexA=e,this.worldVertexB=n,this},e.exports.gjk=s,e.exports.epa=a},{"../../../math/Vec3":50,"../../../utilities/ObjectManager":97}],71:[function(t,e,n){"use strict";function r(t){this._sweepVolumes=[],this._entityRegistry={},this._boundingVolumeRegistry={},this.endpoints={x:[],y:[],z:[]},this.overlaps=[],this.overlapsMatrix={},this._IDPool=[],t=t||[];for(var e=0;e<t.length;e++)this.add(t[e])}function i(t){this._boundingVolume=t,this._ID=t._ID,this.points={x:[{_ID:t._ID,side:0,value:null},{_ID:t._ID,side:1,value:null}],y:[{_ID:t._ID,side:0,value:null},{_ID:t._ID,side:1,value:null}],z:[{_ID:t._ID,side:0,value:null},{_ID:t._ID,side:1,value:null}]},this.update()}var o=t("./AABB"),s=["x","y","z"];r.prototype.add=function(t){var e=new o(t),n=new i(e);this._entityRegistry[t._ID]=t,this._boundingVolumeRegistry[t._ID]=e,this._sweepVolumes.push(n);for(var r=0;3>r;r++){var a=s[r];this.endpoints[a].push(n.points[a][0]),this.endpoints[a].push(n.points[a][1])}},r.prototype.remove=function(t){this._entityRegistry[t._ID]=null,this._boundingVolumeRegistry[t._ID]=null;var e,n,r;for(e=0,n=this._sweepVolumes.length;n>e;e++)if(this._sweepVolumes[e]._ID===t._ID){r=e;break}this._sweepVolumes.splice(r,1);var i,o=this.endpoints,s=[];for(e=0,n=o.x.length;n>e;e++)i=o.x[e],i._ID!==t._ID&&s.push(i);var a=[];for(e=0,n=o.y.length;n>e;e++)i=o.y[e],i._ID!==t._ID&&a.push(i);var u=[];for(e=0,n=o.z.length;n>e;e++)i=o.z[e],i._ID!==t._ID&&u.push(i);o.x=s,o.y=a,o.z=u},r.prototype.update=function(){var t,e,n,r,i=this._sweepVolumes,a=this._entityRegistry,u=this._boundingVolumeRegistry;for(e=0,r=i.length;r>e;e++)i[e].update();var h=this.endpoints,c=this.overlaps,l=this.overlapsMatrix,p=this._IDPool;for(n=0;3>n;n++){var f=s[n],d=h[f];for(e=1,r=d.length;r>e;e++){var g,v,m,_,y,b,w,x=d[e],T=x.value;for(t=e-1;t>=0&&(g=d[t]).value>T;)b=x._ID,w=g._ID,w>b?(_=b,y=w):(_=w,y=b),~x.side&g.side?o.checkOverlap(u[b],u[w])&&(v=l[_]=l[_]||{},m=v[y]=p.length?p.pop():c.length,c[m]=[a[_],a[y]]):x.side&~g.side&&(v=l[_])&&null!=v[y]&&(m=v[y],c[m]=null,v[y]=null,p.push(m)),d[t+1]=g,t--;d[t+1]=x}}return c},i.prototype.update=function(){var t=this._boundingVolume;t.update();for(var e=this.points,n=0;3>n;n++){var r=s[n];e[r][0].value=t.vertices[r][0],e[r][1].value=t.vertices[r][1]}},e.exports=r},{"./AABB":67}],72:[function(t,e,n){"use strict";function r(t,e){i.call(this,t,e)}var i=t("./Force"),o=t("../../math/Vec3"),s=new o;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.QUADRATIC=function(t){return t*t},r.LINEAR=function(t){return t},r.prototype.init=function(){this.max=this.max||1/0,this.strength=this.strength||1,this.type=this.type||r.LINEAR},r.prototype.update=function(){for(var t=this.targets,e=this.type,n=s,r=this.max,i=this.strength,a=0,u=t.length;u>a;a++){var h=t[a],c=h.velocity,l=c.length(),p=l?1/l:0,f=-i*e(l);o.scale(c,(-r>f?-r:f)*p,n),h.applyForce(n)}},e.exports=r},{"../../math/Vec3":50,"./Force":73}],73:[function(t,e,n){"use strict";function r(t,e){t?t instanceof Array?this.targets=t:this.targets=[t]:this.targets=[],e=e||{},this.setOptions(e),this._ID=i++}var i=0;r.prototype.setOptions=function(t){for(var e in t)this[e]=t[e];this.init(t)},r.prototype.addTarget=function(t){this.targets.push(t)},r.prototype.removeTarget=function(t){var e=this.targets.indexOf(t);0>e||this.targets.splice(e,1)},r.prototype.init=function(t){},r.prototype.update=function(t,e){},e.exports=r},{}],74:[function(t,e,n){"use strict";function r(t,e){i.call(this,t,e)}var i=t("./Force"),o=t("../../math/Vec3"),s=new o;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.DOWN=0,r.UP=1,r.LEFT=2,r.RIGHT=3,r.FORWARD=4,r.BACKWARD=5,r.prototype.init=function(t){if(this.max=this.max||1/0,t.acceleration)return this.strength=this.acceleration.length(),void(this.direction=-1);var e=this.acceleration=new o,n=this.direction=this.direction||r.DOWN,i=this.strength=this.strength||200;switch(n){case r.DOWN:e.set(0,i,0);break;case r.UP:e.set(0,-1*i,0);break;case r.LEFT:e.set(-1*i,0,0);break;case r.RIGHT:e.set(i,0,0);break;case r.FORWARD:e.set(0,0,-1*i);break;case r.BACKWARD:e.set(0,0,i)}},r.prototype.update=function(){for(var t=this.targets,e=s,n=this.max,r=this.acceleration,i=r.length(),a=i?1/i:0,u=0,h=t.length;h>u;u++){var c=t[u],l=i*c.mass;o.scale(r,(l>n?n:l)*a,e),c.applyForce(e)}},e.exports=r},{"../../math/Vec3":50,"./Force":73}],75:[function(t,e,n){"use strict";function r(t,e,n){this.source=t||null,i.call(this,e,n)}var i=t("./Force"),o=t("../../math/Vec3"),s=new o;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.init=function(){this.max=this.max||1/0,this.strength=this.strength||200},r.prototype.update=function(){for(var t=this.source,e=this.targets,n=s,r=this.strength,i=this.max,a=this.anchor||t.position,u=this.anchor?1:t.mass,h=0,c=e.length;c>h;h++){var l=e[h];o.subtract(a,l.position,n);var p=n.length(),f=p?1/p:0,d=r*u*l.mass*f*f;d=0>d?-i>d?-i:d:d>i?i:d,n.scale(d*f),l.applyForce(n),t&&t.applyForce(n.invert())}},e.exports=r},{"../../math/Vec3":50,"./Force":73}],76:[function(t,e,n){"use strict";function r(t,e){i.call(this,t,e)}var i=t("./Force"),o=t("../../math/Vec3"),s=new o;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.QUADRATIC=function(t){return t.length()},r.LINEAR=function(){return 1},r.prototype.init=function(){this.max=this.max||1/0,this.strength=this.strength||1,this.type=this.type||r.LINEAR},r.prototype.update=function(){for(var t=this.targets,e=this.type,n=s,r=this.max,i=this.strength,a=0,u=t.length;u>a;a++){var h=t[a],c=h.angularVelocity,l=-i*e(c);o.scale(c,-r>l?-r:l,n),h.applyTorque(n)}},e.exports=r},{"../../math/Vec3":50,"./Force":73}],77:[function(t,e,n){"use strict";function r(t,e,n){this.source=t||null,i.call(this,e,n)}var i=t("./Force"),o=t("../../math/Vec3"),s=t("../../math/Mat33"),a=t("../../math/Quaternion"),u=new a,h=new o,c=new o,l=new s,p=Math.PI;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.init=function(t){this.source||(this.anchor=this.anchor?this.anchor.normalize():new a(1,0,0,0)),t.stiffness||t.damping?(this.stiffness=this.stiffness||100,this.damping=this.damping||0,this.period=null,this.dampingRatio=null):(t.period||t.dampingRatio)&&(this.period=this.period||1,this.dampingRatio=this.dampingRatio||0,this.stiffness=2*p/this.period,this.stiffness*=this.stiffness,this.damping=4*p*this.dampingRatio/this.period)},r.prototype.update=function(){for(var t=this.source,e=this.targets,n=u,r=h,i=c,p=l,f=this.max,d=this.stiffness,g=this.damping,v=this.anchor||t.orientation,m=this.anchor?null:t.inverseInertia,_=0,y=e.length;y>_;_++){var b=e[_],w=b.orientation;if(a.conjugate(w,n),n.multiply(v),!(n.w>=1)){var x=Math.acos(n.w),T=Math.sqrt(1-n.w*n.w),E=i.copy(n).scale(2*x/T);E.scale(d),null!==m?s.add(m,b.inverseInertia,p).inverse():s.inverse(b.inverseInertia,p),0!==g&&(t?E.add(o.subtract(b.angularVelocity,t.angularVelocity,r).scale(-g)):E.add(o.scale(b.angularVelocity,-g,r)));var I=E.applyMatrix(p),A=I.length();A>f&&I.scale(f/A),b.applyTorque(I),t&&t.applyTorque(I.invert())}}},e.exports=r},{"../../math/Mat33":47,"../../math/Quaternion":48,"../../math/Vec3":50,"./Force":73}],78:[function(t,e,n){"use strict";function r(t,e,n){this.source=t||null,i.call(this,e,n)}var i=t("./Force"),o=t("../../math/Vec3"),s=new o,a=new o;r.prototype=Object.create(i.prototype),r.prototype.constructor=r;var u=Math.PI;r.FENE=function(t,e){var n=.99*e,r=Math.max(Math.min(t,n),-n);return r/(1-r*r/(e*e))},r.HOOKE=function(t){return t},r.prototype.init=function(t){this.max=this.max||1/0,this.length=this.length||0,this.type=this.type||r.HOOKE,this.maxLength=this.maxLength||1/0,t.stiffness||t.damping?(this.stiffness=this.stiffness||100,this.damping=this.damping||0,this.period=null,this.dampingRatio=null):(t.period||t.dampingRatio)&&(this.period=this.period||1,this.dampingRatio=this.dampingRatio||0,this.stiffness=2*u/this.period,this.stiffness*=this.stiffness,this.damping=4*u*this.dampingRatio/this.period)},r.prototype.update=function(){for(var t=this.source,e=this.targets,n=s,r=a,i=this.max,u=this.stiffness,h=this.damping,c=this.length,l=this.maxLength,p=this.anchor||t.position,f=this.anchor?0:t.inverseMass,d=this.type,g=0,v=e.length;v>g;g++){var m=e[g];o.subtract(p,m.position,n);var _=n.length(),y=_-c;if(!(Math.abs(y)<1e-6)){var b=1/(m.inverseMass+f);null!==this.period&&(u*=b,h*=b),n.scale(u*d(y,l)/y),0!==h&&(t?n.add(o.subtract(m.velocity,t.velocity,r).scale(-h)):n.add(o.scale(m.velocity,-h,r)));var w=n.length(),x=w?1/w:0;o.scale(n,(w>i?i:w)*x,n),m.applyForce(n),t&&t.applyForce(n.invert())}}},e.exports=r},{"../../math/Vec3":50,"./Force":73}],79:[function(t,e,n){"use strict";e.exports={Particle:t("./bodies/Particle"),convexBodyFactory:t("./bodies/convexBodyFactory"),Box:t("./bodies/Box"),Sphere:t("./bodies/Sphere"),Wall:t("./bodies/Wall"),Constraint:t("./constraints/Constraint"),Angle:t("./constraints/Angle"),Collision:t("./constraints/Collision"),Direction:t("./constraints/Direction"),Distance:t("./constraints/Distance"),Curve:t("./constraints/Curve"),Hinge:t("./constraints/Hinge"),BallAndSocket:t("./constraints/BallAndSocket"),Force:t("./forces/Force"),Drag:t("./forces/Drag"),RotationalDrag:t("./forces/RotationalDrag"),Gravity1D:t("./forces/Gravity1D"),Gravity3D:t("./forces/Gravity3D"),Spring:t("./forces/Spring"),RotationalSpring:t("./forces/RotationalSpring"),PhysicsEngine:t("./PhysicsEngine"),Geometry:t("./Geometry")}},{"./Geometry":52,"./PhysicsEngine":53,"./bodies/Box":54,"./bodies/Particle":55,"./bodies/Sphere":56,"./bodies/Wall":57,"./bodies/convexBodyFactory":58,"./constraints/Angle":59,"./constraints/BallAndSocket":60,"./constraints/Collision":61,"./constraints/Constraint":62,"./constraints/Curve":63,"./constraints/Direction":64,"./constraints/Distance":65,"./constraints/Hinge":66,"./forces/Drag":72,"./forces/Force":73,"./forces/Gravity1D":74,"./forces/Gravity3D":75,"./forces/RotationalDrag":76,"./forces/RotationalSpring":77,"./forces/Spring":78}],80:[function(t,e,n){"use strict";var r,i,o=0,s=["ms","moz","webkit","o"];if("object"==typeof window){r=window.requestAnimationFrame,i=window.cancelAnimationFrame||window.cancelRequestAnimationFrame;for(var a=0;a<s.length&&!r;++a)r=window[s[a]+"RequestAnimationFrame"],i=window[s[a]+"CancelRequestAnimationFrame"]||window[s[a]+"CancelAnimationFrame"];r&&!i&&(r=null)}if(!r){var u=Date.now?Date.now:function(){return(new Date).getTime()};r=function(t){var e=u(),n=Math.max(0,16-(e-o)),r=setTimeout(function(){t(e+n)},n);return o=e+n,r},i=function(t){clearTimeout(t)}}var h={requestAnimationFrame:r,cancelAnimationFrame:i};e.exports=h},{}],81:[function(t,e,n){"use strict";e.exports={requestAnimationFrame:t("./animationFrame").requestAnimationFrame,cancelAnimationFrame:t("./animationFrame").cancelAnimationFrame}},{"./animationFrame":80}],82:[function(t,e,n){"use strict";function r(){this._updates=[],this._stoppedAt=i(),this._sleep=0,this.start();var t=this;window.addEventListener("message",function(e){t._onWindowMessage(e)})}var i=t("./now");r.prototype._onWindowMessage=function(t){this._running&&t.data.constructor===Array&&"FRAME"===t.data[0]&&this.step(t.data[1]-this._sleep)},r.prototype.start=function(){return this._running=!0,this._sleep+=i()-this._stoppedAt,this},r.prototype.stop=function(){return this._running=!1,this._stoppedAt=i(),this},r.prototype.isRunning=function(){return this._running},r.prototype.step=function(t){for(var e=0,n=this._updates.length;n>e;e++)this._updates[e].update(t);return this},r.prototype.update=function(t){return-1===this._updates.indexOf(t)&&this._updates.push(t),this},r.prototype.noLongerUpdate=function(t){var e=this._updates.indexOf(t);return e>-1&&this._updates.splice(e,1),this},e.exports=r},{"./now":85}],83:[function(t,e,n){"use strict";function r(){var t=this;this._updates=[],this._looper=function(e){t.loop(e)},this._time=0,this._stoppedAt=0,this._sleep=0,this._startOnVisibilityChange=!0,this._rAF=null,this._sleepDiff=!0,this.start(),a&&document.addEventListener(h,function(){t._onVisibilityChange()})}var i=t("../polyfills"),o=i.requestAnimationFrame,s=i.cancelAnimationFrame,a="undefined"!=typeof document;if(a){var u,h;"undefined"!=typeof document.hidden?(u="hidden",h="visibilitychange"):"undefined"!=typeof document.mozHidden?(u="mozHidden",h="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(u="msHidden",h="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(u="webkitHidden",h="webkitvisibilitychange")}r.prototype._onVisibilityChange=function(){document[u]?this._onUnfocus():this._onFocus()},r.prototype._onFocus=function(){this._startOnVisibilityChange&&this._start()},r.prototype._onUnfocus=function(){this._stop()},r.prototype.start=function(){return this._running||(this._startOnVisibilityChange=!0,this._start()),this;
},r.prototype._start=function(){this._running=!0,this._sleepDiff=!0,this._rAF=o(this._looper)},r.prototype.stop=function(){return this._running&&(this._startOnVisibilityChange=!1,this._stop()),this},r.prototype._stop=function(){this._running=!1,this._stoppedAt=this._time,s(this._rAF)},r.prototype.isRunning=function(){return this._running},r.prototype.step=function(t){this._time=t,this._sleepDiff&&(this._sleep+=t-this._stoppedAt,this._sleepDiff=!1);for(var e=t-this._sleep,n=0,r=this._updates.length;r>n;n++)this._updates[n].update(e);return this},r.prototype.loop=function(t){return this.step(t),this._rAF=o(this._looper),this},r.prototype.update=function(t){return-1===this._updates.indexOf(t)&&this._updates.push(t),this},r.prototype.noLongerUpdate=function(t){var e=this._updates.indexOf(t);return e>-1&&this._updates.splice(e,1),this},e.exports=r},{"../polyfills":81}],84:[function(t,e,n){"use strict";e.exports={RequestAnimationFrameLoop:t("./RequestAnimationFrameLoop"),ContainerLoop:t("./ContainerLoop"),now:t("./now")}},{"./ContainerLoop":82,"./RequestAnimationFrameLoop":83,"./now":85}],85:[function(t,e,n){"use strict";var r=window.performance&&window.performance.now?function(){return window.performance.now()}:Date.now;e.exports=r},{}],86:[function(t,e,n){"use strict";function r(){o(),this._contexts={},this._outCommands=[],this._inCommands=[],this._time=null,this._resized=!1;var t=this;window.addEventListener("resize",function(){t.onResize()})}var i=t("./Context"),o=t("./inject-css"),s=t("../core/Commands");r.prototype.onResize=function(){this._resized=!0;for(var t in this._contexts)this._contexts[t].updateSize()},r.prototype.getTime=function(){return this._time},r.prototype.sendEvent=function(t,e,n){this._outCommands.push(s.WITH,t,s.TRIGGER,e,n)},r.prototype.sendResize=function(t,e){this.sendEvent(t,"CONTEXT_RESIZE",e)},r.prototype.handleWith=function(t,e){var n=e[t],r=n.split("/"),i=this.getOrSetContext(r.shift());return i.receive(n,e,t)},r.prototype.getOrSetContext=function(t){if(this._contexts[t])return this._contexts[t];var e=new i(t,this);return this._contexts[t]=e,e},r.prototype.getContext=function(t){return this._contexts[t]?this._contexts[t]:void 0},r.prototype.drawCommands=function(){for(var t=this._inCommands,e=0,n=t[e];n;){switch(n){case s.TIME:this._time=t[++e];break;case s.WITH:e=this.handleWith(++e,t);break;case s.NEED_SIZE_FOR:this.giveSizeFor(++e,t)}n=t[++e]}for(var r in this._contexts)this._contexts[r].draw();return this._resized&&this.updateSize(),this._outCommands},r.prototype.updateSize=function(){for(var t in this._contexts)this._contexts[t].updateSize()},r.prototype.receiveCommands=function(t){for(var e=t.length,n=0;e>n;n++)this._inCommands.push(t[n]);for(var r in this._contexts)this._contexts[r].checkInit()},r.prototype.giveSizeFor=function(t,e){var n=e[t],r=this.getOrSetContext(n).getRootSize();this.sendResize(n,r)},r.prototype.clearCommands=function(){this._inCommands.length=0,this._outCommands.length=0,this._resized=!1},e.exports=r},{"../core/Commands":15,"./Context":87,"./inject-css":90}],87:[function(t,e,n){"use strict";function r(t,e){if(this._compositor=e,this._rootEl=document.querySelector(t),this._selector=t,null===this._rootEl)throw new Error('Failed to create Context: No matches for "'+t+'" found.');this._selector=t,this._initDOMRenderer(),this._webGLRenderer=null,this._domRenderer=new L(this._domRendererRootEl,t,e),this._canvasEl=null,this._renderState={projectionType:z.ORTHOGRAPHIC_PROJECTION,perspectiveTransform:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),viewTransform:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),viewDirty:!1,perspectiveDirty:!1},this._size=[],this._meshTransform=new Float32Array(16),this._meshSize=[0,0,0],this._initDOM=!1,this._commandCallbacks=[],this.initCommandCallbacks(),this.updateSize()}function i(t,e,n,r){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.preventDefault(n[++r]),r}function o(t,e,n,r){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.allowDefault(n[++r]),r}function s(t,e,n,r){return t._initDOM=!0,r}function a(t,e,n,r){return t._domRenderer.insertEl(n[++r]),r}function u(t,e,n,r){return t._domRenderer.getSizeOf(n[++r]),r}function h(t,e,n,r){var i=t._meshTransform;return i[0]=n[++r],i[1]=n[++r],i[2]=n[++r],i[3]=n[++r],i[4]=n[++r],i[5]=n[++r],i[6]=n[++r],i[7]=n[++r],i[8]=n[++r],i[9]=n[++r],i[10]=n[++r],i[11]=n[++r],i[12]=n[++r],i[13]=n[++r],i[14]=n[++r],i[15]=n[++r],t._domRenderer.setMatrix(i),t._webGLRenderer&&t._webGLRenderer.setCutoutUniform(e,"u_transform",i),r}function c(t,e,n,r){var i=n[++r],o=n[++r];return t._domRenderer.setSize(i,o),t._webGLRenderer&&(t._meshSize[0]=i,t._meshSize[1]=o,t._webGLRenderer.setCutoutUniform(e,"u_size",t._meshSize)),r}function l(t,e,n,r){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.setProperty(n[++r],n[++r]),r}function p(t,e,n,r){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.setContent(n[++r]),r}function f(t,e,n,r){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.setAttribute(n[++r],n[++r]),r}function d(t,e,n,r){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.addClass(n[++r]),r}function g(t,e,n,r){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.removeClass(n[++r]),r}function v(t,e,n,r){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.subscribe(n[++r]),r}function m(t,e,n,r){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setMeshOptions(e,n[++r]),r}function _(t,e,n,r){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setAmbientLightColor(e,n[++r],n[++r],n[++r]),r}function y(t,e,n,r){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setLightPosition(e,n[++r],n[++r],n[++r]),r}function b(t,e,n,r){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setLightColor(e,n[++r],n[++r],n[++r]),r}function w(t,e,n,r){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.handleMaterialInput(e,n[++r],n[++r]),r}function x(t,e,n,r){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setGeometry(e,n[++r],n[++r],n[++r]),r}function T(t,e,n,r){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setMeshUniform(e,n[++r],n[++r]),r}function E(t,e,n,r){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.bufferData(e,n[++r],n[++r],n[++r],n[++r],n[++r]),r}function I(t,e,n,r){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setCutoutState(e,n[++r]),r}function A(t,e,n,r){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setMeshVisibility(e,n[++r]),r}function C(t,e,n,r){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.removeMesh(e),r}function R(t,e,n,r){return t._renderState.projectionType=z.PINHOLE_PROJECTION,t._renderState.perspectiveTransform[11]=-1/n[++r],t._renderState.perspectiveDirty=!0,r}function S(t,e,n,r){return t._renderState.projectionType=z.ORTHOGRAPHIC_PROJECTION,t._renderState.perspectiveTransform[11]=0,t._renderState.perspectiveDirty=!0,r}function O(t,e,n,r){return t._renderState.viewTransform[0]=n[++r],t._renderState.viewTransform[1]=n[++r],t._renderState.viewTransform[2]=n[++r],t._renderState.viewTransform[3]=n[++r],t._renderState.viewTransform[4]=n[++r],t._renderState.viewTransform[5]=n[++r],t._renderState.viewTransform[6]=n[++r],t._renderState.viewTransform[7]=n[++r],t._renderState.viewTransform[8]=n[++r],t._renderState.viewTransform[9]=n[++r],t._renderState.viewTransform[10]=n[++r],t._renderState.viewTransform[11]=n[++r],t._renderState.viewTransform[12]=n[++r],t._renderState.viewTransform[13]=n[++r],t._renderState.viewTransform[14]=n[++r],t._renderState.viewTransform[15]=n[++r],t._renderState.viewDirty=!0,r}var M=t("../webgl-renderers/WebGLRenderer"),z=t("../components/Camera"),L=t("../dom-renderers/DOMRenderer"),N=t("../core/Commands");r.prototype.updateSize=function(){var t=this._rootEl.offsetWidth,e=this._rootEl.offsetHeight;return this._size[0]=t,this._size[1]=e,this._size[2]=t>e?t:e,this._compositor.sendResize(this._selector,this._size),this._webGLRenderer&&this._webGLRenderer.updateSize(this._size),this},r.prototype.draw=function(){this._domRenderer.draw(this._renderState),this._webGLRenderer&&this._webGLRenderer.draw(this._renderState),this._renderState.perspectiveDirty&&(this._renderState.perspectiveDirty=!1),this._renderState.viewDirty&&(this._renderState.viewDirty=!1)},r.prototype._initDOMRenderer=function(){this._domRendererRootEl=document.createElement("div"),this._rootEl.appendChild(this._domRendererRootEl),this._domRendererRootEl.style.display="none",this._domRenderer=new L(this._domRendererRootEl,this._selector,this._compositor)},r.prototype.getRootSize=function(){return[this._rootEl.offsetWidth,this._rootEl.offsetHeight]},r.prototype.initCommandCallbacks=function(){this._commandCallbacks[N.INIT_DOM]=a,this._commandCallbacks[N.DOM_RENDER_SIZE]=u,this._commandCallbacks[N.CHANGE_TRANSFORM]=h,this._commandCallbacks[N.CHANGE_SIZE]=c,this._commandCallbacks[N.CHANGE_PROPERTY]=l,this._commandCallbacks[N.CHANGE_CONTENT]=p,this._commandCallbacks[N.CHANGE_ATTRIBUTE]=f,this._commandCallbacks[N.ADD_CLASS]=d,this._commandCallbacks[N.REMOVE_CLASS]=g,this._commandCallbacks[N.SUBSCRIBE]=v,this._commandCallbacks[N.GL_SET_DRAW_OPTIONS]=m,this._commandCallbacks[N.GL_AMBIENT_LIGHT]=_,this._commandCallbacks[N.GL_LIGHT_POSITION]=y,this._commandCallbacks[N.GL_LIGHT_COLOR]=b,this._commandCallbacks[N.MATERIAL_INPUT]=w,this._commandCallbacks[N.GL_SET_GEOMETRY]=x,this._commandCallbacks[N.GL_UNIFORMS]=T,this._commandCallbacks[N.GL_BUFFER_DATA]=E,this._commandCallbacks[N.GL_CUTOUT_STATE]=I,this._commandCallbacks[N.GL_MESH_VISIBILITY]=A,this._commandCallbacks[N.GL_REMOVE_MESH]=C,this._commandCallbacks[N.PINHOLE_PROJECTION]=R,this._commandCallbacks[N.ORTHOGRAPHIC_PROJECTION]=S,this._commandCallbacks[N.CHANGE_VIEW_TRANSFORM]=O,this._commandCallbacks[N.PREVENT_DEFAULT]=i,this._commandCallbacks[N.ALLOW_DEFAULT]=o,this._commandCallbacks[N.READY]=s},r.prototype._initWebGLRenderer=function(){this._webGLRendererRootEl=document.createElement("canvas"),this._rootEl.appendChild(this._webGLRendererRootEl),this._webGLRenderer=new M(this._webGLRendererRootEl,this._compositor),this._webGLRenderer.updateSize(this._size)},r.prototype.getRootSize=function(){return[this._rootEl.offsetWidth,this._rootEl.offsetHeight]},r.prototype.checkInit=function(){this._initDOM&&(this._domRendererRootEl.style.display="block",this._initDOM=!1)},r.prototype.receive=function(t,e,n){var r=n,i=e[++r];for(this._domRenderer.loadPath(t),this._domRenderer.findTarget();null!=i;){if(i===N.WITH||i===N.TIME)return r-1;r=this._commandCallbacks[i](this,t,e,r)+1,i=e[r]}return r},r.prototype.getDOMRenderer=function(){return this._domRenderer},r.prototype.getWebGLRenderer=function(){return this._webGLRenderer},e.exports=r},{"../components/Camera":2,"../core/Commands":15,"../dom-renderers/DOMRenderer":30,"../webgl-renderers/WebGLRenderer":135}],88:[function(t,e,n){"use strict";function r(t,e,n){this._thread=t,this._compositor=e,this._renderLoop=n,this._renderLoop.update(this);var r=this;this._thread.onmessage=function(t){var e=t.data?t.data:t;if(e[0]===i.ENGINE)switch(e[1]){case i.START:r._engine.start();break;case i.STOP:r._engine.stop();break;default:console.error('Unknown ENGINE command "'+e[1]+'"')}else r._compositor.receiveCommands(e)},this._thread.onerror=function(t){console.error(t)}}var i=t("../core/Commands");r.prototype.getThread=function(){return this._thread},r.prototype.getCompositor=function(){return this._compositor},r.prototype.getEngine=function(){return this._renderLoop},r.prototype.getRenderLoop=function(){return this._renderLoop},r.prototype.update=function(t){this._thread.postMessage([i.FRAME,t]);var e=this._compositor.drawCommands();this._thread.postMessage(e),this._compositor.clearCommands()},e.exports=r},{"../core/Commands":15}],89:[function(t,e,n){"use strict";e.exports={Compositor:t("./Compositor"),Context:t("./Context"),UIManager:t("./UIManager"),injectCSS:t("./inject-css")}},{"./Compositor":86,"./Context":87,"./UIManager":88,"./inject-css":90}],90:[function(t,e,n){"use strict";function r(){if(!o)if(o=!0,document.createStyleSheet){var t=document.createStyleSheet();t.cssText=i}else{var e=document.getElementsByTagName("head")[0],n=document.createElement("style");n.styleSheet?n.styleSheet.cssText=i:n.appendChild(document.createTextNode(i)),(e?e:document.documentElement).appendChild(n)}}var i=".famous-dom-renderer {width:100%;height:100%;transform-style:preserve-3d;-webkit-transform-style:preserve-3d;}.famous-dom-element {-webkit-transform-origin:0% 0%;transform-origin:0% 0%;-webkit-backface-visibility:visible;backface-visibility:visible;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;-webkit-tap-highlight-color:transparent;pointer-events:auto;z-index:1;}.famous-dom-element-content,.famous-dom-element {position:absolute;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;}.famous-webgl-renderer {-webkit-transform:translateZ(1000000px);transform:translateZ(1000000px);pointer-events:none;position:absolute;z-index:1;top:0;width:100%;height:100%;}",o="undefined"==typeof document;e.exports=r},{}],91:[function(t,e,n){"use strict";var r={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t},inQuad:function(t){return t*t},outQuad:function(t){return-(t-=1)*t+1},inOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},inQuart:function(t){return t*t*t*t},outQuart:function(t){return-(--t*t*t*t-1)},inOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return--t*t*t*t*t+1},inOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},inSine:function(t){return-1*Math.cos(t*(Math.PI/2))+1},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},outExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t){return-(Math.sqrt(1-t*t)-1)},outCirc:function(t){return Math.sqrt(1- --t*t)},inOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t){var e=1.70158,n=0,r=1;return 0===t?0:1===t?1:(n||(n=.3),e=n/(2*Math.PI)*Math.asin(1/r),-(r*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n)))},outElastic:function(t){var e=1.70158,n=0,r=1;return 0===t?0:1===t?1:(n||(n=.3),e=n/(2*Math.PI)*Math.asin(1/r),r*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/n)+1)},inOutElastic:function(t){var e=1.70158,n=0,r=1;return 0===t?0:2===(t/=.5)?1:(n||(n=.3*1.5),e=n/(2*Math.PI)*Math.asin(1/r),1>t?-.5*r*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n):r*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n)*.5+1)},inBack:function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)},outBack:function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1},inOutBack:function(t,e){return void 0===e&&(e=1.70158),(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},inBounce:function(t){return 1-r.outBounce(1-t)},outBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},inOutBounce:function(t){return.5>t?.5*r.inBounce(2*t):.5*r.outBounce(2*t-1)+.5},flat:function(){return 0}};e.exports=r},{}],92:[function(t,e,n){"use strict";function r(t){this._queue=[],this._from=null,this._state=null,this._startedAt=null,this._pausedAt=null,null!=t&&this.from(t)}var i=t("./Curves"),o=t("../core/FamousEngine");r.Clock=o.getClock(),r.prototype.to=function(t,e,n,r,o){return e=null!=e&&e.constructor===String?i[e]:e,0===this._queue.length&&(this._startedAt=this.constructor.Clock.now(),this._pausedAt=null),this._queue.push(t,null!=e?e:i.linear,null!=n?n:100,r,o),this},r.prototype.from=function(t){return this._state=t,this._from=this._sync(null,this._state),this._queue.length=0,this._startedAt=this.constructor.Clock.now(),this._pausedAt=null,this},r.prototype.delay=function(t,e){var n=this._queue.length>0?this._queue[this._queue.length-5]:this._state;return this.to(n,i.flat,t,e)},r.prototype.override=function(t,e,n,r,o){return this._queue.length>0&&(null!=t&&(this._queue[0]=t),null!=e&&(this._queue[1]=e.constructor===String?i[e]:e),null!=n&&(this._queue[2]=n),null!=r&&(this._queue[3]=r),null!=o&&(this._queue[4]=o)),this},r.prototype._interpolate=function(t,e,n,r,i){if(n instanceof Object)if("slerp"===i){var o,s,a,u,h,c,l,p,f,d,g,v,m;if(o=e[0],s=e[1],a=e[2],u=e[3],h=n[0],c=n[1],l=n[2],p=n[3],1===r)return t[0]=h,t[1]=c,t[2]=l,t[3]=p,t;d=u*p+o*h+s*c+a*l,1-d>1e-5?(f=Math.acos(d),g=Math.sin(f),v=Math.sin((1-r)*f)/g,m=Math.sin(r*f)/g):(v=1-r,m=r),t[0]=o*v+h*m,t[1]=s*v+c*m,t[2]=a*v+l*m,t[3]=u*v+p*m}else if(n instanceof Array)for(var _=0,y=n.length;y>_;_++)t[_]=this._interpolate(t[_],e[_],n[_],r,i);else for(var b in n)t[b]=this._interpolate(t[b],e[b],n[b],r,i);else t=e+r*(n-e);return t},r.prototype._sync=function t(e,n){if("number"==typeof n)e=n;else if(n instanceof Array){null==e&&(e=[]);for(var r=0,i=n.length;i>r;r++)e[r]=t(e[r],n[r])}else if(n instanceof Object){null==e&&(e={});for(var o in n)e[o]=t(e[o],n[o])}return e},r.prototype.get=function(t){if(0===this._queue.length)return this._state;t=this._pausedAt?this._pausedAt:t,t=t?t:this.constructor.Clock.now();var e=(t-this._startedAt)/this._queue[2];this._state=this._interpolate(this._state,this._from,this._queue[0],this._queue[1](e>1?1:e),this._queue[4]);var n=this._state;if(e>=1){this._startedAt=this._startedAt+this._queue[2],this._from=this._sync(this._from,this._state),this._queue.shift(),this._queue.shift(),this._queue.shift();var r=this._queue.shift();this._queue.shift(),r&&r()}return e>1?this.get():n},r.prototype.isActive=function(){return this._queue.length>0},r.prototype.halt=function(){return this.from(this.get())},r.prototype.pause=function(){return this._pausedAt=this.constructor.Clock.now(),this},r.prototype.isPaused=function(){return!!this._pausedAt},r.prototype.resume=function(){var t=this._pausedAt-this._startedAt;return this._startedAt=this.constructor.Clock.now()-t,this._pausedAt=null,this},r.prototype.reset=function(t){return this.from(t)},r.prototype.set=function(t,e,n){return null==e?(this.from(t),n&&n()):this.to(t,e.curve,e.duration,n,e.method),this},e.exports=r},{"../core/FamousEngine":18,"./Curves":91}],93:[function(t,e,n){"use strict";e.exports={Curves:t("./Curves"),Transitionable:t("./Transitionable")}},{"./Curves":91,"./Transitionable":92}],94:[function(t,e,n){"use strict";function r(){this._events={}}r.prototype.on=function(t,e){this._events[t]||(this._events[t]=[]);var n=this._events[t];return n.push(e),function(){n.splice(n.indexOf(e),1)}},r.prototype.off=function(t,e){var n=this._events[t];return n&&n.splice(n.indexOf(e),1),this},r.prototype.trigger=function(t,e){var n=this._events[t];if(n)for(var r=0,i=n.length;i>r;r++)n[r](e);return this},e.exports=r},{}],95:[function(t,e,n){"use strict";function r(t,e,n){this._r=new i(0),this._g=new i(0),this._b=new i(0),this._opacity=new i(1),t&&this.set(t,e,n)}var i=t("../transitions/Transitionable");r.prototype.toString=function(){return"Color"},r.prototype.set=function(t,e,n){switch(r.determineType(t)){case"hex":return this.setHex(t,e,n);case"colorName":return this.setColor(t,e,n);case"instance":return this.changeTo(t,e,n);case"rgb":return this.setRGB(t[0],t[1],t[2],e,n)}return this},r.prototype.isActive=function(){return this._r.isActive()||this._g.isActive()||this._b.isActive()||this._opacity.isActive()},r.prototype.halt=function(){return this._r.halt(),this._g.halt(),this._b.halt(),this._opacity.halt(),this},r.prototype.changeTo=function(t,e,n){if(r.isColorInstance(t)){var i=t.getRGB();this.setRGB(i[0],i[1],i[2],e,n)}return this},r.prototype.setColor=function(t,e,n){return o[t]&&this.setHex(o[t],e,n),this},r.prototype.getColor=function(t){return r.isString(t)&&(t=t.toLowerCase()),"hex"===t?this.getHex():this.getRGB()},r.prototype.setR=function(t,e,n){return this._r.set(t,e,n),this},r.prototype.setG=function(t,e,n){return this._g.set(t,e,n),this},r.prototype.setB=function(t,e,n){return this._b.set(t,e,n),this},r.prototype.setOpacity=function(t,e,n){return this._opacity.set(t,e,n),this},r.prototype.setRGB=function(t,e,n,r,i){return this.setR(t,r),this.setG(e,r),this.setB(n,r,i),this},r.prototype.getR=function(){return this._r.get()},r.prototype.getG=function(){return this._g.get()},r.prototype.getB=function(){return this._b.get()},r.prototype.getOpacity=function(){return this._opacity.get()},r.prototype.getRGB=function(){return[this.getR(),this.getG(),this.getB()]},r.prototype.getNormalizedRGB=function(){var t=this.getR()/255,e=this.getG()/255,n=this.getB()/255;return[t,e,n]},r.prototype.getNormalizedRGBA=function(){var t=this.getR()/255,e=this.getG()/255,n=this.getB()/255,r=this.getOpacity();return[t,e,n,r]},r.prototype.getHex=function(){var t=r.toHex(this.getR()),e=r.toHex(this.getG()),n=r.toHex(this.getB());return"#"+t+e+n},r.prototype.setHex=function(t,e,n){if(t="#"===t.charAt(0)?t.substring(1,t.length):t,3===t.length){var r=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(r,function(t,e,n,r){return e+e+n+n+r+r})}var i=parseInt(t.substring(0,2),16),o=parseInt(t.substring(2,4),16),s=parseInt(t.substring(4,6),16);return this.setRGB(i,o,s,e,n),this},r.toHex=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e},r.determineType=function(t){return r.isColorInstance(t)?"instance":o[t]?"colorName":r.isHex(t)?"hex":Array.isArray(t)?"rgb":void 0},r.isString=function(t){return"string"==typeof t},r.isHex=function(t){return r.isString(t)?"#"===t[0]:!1},r.isColorInstance=function(t){return!!t.getColor};var o={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};e.exports=r},{"../transitions/Transitionable":92}],96:[function(t,e,n){"use strict";e.exports={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ENTER:13,LEFT_ARROW:37,RIGHT_ARROW:39,UP_ARROW:38,DOWN_ARROW:40,SPACE:32,SHIFT:16,TAB:9}},{}],97:[function(t,e,n){"use strict";function r(t,e){return function(){return 0!==t.length?t.pop():new e}}function i(t){return function(e){t.push(e)}}var o={};o.pools={},o.register=function(t,e){var n=this.pools[t]=[];this["request"+t]=r(n,e),this["free"+t]=i(n)},o.disposeOf=function(t){for(var e=this.pools[t],n=e.length;n--;)e.pop()},e.exports=o},{}],98:[function(t,e,n){"use strict";function r(t,e,n){return e>t?e:t>n?n:t}e.exports=r},{}],99:[function(t,e,n){"use strict";var r=function t(e){var n;if("object"==typeof e){n=e instanceof Array?[]:{};for(var r in e)if("object"==typeof e[r]&&null!==e[r])if(e[r]instanceof Array){n[r]=new Array(e[r].length);for(var i=0;i<e[r].length;i++)n[r][i]=t(e[r][i])}else n[r]=t(e[r]);else n[r]=e[r]}else n=e;return n};e.exports=r},{}],100:[function(t,e,n){"use strict";e.exports={CallbackStore:t("./CallbackStore"),clamp:t("./clamp"),clone:t("./clone"),Color:t("./Color"),KeyCodes:t("./KeyCodes"),keyValueToArrays:t("./keyValueToArrays"),loadURL:t("./loadURL"),ObjectManager:t("./ObjectManager"),strip:t("./strip"),vendorPrefix:t("./vendorPrefix")}},{"./CallbackStore":94,"./Color":95,"./KeyCodes":96,"./ObjectManager":97,"./clamp":98,"./clone":99,"./keyValueToArrays":101,"./loadURL":102,"./strip":103,"./vendorPrefix":104}],101:[function(t,e,n){"use strict";e.exports=function(t){var e=[],n=[],r=0;for(var i in t)t.hasOwnProperty(i)&&(e[r]=i,n[r]=t[i],r++);return{keys:e,values:n}}},{}],102:[function(t,e,n){"use strict";var r=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===this.readyState&&e&&e(this.responseText)},n.open("GET",t),n.send()};e.exports=r},{}],103:[function(t,e,n){"use strict";function r(t){switch(t){case null:case void 0:return t}switch(t.constructor){case Boolean:case Number:case String:return t;case Object:for(var e in t){var n=r(t[e],!0);t[e]=n}return t;default:return null}}e.exports=r},{}],104:[function(t,e,n){"use strict";function r(t){for(var e=0;e<i.length;e++){var n=i[e]+t;if(""===document.documentElement.style[n])return n}return t}var i=["","-ms-","-webkit-","-moz-","-o-"];e.exports=r},{}],105:[function(t,e,n){"use strict";function r(t){i.call(this,t),this.spec.dynamic=!0}var i=t("./Geometry");r.prototype.getLength=function(){return this.getVertexPositions().length},r.prototype.getVertexBuffer=function(t){if(!t)throw"getVertexBuffer requires a name";var e=this.spec.bufferNames.indexOf(t);if(~e)return this.spec.bufferValues[e];throw"buffer does not exist"},r.prototype.setVertexBuffer=function(t,e,n){var r=this.spec.bufferNames.indexOf(t);return-1===r&&(r=this.spec.bufferNames.push(t)-1),this.spec.bufferValues[r]=e||[],this.spec.bufferSpacings[r]=n||this.DEFAULT_BUFFER_SIZE,-1===this.spec.invalidations.indexOf(r)&&this.spec.invalidations.push(r),this},r.prototype.fromGeometry=function(t){for(var e=t.spec.bufferNames.length,n=0;e>n;n++)this.setVertexBuffer(t.spec.bufferNames[n],t.spec.bufferValues[n],t.spec.bufferSpacings[n]);return this},r.prototype.setVertexPositions=function(t){return this.setVertexBuffer("a_pos",t,3)},r.prototype.setNormals=function(t){return this.setVertexBuffer("a_normals",t,3)},r.prototype.setTextureCoords=function(t){return this.setVertexBuffer("a_texCoord",t,2)},r.prototype.setIndices=function(t){return this.setVertexBuffer("indices",t,1)},r.prototype.setDrawType=function(t){return this.spec.type=t.toUpperCase(),this},r.prototype.getVertexPositions=function(){return this.getVertexBuffer("a_pos")},r.prototype.getNormals=function(){return this.getVertexBuffer("a_normals")},r.prototype.getTextureCoords=function(){return this.getVertexBuffer("a_texCoord")},e.exports=r},{"./Geometry":106}],106:[function(t,e,n){"use strict";function r(t){if(this.options=t||{},this.DEFAULT_BUFFER_SIZE=3,this.spec={id:i++,dynamic:!1,type:this.options.type||"TRIANGLES",bufferNames:[],bufferValues:[],bufferSpacings:[],invalidations:[]},this.options.buffers)for(var e=this.options.buffers.length,n=0;e>n;)this.spec.bufferNames.push(this.options.buffers[n].name),this.spec.bufferValues.push(this.options.buffers[n].data),this.spec.bufferSpacings.push(this.options.buffers[n].size||this.DEFAULT_BUFFER_SIZE),this.spec.invalidations.push(n++)}var i=0;e.exports=r},{}],107:[function(t,e,n){"use strict";function r(t,e){return-(e+(t-e)/2)}function i(t,e){return 1/((t-e)/2)}var o=t("../math/Vec3"),s=t("../math/Vec2"),a=[new o,new o,new o,new s,new s],u={};u.generateParametric=function(t,e,n,r){var i,o,s,a,u=[],h=Math.PI/(t-1),c=r?Math.PI+h:Math.PI,l=[];for(i=0;t+1>i;i++)for(o=(0===i?1e-4:i)*Math.PI/t,a=0;e>a;a++)s=2*a*c/e,n(o,s,l),u.push(l[0],l[1],l[2]);var p,f=[],d=0;for(i=0;t>i;i++){for(a=0;e>a;a++)p=(a+1)%e,f.push(d+a,d+a+e,d+p),f.push(d+p,d+a+e,d+p+e);d+=e}return{vertices:u,indices:f}},u.computeNormals=function(t,e,n){var r,i,o,s,u,h,c,l,p,f,d=n||[],g=e.length/3;for(h=0;g>h;h++)i=3*e[3*h+0],r=3*e[3*h+1],o=3*e[3*h+2],a[0].set(t[r],t[r+1],t[r+2]),a[1].set(t[i],t[i+1],t[i+2]),a[2].set(t[o],t[o+1],t[o+2]),s=a[2].subtract(a[0]).cross(a[1].subtract(a[0])).normalize(),d[r+0]=(d[r+0]||0)+s.x,d[r+1]=(d[r+1]||0)+s.y,d[r+2]=(d[r+2]||0)+s.z,d[i+0]=(d[i+0]||0)+s.x,d[i+1]=(d[i+1]||0)+s.y,d[i+2]=(d[i+2]||0)+s.z,d[o+0]=(d[o+0]||0)+s.x,d[o+1]=(d[o+1]||0)+s.y,d[o+2]=(d[o+2]||0)+s.z;for(h=0;h<d.length;h+=3)for(c=d[h],l=d[h+1],p=d[h+2],f=Math.sqrt(c*c+l*l+p*p),u=0;3>u;u++)d[h+u]/=f;return d},u.subdivide=function(t,e,n){for(var r,i,u,h,c,l,p=t.length/3;p--;)r=t.slice(3*p,3*p+3),c=r.map(function(t){return new o(e[3*t],e[3*t+1],e[3*t+2])}),e.push.apply(e,o.scale(o.add(c[0],c[1],a[0]),.5,a[1]).toArray()),e.push.apply(e,o.scale(o.add(c[1],c[2],a[0]),.5,a[1]).toArray()),e.push.apply(e,o.scale(o.add(c[0],c[2],a[0]),.5,a[1]).toArray()),n&&(l=r.map(function(t){return new s(n[2*t],n[2*t+1])}),n.push.apply(n,s.scale(s.add(l[0],l[1],a[3]),.5,a[4]).toArray()),n.push.apply(n,s.scale(s.add(l[1],l[2],a[3]),.5,a[4]).toArray()),n.push.apply(n,s.scale(s.add(l[0],l[2],a[3]),.5,a[4]).toArray())),i=e.length-3,u=i+1,h=i+2,t.push(i,u,h),t.push(r[0],i,h),t.push(i,r[1],u),t[p]=h,t[p+1]=u,t[p+2]=r[2]},u.getUniqueFaces=function(t,e){for(var n,r=e.length/3,i=[];r--;)for(var o=0;3>o;o++)n=e[3*r+o],i[n]?(t.push(t[3*n],t[3*n+1],t[3*n+2]),e[3*r+o]=t.length/3-1):i[n]=!0},u.subdivideSpheroid=function(t,e){for(var n,r,i,s,u,h=e.length/3;h--;)r=e.slice(3*h,3*h+3),
n=r.map(function(e){return new o(t[3*e],t[3*e+1],t[3*e+2])}),t.push.apply(t,o.normalize(o.add(n[0],n[1],a[0]),a[1]).toArray()),t.push.apply(t,o.normalize(o.add(n[1],n[2],a[0]),a[1]).toArray()),t.push.apply(t,o.normalize(o.add(n[0],n[2],a[0]),a[1]).toArray()),i=t.length/3-3,s=i+1,u=i+2,e.push(i,s,u),e.push(r[0],i,u),e.push(i,r[1],s),e[3*h]=u,e[3*h+1]=s,e[3*h+2]=r[2]},u.getSpheroidNormals=function(t,e){e=e||[];for(var n,r=t.length/3,i=0;r>i;i++)n=new o(t[3*i+0],t[3*i+1],t[3*i+2]).normalize().toArray(),e[3*i+0]=n[0],e[3*i+1]=n[1],e[3*i+2]=n[2];return e},u.getSpheroidUV=function(t,e){e=e||[];for(var n,r=t.length/3,i=[],o=0;r>o;o++){n=a[0].set(t[3*o],t[3*o+1],t[3*o+2]).normalize().toArray();var s=this.getAzimuth(n),u=this.getAltitude(n);i[0]=.5*s/Math.PI+.5,i[1]=u/Math.PI+.5,e.push.apply(e,i)}return e},u.normalizeAll=function(t,e){e=e||[];for(var n=t.length/3,r=0;n>r;r++)Array.prototype.push.apply(e,new o(t[3*r],t[3*r+1],t[3*r+2]).normalize().toArray());return e},u.normalizeVertices=function(t,e){e=e||[];var n,s,a,u,h,c,l,p,f=t.length/3,d=[];for(p=0;f>p;p++)l=d[p]=new o(t[3*p],t[3*p+1],t[3*p+2]),(null==n||l.x<n)&&(n=l.x),(null==s||l.x>s)&&(s=l.x),(null==a||l.y<a)&&(a=l.y),(null==u||l.y>u)&&(u=l.y),(null==h||l.z<h)&&(h=l.z),(null==c||l.z>c)&&(c=l.z);var g=new o(r(s,n),r(u,a),r(c,h)),v=Math.min(i(s+g.x,n+g.x),i(u+g.y,a+g.y),i(c+g.z,h+g.z));for(p=0;p<d.length;p++)e.push.apply(e,d[p].add(g).scale(v).toArray());return e},u.getAzimuth=function(t){return Math.atan2(t[2],-t[0])},u.getAltitude=function(t){return Math.atan2(-t[1],Math.sqrt(t[0]*t[0]+t[2]*t[2]))},u.trianglesToLines=function(t,e){var n=t.length/3;e=e||[];var r;for(r=0;n>r;r++)e.push(t[3*r+0],t[3*r+1]),e.push(t[3*r+1],t[3*r+2]),e.push(t[3*r+2],t[3*r+0]);return e},u.addBackfaceTriangles=function(t,e){for(var n=e.length/3,r=0,i=e.length;i--;)e[i]>r&&(r=e[i]);for(r++,i=0;n>i;i++){var o=e[3*i],s=e[3*i+1],a=e[3*i+2];e.push(o+r,a+r,s+r)}var u=t.length;for(i=0;u>i;i++)t.push(t[i])},e.exports=u},{"../math/Vec2":49,"../math/Vec3":50}],108:[function(t,e,n){"use strict";function r(t,e){t=o(t);var n=t.split("\n"),r=[];e=e||{};for(var s,a,u,h,c,l,p=[],f=[],d=[],g=[],v=[],m=[],_=n.length,y=0;_>y;y++)l=n[y],c=n[y].trim().split(" "),-1!==l.indexOf("v ")?m.push([parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3])]):-1!==l.indexOf("vt ")?v.push([parseFloat(c[1]),parseFloat(c[2])]):-1!==l.indexOf("vn ")?g.push([parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3])]):-1!==l.indexOf("f ")?-1!==c[1].indexOf("//")?(s=c[1].split("//"),a=c[2].split("//"),u=c[3].split("//"),f.push([parseFloat(s[0])-1,parseFloat(a[0])-1,parseFloat(u[0])-1]),d.push([parseFloat(s[1])-1,parseFloat(a[1])-1,parseFloat(u[1])-1]),c[4]&&(h=c[4].split("//"),f.push([parseFloat(s[0])-1,parseFloat(u[0])-1,parseFloat(h[0])-1]),d.push([parseFloat(s[2])-1,parseFloat(u[2])-1,parseFloat(h[2])-1]))):-1!==c[1].indexOf("/")?(s=c[1].split("/"),a=c[2].split("/"),u=c[3].split("/"),f.push([parseFloat(s[0])-1,parseFloat(a[0])-1,parseFloat(u[0])-1]),p.push([parseFloat(s[1])-1,parseFloat(a[1])-1,parseFloat(u[1])-1]),d.push([parseFloat(s[2])-1,parseFloat(a[2])-1,parseFloat(u[2])-1]),c[4]&&(h=c[4].split("/"),f.push([parseFloat(s[0])-1,parseFloat(u[0])-1,parseFloat(h[0])-1]),p.push([parseFloat(s[1])-1,parseFloat(u[1])-1,parseFloat(h[1])-1]),d.push([parseFloat(s[2])-1,parseFloat(u[2])-1,parseFloat(h[2])-1]))):(f.push([parseFloat(c[1])-1,parseFloat(c[2])-1,parseFloat(c[3])-1]),p.push([parseFloat(c[1])-1,parseFloat(c[2])-1,parseFloat(c[3])-1]),d.push([parseFloat(c[1])-1,parseFloat(c[2])-1,parseFloat(c[3])-1]),c[4]&&(f.push([parseFloat(c[1])-1,parseFloat(c[3])-1,parseFloat(c[4])-1]),p.push([parseFloat(c[1])-1,parseFloat(c[3])-1,parseFloat(c[4])-1]),d.push([parseFloat(c[1])-1,parseFloat(c[3])-1,parseFloat(c[4])-1]))):-1!==l.indexOf("g ")&&(f.length&&r.push(i(m,g,v,f,d,p,e)),f.length=0,p.length=0,d.length=0);return r.push(i(m,g,v,f,d,p,e)),r}function i(t,e,n,r,i,o,u){var c=s(t,e,n,r,i,o);return c.vertices=a(c.vertices),c.normals=a(c.normals),c.texCoords=a(c.texCoords),c.indices=a(c.indices),u.normalize&&(c.vertices=h.normalizeVertices(c.vertices)),u.computeNormals&&(c.normals=h.computeNormals(c.vertices,c.indices)),{vertices:c.vertices,normals:c.normals,textureCoords:c.texCoords,indices:c.indices}}function o(t){return t.replace(/ +(?= )/g,"").replace(/\s+$/g,"")}function s(t,e,n,r,i,o){for(var s,a,u,h,c,l=[],p=[],f=[],d=[],g={},v=0,m=r.length,_=i.length,y=o.length,b=0;m>b;b++){d[b]=[],h=r[b].length;for(var w=0;h>w;w++)y&&(u=o[b][w]),_&&(a=i[b][w]),s=r[b][w],c=g[s+","+a+","+u],void 0===c&&(c=v++,p.push(t[s]),_&&l.push(e[a]),y&&f.push(n[u]),g[s+","+a+","+u]=c),d[b].push(c)}return{vertices:p,normals:l,texCoords:f,indices:d}}function a(t){for(var e=t.length,n=[],r=0;e>r;r++)n.push.apply(n,t[r]);return n}var u=t("../utilities/loadURL"),h=t("./GeometryHelper"),c={cached:{},requests:{},formatText:r};c.load=function(t,e,n){this.cached[t]?e(this.cached[t]):this.requests[t]?this.requests[t].push(e):(this.requests[t]=[e],u(t,this._onsuccess.bind(this,t,n)))},c._onsuccess=function(t,e,n){var i=r.call(this,n,e||{});this.cached[t]=i;for(var o=0;o<this.requests[t].length;o++)this.requests[t][o](i);this.requests[t]=null},e.exports=c},{"../utilities/loadURL":102,"./GeometryHelper":107}],109:[function(t,e,n){"use strict";e.exports={Box:t("./primitives/Box"),Circle:t("./primitives/Circle"),Cylinder:t("./primitives/Cylinder"),GeodesicSphere:t("./primitives/GeodesicSphere"),Icosahedron:t("./primitives/Icosahedron"),ParametricCone:t("./primitives/ParametricCone"),Plane:t("./primitives/Plane"),Sphere:t("./primitives/Sphere"),Tetrahedron:t("./primitives/Tetrahedron"),Torus:t("./primitives/Torus"),Triangle:t("./primitives/Triangle"),GeometryHelper:t("./GeometryHelper"),DynamicGeometry:t("./DynamicGeometry"),Geometry:t("./Geometry"),OBJLoader:t("./OBJLoader")}},{"./DynamicGeometry":105,"./Geometry":106,"./GeometryHelper":107,"./OBJLoader":108,"./primitives/Box":110,"./primitives/Circle":111,"./primitives/Cylinder":112,"./primitives/GeodesicSphere":113,"./primitives/Icosahedron":114,"./primitives/ParametricCone":115,"./primitives/Plane":116,"./primitives/Sphere":117,"./primitives/Tetrahedron":118,"./primitives/Torus":119,"./primitives/Triangle":120}],110:[function(t,e,n){"use strict";function r(t){return[2*(1&t)-1,(2&t)-1,(4&t)/2-1]}function i(t){t=t||{};var e,n,i,a,u,h=[],c=[],l=[],p=[];for(a=0;a<s.length;a++){for(e=s[a],i=4*a,u=0;4>u;u++){n=e[u];var f=r(n);h.push(f[0],f[1],f[2]),c.push(1&u,(2&u)/2),l.push(e[4],e[5],e[6])}p.push(i,i+1,i+2),p.push(i+2,i+1,i+3)}return new o({buffers:[{name:"a_pos",data:h},{name:"a_texCoord",data:c,size:2},{name:"a_normals",data:l},{name:"indices",data:p,size:1}]})}var o=t("../Geometry"),s=[[0,4,2,6,-1,0,0],[1,3,5,7,1,0,0],[0,1,4,5,0,-1,0],[2,6,3,7,0,1,0],[0,2,1,3,0,0,-1],[4,5,6,7,0,0,1]];e.exports=i},{"../Geometry":106}],111:[function(t,e,n){"use strict";function r(t){t=t||{};var e=t.detail||30,n=o(e,!0);t.backface!==!1&&a.addBackfaceTriangles(n.vertices,n.indices);var r=i(n.vertices),u=a.computeNormals(n.vertices,n.indices);return new s({buffers:[{name:"a_pos",data:n.vertices},{name:"a_texCoord",data:r,size:2},{name:"a_normals",data:u},{name:"indices",data:n.indices,size:1}]})}function i(t){for(var e=[],n=t.length/3,r=0;n>r;r++){var i=t[3*r],o=t[3*r+1];e.push(.5+.5*i,.5+.5*-o)}return e}function o(t){for(var e,n,r,i=[0,0,0],o=[],s=1,a=0;t+1>a;a++)e=a/t*Math.PI*2,n=Math.cos(e),r=Math.sin(e),i.push(n,r,0),a>0&&o.push(0,s,++s);return{vertices:i,indices:o}}var s=t("../Geometry"),a=t("../GeometryHelper");e.exports=r},{"../Geometry":106,"../GeometryHelper":107}],112:[function(t,e,n){"use strict";function r(t){t=t||{};var e,n=t.radius||1,s=t.detail||15;return e=o.generateParametric(s,s,r.generator.bind(null,n)),t.backface!==!1&&o.addBackfaceTriangles(e.vertices,e.indices),new i({buffers:[{name:"a_pos",data:e.vertices},{name:"a_texCoord",data:o.getSpheroidUV(e.vertices),size:2},{name:"a_normals",data:o.computeNormals(e.vertices,e.indices)},{name:"indices",data:e.indices,size:1}]})}var i=t("../Geometry"),o=t("../GeometryHelper");r.generator=function(t,e,n,r){r[1]=t*Math.sin(n),r[0]=t*Math.cos(n),r[2]=t*(-1+e/Math.PI*2)},e.exports=r},{"../Geometry":106,"../GeometryHelper":107}],113:[function(t,e,n){"use strict";function r(t){var e=.5*(1+Math.sqrt(5)),n=[-1,e,0,1,e,0,-1,-e,0,1,-e,0,0,-1,-e,0,1,-e,0,-1,e,0,1,e,e,0,1,e,0,-1,-e,0,1,-e,0,-1],r=[0,5,11,0,1,5,0,7,1,0,10,7,0,11,10,1,9,5,5,4,11,11,2,10,10,6,7,7,8,1,3,4,9,3,2,4,3,6,2,3,8,6,3,9,8,4,5,9,2,11,4,6,10,2,8,7,6,9,1,8];n=o.normalizeAll(n),t=t||{};for(var s=t.detail||3;--s;)o.subdivideSpheroid(n,r);o.getUniqueFaces(n,r);var a=o.computeNormals(n,r),u=o.getSpheroidUV(n);return new i({buffers:[{name:"a_pos",data:n},{name:"a_texCoord",data:u,size:2},{name:"a_normals",data:a},{name:"indices",data:r,size:1}]})}var i=t("../Geometry"),o=t("../GeometryHelper");e.exports=r},{"../Geometry":106,"../GeometryHelper":107}],114:[function(t,e,n){"use strict";function r(){var t=(1+Math.sqrt(5))/2,e=[-1,t,0,1,t,0,-1,-t,0,1,-t,0,0,-1,-t,0,1,-t,0,-1,t,0,1,t,t,0,1,t,0,-1,-t,0,1,-t,0,-1],n=[0,5,11,0,1,5,0,7,1,0,10,7,0,11,10,1,9,5,5,4,11,11,2,10,10,6,7,7,8,1,3,4,9,3,2,4,3,6,2,3,8,6,3,9,8,4,5,9,2,11,4,6,10,2,8,7,6,9,1,8];o.getUniqueFaces(e,n);var r=o.computeNormals(e,n),s=o.getSpheroidUV(e);return e=o.normalizeAll(e),new i({buffers:[{name:"a_pos",data:e},{name:"a_texCoord",data:s,size:2},{name:"a_normals",data:r},{name:"indices",data:n,size:1}]})}var i=t("../Geometry"),o=t("../GeometryHelper");e.exports=r},{"../Geometry":106,"../GeometryHelper":107}],115:[function(t,e,n){"use strict";function r(t){t=t||{};var e=t.detail||15,n=t.radius||1/Math.PI,s=o.generateParametric(e,e,r.generator.bind(null,n));return t.backface!==!1&&o.addBackfaceTriangles(s.vertices,s.indices),new i({buffers:[{name:"a_pos",data:s.vertices},{name:"a_texCoord",data:o.getSpheroidUV(s.vertices),size:2},{name:"a_normals",data:o.computeNormals(s.vertices,s.indices)},{name:"indices",data:s.indices,size:1}]})}var i=t("../Geometry"),o=t("../GeometryHelper");r.generator=function(t,e,n,r){r[0]=-t*e*Math.cos(n),r[1]=t*e*Math.sin(n),r[2]=-e/(Math.PI/2)+1},e.exports=r},{"../Geometry":106,"../GeometryHelper":107}],116:[function(t,e,n){"use strict";function r(t){t=t||{};for(var e,n=t.detailX||t.detail||1,r=t.detailY||t.detail||1,s=[],a=[],u=[],h=[],c=0;r>=c;c++)for(var l=c/r,p=0;n>=p;p++){var f=p/n;s.push(2*(f-.5),2*(l-.5),0),a.push(f,1-l),n>p&&r>c&&(e=p+c*(n+1),h.push(e,e+1,e+n+1),h.push(e+n+1,e+1,e+n+2))}if(t.backface!==!1){o.addBackfaceTriangles(s,h);var d=a.length;for(e=0;d>e;e++)a.push(a[e])}return u=o.computeNormals(s,h),new i({buffers:[{name:"a_pos",data:s},{name:"a_texCoord",data:a,size:2},{name:"a_normals",data:u},{name:"indices",data:h,size:1}]})}var i=t("../Geometry"),o=t("../GeometryHelper");e.exports=r},{"../Geometry":106,"../GeometryHelper":107}],117:[function(t,e,n){"use strict";function r(t){t=t||{};var e=t.detail||10,n=t.detailX||e,s=t.detailY||e,a=o.generateParametric(n,s,r.generator,!0);return new i({buffers:[{name:"a_pos",data:a.vertices},{name:"a_texCoord",data:o.getSpheroidUV(a.vertices),size:2},{name:"a_normals",data:o.getSpheroidNormals(a.vertices)},{name:"indices",data:a.indices,size:1}]})}var i=t("../Geometry"),o=t("../GeometryHelper");r.generator=function(t,e,n){var r=Math.sin(t)*Math.cos(e),i=Math.cos(t),o=-Math.sin(t)*Math.sin(e);n[0]=r,n[1]=i,n[2]=o},e.exports=r},{"../Geometry":106,"../GeometryHelper":107}],118:[function(t,e,n){"use strict";function r(t){var e,n,r=[],s=[],a=Math.sqrt(3),u=[1,-1,-1/a,-1,-1,-1/a,0,1,0,0,1,0,0,-1,a-1/a,1,-1,-1/a,0,1,0,-1,-1,-1/a,0,-1,a-1/a,0,-1,a-1/a,-1,-1,-1/a,1,-1,-1/a],h=[0,1,2,3,4,5,6,7,8,9,10,11];for(n=0;4>n;n++)r.push(0,0,.5,1,1,0);for(t=t||{};--e;)o.subdivide(h,u,r);return s=o.computeNormals(u,h),new i({buffers:[{name:"a_pos",data:u},{name:"a_texCoord",data:r,size:2},{name:"a_normals",data:s},{name:"indices",data:h,size:1}]})}var i=t("../Geometry"),o=t("../GeometryHelper");e.exports=r},{"../Geometry":106,"../GeometryHelper":107}],119:[function(t,e,n){"use strict";function r(t){t=t||{};var e=t.detail||30,n=t.holeRadius||.8,s=t.tubeRadius||.2,a=o.generateParametric(e,e,r.generator.bind(null,n,s));return new i({buffers:[{name:"a_pos",data:a.vertices},{name:"a_texCoord",data:o.getSpheroidUV(a.vertices),size:2},{name:"a_normals",data:o.computeNormals(a.vertices,a.indices)},{name:"indices",data:a.indices,size:1}]})}var i=t("../Geometry"),o=t("../GeometryHelper");r.generator=function(t,e,n,r,i){i[0]=(t+e*Math.cos(2*r))*Math.sin(2*n),i[1]=-(t+e*Math.cos(2*r))*Math.cos(2*n),i[2]=e*Math.sin(2*r)},e.exports=r},{"../Geometry":106,"../GeometryHelper":107}],120:[function(t,e,n){"use strict";function r(t){t=t||{};for(var e=t.detail||1,n=[],r=[0,0,.5,1,1,0],s=[0,1,2],a=[-1,-1,0,0,1,0,1,-1,0];--e;)o.subdivide(s,a,r);return t.backface!==!1&&o.addBackfaceTriangles(a,s),n=o.computeNormals(a,s),new i({buffers:[{name:"a_pos",data:a},{name:"a_texCoord",data:r,size:2},{name:"a_normals",data:n},{name:"indices",data:s,size:1}]})}var i=t("../Geometry"),o=t("../GeometryHelper");e.exports=r},{"../Geometry":106,"../GeometryHelper":107}],121:[function(t,e,n){"use strict";function r(t,e,n,o){o=o||{},this.name=t,this.chunk=e,this.inputs=n?Array.isArray(n)?n:[n]:[],this.uniforms=o.uniforms||{},this.varyings=o.varyings,this.attributes=o.attributes,o.texture&&(this.texture=o.texture.__isATexture__?o.texture:i.register(null,o.texture)),this._id=r.id++,this.invalidations=[],this.__isAMaterial__=!0}var i=t("./TextureRegistry"),o={},s={abs:{glsl:"abs(%1);",output:{4:4,3:3,2:2,1:1}},sign:{glsl:"sign(%1);",output:{4:4,3:3,2:2,1:1}},floor:{glsl:"floor(%1);",output:{4:4,3:3,2:2,1:1}},ceiling:{glsl:"ceil(%1);",output:{4:4,3:3,2:2,1:1}},mod:{glsl:"mod(%1, %2);"},min:{glsl:"min(%1, %2);",output:{4:4,3:3,2:2,1:1}},max:{glsl:"max(%1, %2);",output:{4:4,3:3,2:2,1:1}},clamp:{glsl:"clamp(%1, %2, %3);",output:{"4,1,1":4,"3,1,1":3,"2,1,1":2,"1,1,1":1}},mix:{glsl:"mix(%1, %2, %3);",output:{"4,4,1":4,"3,3,1":3,"2,2,1":2,"1,1,1":1}},step:{glsl:"step(%1, %2, %3);",output:{"1,1":1,"1,2":2,"1,3":3,"1,4":4}},smoothstep:{glsl:"smoothstep(%1);",output:{"1,1,1":1,"2,2,2":2,"3,3,3":3,"4,4,4":4}},fragCoord:{glsl:"gl_FragColor;",output:4},sin:{glsl:"sin(%1);",output:{1:1,2:2,3:3,4:4}},cos:{glsl:"cos(%1);",output:{1:1,2:2,3:3,4:4}},pow:{glsl:"pow(%1, %2);",output:{"1,1":1,"2,2":2,"3,3":3,"1,4":4}},sqrt:{glsl:"sqrt(%1);",output:{"1,1":1,"2,2":2,"3,3":3,"1,4":4}},time:{glsl:"time;",output:1},add:{glsl:"%1 + %2;",output:{"1,1":1,"2,2":2,"3,3":3,"4,4":4,"2,1":2,"3,1":3,"4,1":4}},subtract:{glsl:"%1 - %2;",output:{"1,1":1,"2,2":2,"3,3":3,"4,4":4,"2,1":2,"3,1":3,"4,1":4}},multiply:{glsl:"%1 * %2;",output:{"1,1":1,"2,2":2,"3,3":3,"4,4":4,"2,1":2,"3,1":3,"4,1":4}},normal:{glsl:"vec4((v_normal + 1.0) * 0.5, 1.0);",output:4},uv:{glsl:"v_textureCoordinate;",output:2},meshPosition:{glsl:"(v_position + 1.0) * 0.5;",output:3},normalize:{glsl:"normalize(%1)",output:{1:1,2:2,3:3,4:4}},dot:{glsl:"dot(%1, %2);",output:{"1,1":1,"2,2":1,"3,3":1,"4,4":1}},image:{glsl:"texture2D($TEXTURE, v_textureCoordinate);",output:4},constant:{glsl:"%1;"},parameter:{uniforms:{parameter:1},glsl:"parameter;"},vec3:{glsl:"vec3(%1);",output:3},vec2:{glsl:"vec2(%1);",output:2}};o.registerExpression=function(t,e){this[t]=function(n,i){return new r(t,e,n,i)}};for(var a in s)o.registerExpression(a,s[a]);r.id=2,r.prototype.setUniform=function(t,e){this.uniforms[t]=e,this.invalidations.push(t)},e.exports=o,o.Material=r,o.Texture=function(t){return"undefined"==typeof window?console.error("Texture constructor cannot be run inside of a worker"):o.image([],{texture:t})},o.Custom=function(t,e,n){return new r("custom",{glsl:t,output:1,uniforms:n||{}},e)}},{"./TextureRegistry":122}],122:[function(t,e,n){"use strict";var r={registry:{},textureIds:1};r.register=function(t,e,n){return t?(this.registry[t]={id:this.textureIds++,__isATexture__:!0,data:e,options:n},this.registry[t]):{id:this.textureIds++,data:e,__isATexture__:!0,options:n}},r.get=function(t){if(this.registry[t])return this.registry[t];throw'Texture "'+t+'" not found!'},e.exports=r},{}],123:[function(t,e,n){"use strict";e.exports={Material:t("./Material"),TextureRegistry:t("./TextureRegistry")}},{"./Material":121,"./TextureRegistry":122}],124:[function(t,e,n){"use strict";function r(t,e){this._node=t,this._changeQueue=[],this._initialized=!1,this._requestingUpdate=!1,this._inDraw=!1,this.value={geometry:a,drawOptions:null,color:null,expressions:{},flatShading:null,glossiness:null,positionOffset:null,normals:null},e&&this.setDrawOptions(e),this._id=t.addComponent(this)}var i=t("../webgl-geometries"),o=t("../core/Commands"),s=t("../core/TransformSystem"),a=new i.Plane;r.prototype.setDrawOptions=function(t){return this._changeQueue.push(o.GL_SET_DRAW_OPTIONS),this._changeQueue.push(t),this.value.drawOptions=t,this},r.prototype.getDrawOptions=function(){return this.value.drawOptions},r.prototype.setGeometry=function(t,e){if("string"==typeof t){if(!i[t])throw'Invalid geometry: "'+t+'".';t=new i[t](e)}if((this.value.geometry!==t||this._inDraw)&&(this._initialized&&(this._changeQueue.push(o.GL_SET_GEOMETRY),this._changeQueue.push(t.spec.id),this._changeQueue.push(t.spec.type),this._changeQueue.push(t.spec.dynamic)),this._requestUpdate(),this.value.geometry=t),this._initialized&&this._node){for(var n=this.value.geometry.spec.invalidations.length;n--;)this.value.geometry.spec.invalidations.pop(),this._changeQueue.push(o.GL_BUFFER_DATA),this._changeQueue.push(this.value.geometry.spec.id),this._changeQueue.push(this.value.geometry.spec.bufferNames[n]),this._changeQueue.push(this.value.geometry.spec.bufferValues[n]),this._changeQueue.push(this.value.geometry.spec.bufferSpacings[n]),this._changeQueue.push(this.value.geometry.spec.dynamic);n&&this._requestUpdate()}return this},r.prototype.getGeometry=function(){return this.value.geometry},r.prototype.setBaseColor=function(t){var e,n=t.__isAMaterial__,r=!!t.getNormalizedRGBA;return n?(this.value.color=null,this.value.expressions.baseColor=t,e=t):r&&(this.value.expressions.baseColor=null,this.value.color=t,e=t.getNormalizedRGBA()),this._initialized&&(t.__isAMaterial__?this._changeQueue.push(o.MATERIAL_INPUT):t.getNormalizedRGB&&this._changeQueue.push(o.GL_UNIFORMS),this._changeQueue.push("u_baseColor"),this._changeQueue.push(e)),this._requestUpdate(),this},r.prototype.getBaseColor=function(){return this.value.expressions.baseColor||this.value.color},r.prototype.setFlatShading=function(t){return(this._inDraw||this.value.flatShading!==t)&&(this.value.flatShading=t,this._initialized&&(this._changeQueue.push(o.GL_UNIFORMS),this._changeQueue.push("u_flatShading"),this._changeQueue.push(t?1:0)),this._requestUpdate()),this},r.prototype.getFlatShading=function(){return this.value.flatShading},r.prototype.setNormals=function(t){var e=t.__isAMaterial__;return e&&(this.value.expressions.normals=t),this._initialized&&(this._changeQueue.push(t.__isAMaterial__?o.MATERIAL_INPUT:o.GL_UNIFORMS),this._changeQueue.push("u_normals"),this._changeQueue.push(t)),this._requestUpdate(),this},r.prototype.getNormals=function(t){return this.value.expressions.normals},r.prototype.setGlossiness=function(t,e){var n=t.__isAMaterial__,r=!!t.getNormalizedRGB;return n?(this.value.glossiness=[null,null],this.value.expressions.glossiness=t):r&&(this.value.expressions.glossiness=null,this.value.glossiness=[t,e||20],t=t?t.getNormalizedRGB():[0,0,0],t.push(e||20)),this._initialized&&(this._changeQueue.push(t.__isAMaterial__?o.MATERIAL_INPUT:o.GL_UNIFORMS),this._changeQueue.push("u_glossiness"),this._changeQueue.push(t)),this._requestUpdate(),this},r.prototype.getGlossiness=function(){return this.value.expressions.glossiness||this.value.glossiness},r.prototype.setPositionOffset=function(t){var e,n=t.__isAMaterial__;return n?(this.value.expressions.positionOffset=t,e=t):(this.value.expressions.positionOffset=null,this.value.positionOffset=t,e=this.value.positionOffset),this._initialized&&(this._changeQueue.push(t.__isAMaterial__?o.MATERIAL_INPUT:o.GL_UNIFORMS),this._changeQueue.push("u_positionOffset"),this._changeQueue.push(e)),this._requestUpdate(),this},r.prototype.getPositionOffset=function(){return this.value.expressions.positionOffset||this.value.positionOffset},r.prototype.getMaterialExpressions=function(){return this.value.expressions},r.prototype.getValue=function(){return this.value},r.prototype._pushInvalidations=function(t){var e,n=this.value.expressions[t];if(n)for(var r=n.invalidations.length;r--;)e=n.invalidations.pop(),this._node.sendDrawCommand(o.GL_UNIFORMS),this._node.sendDrawCommand(e),this._node.sendDrawCommand(n.uniforms[e]);return this},r.prototype.onUpdate=function(){var t=this._node,e=this._changeQueue;if(t){if(t.sendDrawCommand(o.WITH),t.sendDrawCommand(t.getLocation()),this.value.color&&this.value.color.isActive()&&(this._node.sendDrawCommand(o.GL_UNIFORMS),this._node.sendDrawCommand("u_baseColor"),this._node.sendDrawCommand(this.value.color.getNormalizedRGBA()),this._node.requestUpdateOnNextTick(this._id)),this.value.glossiness&&this.value.glossiness[0]&&this.value.glossiness[0].isActive()){this._node.sendDrawCommand(o.GL_UNIFORMS),this._node.sendDrawCommand("u_glossiness");var n=this.value.glossiness[0].getNormalizedRGB();n.push(this.value.glossiness[1]),this._node.sendDrawCommand(n),this._node.requestUpdateOnNextTick(this._id)}else this._requestingUpdate=!1;this._pushInvalidations("baseColor"),this._pushInvalidations("positionOffset");for(var r=0;r<e.length;r++)t.sendDrawCommand(e[r]);e.length=0}},r.prototype.onMount=function(t,e){this._node=t,this._id=e,s.makeBreakPointAt(t.getLocation()),this.draw()},r.prototype.onDismount=function(){this._initialized=!1,this._changeQueue.push(o.GL_REMOVE_MESH),this._requestUpdate()},r.prototype.onShow=function(){this._changeQueue.push(o.GL_MESH_VISIBILITY,!0),this._requestUpdate()},r.prototype.onHide=function(){this._changeQueue.push(o.GL_MESH_VISIBILITY,!1),this._requestUpdate()},r.prototype.onTransformChange=function(t){this._initialized&&(this._changeQueue.push(o.GL_UNIFORMS),this._changeQueue.push("u_transform"),this._changeQueue.push(t.getWorldTransform())),this._requestUpdate()},r.prototype.onSizeChange=function(t,e,n){this._initialized&&(this._changeQueue.push(o.GL_UNIFORMS),this._changeQueue.push("u_size"),this._changeQueue.push([t,e,n])),this._requestUpdate()},r.prototype.onOpacityChange=function(t){this._initialized&&(this._changeQueue.push(o.GL_UNIFORMS),this._changeQueue.push("u_opacity"),this._changeQueue.push(t)),this._requestUpdate()},r.prototype.onAddUIEvent=function(t){},r.prototype._requestUpdate=function(){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0)},r.prototype.init=function(){this._initialized=!0,this.onTransformChange(s.get(this._node.getLocation()));var t=this._node.getSize();this.onSizeChange(t[0],t[1],t[2]),this.onOpacityChange(this._node.getOpacity()),this._requestUpdate()},r.prototype.draw=function(){this._inDraw=!0,this.init();var t=this.getValue();null!=t.geometry&&this.setGeometry(t.geometry),null!=t.color&&this.setBaseColor(t.color),null!=t.glossiness&&this.setGlossiness.apply(this,t.glossiness),null!=t.drawOptions&&this.setDrawOptions(t.drawOptions),null!=t.flatShading&&this.setFlatShading(t.flatShading),null!=t.expressions.normals&&this.setNormals(t.expressions.normals),null!=t.expressions.baseColor&&this.setBaseColor(t.expressions.baseColor),null!=t.expressions.glossiness&&this.setGlossiness(t.expressions.glossiness),null!=t.expressions.positionOffset&&this.setPositionOffset(t.expressions.positionOffset),this._inDraw=!1},e.exports=r},{"../core/Commands":15,"../core/TransformSystem":26,"../webgl-geometries":109}],125:[function(t,e,n){"use strict";e.exports={Mesh:t("./Mesh"),PointLight:t("./lights/PointLight"),AmbientLight:t("./lights/AmbientLight")}},{"./Mesh":124,"./lights/AmbientLight":126,"./lights/PointLight":128}],126:[function(t,e,n){"use strict";function r(t){i.call(this,t),this.commands.color=o.GL_AMBIENT_LIGHT}var i=t("./Light"),o=t("../../core/Commands");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r},{"../../core/Commands":15,"./Light":127}],127:[function(t,e,n){"use strict";function r(t){this._node=t,this._requestingUpdate=!1,this._color=null,this.queue=[],this.commands={color:i.GL_LIGHT_COLOR,position:i.GL_LIGHT_POSITION},this._id=t.addComponent(this)}var i=t("../../core/Commands");r.prototype.setColor=function(t){if(!t.getNormalizedRGB)return!1;this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._color=t,this.queue.push(this.commands.color);var e=this._color.getNormalizedRGB();return this.queue.push(e[0]),this.queue.push(e[1]),this.queue.push(e[2]),this},r.prototype.getColor=function(){return this._color},r.prototype.onUpdate=function(){var t=this._node.getLocation();this._node.sendDrawCommand(i.WITH).sendDrawCommand(t);for(var e=this.queue.length;e--;)this._node.sendDrawCommand(this.queue.shift());if(this._color&&this._color.isActive()){this._node.sendDrawCommand(this.commands.color);var n=this._color.getNormalizedRGB();this._node.sendDrawCommand(n[0]),this._node.sendDrawCommand(n[1]),this._node.sendDrawCommand(n[2]),this._node.requestUpdateOnNextTick(this._id)}else this._requestingUpdate=!1},e.exports=r},{"../../core/Commands":15}],128:[function(t,e,n){"use strict";function r(t){i.call(this,t)}var i=t("./Light"),o=t("../../core/TransformSystem");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.onMount=function(t,e){this._id=e,o.makeBreakPointAt(this._node.getLocation()),this.onTransformChange(o.get(this._node.getLocation()))},r.prototype.onTransformChange=function(t){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),t=t.getWorldTransform(),this.queue.push(this.commands.position),this.queue.push(t[12]),this.queue.push(t[13]),this.queue.push(t[14])},e.exports=r},{"../../core/TransformSystem":26,"./Light":127}],129:[function(t,e,n){"use strict";function r(t,e,n){this.buffer=null,this.target=t,this.type=e,this.data=[],this.gl=n}r.prototype.subData=function(){for(var t=this.gl,e=[],n=0,r=1e4;n<this.data.length;n+=r)e=Array.prototype.concat.apply(e,this.data.slice(n,n+r));this.buffer=this.buffer||t.createBuffer(),t.bindBuffer(this.target,this.buffer),t.bufferData(this.target,new this.type(e),t.STATIC_DRAW)},e.exports=r},{}],130:[function(t,e,n){"use strict";function r(t){this.gl=t,this.registry={},this._dynamicBuffers=[],this._staticBuffers=[],this._arrayBufferMax=3e4,this._elementBufferMax=3e4}var i="indices",o=t("./Buffer");r.prototype.allocate=function(t,e,n,r,s){var a,u,h,c,l=this.registry[t]||(this.registry[t]={keys:[],values:[],spacing:[],offset:[],length:[]}),p=l.keys.indexOf(e),f=e===i,d=!1,g=0;if(-1===p){if(p=l.keys.length,u=f?n.length:Math.floor(n.length/r),s)h=new o(f?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,f?Uint16Array:Float32Array,this.gl),this._dynamicBuffers.push({buffer:h,offset:n.length,isIndex:f});else{for(c=0;c<this._staticBuffers.length;c++)if(f===this._staticBuffers[c].isIndex&&(a=this._staticBuffers[c].offset+n.length,!f&&a<this._arrayBufferMax||f&&a<this._elementBufferMax)){h=this._staticBuffers[c].buffer,g=this._staticBuffers[c].offset,this._staticBuffers[c].offset+=n.length,d=!0;break}d||(h=new o(f?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,f?Uint16Array:Float32Array,this.gl),this._staticBuffers.push({buffer:h,offset:n.length,isIndex:f}))}l.keys.push(e),l.values.push(h),l.spacing.push(r),l.offset.push(g),l.length.push(u)}var v=n.length;for(c=0;v>c;c++)l.values[p].data[g+c]=n[c];l.values[p].subData()},e.exports=r},{"./Buffer":129}],131:[function(t,e,n){"use strict";function r(t,e){return function(){var n=t.apply(this,arguments);return e.apply(this,arguments),n}}function i(t,e){var n="body,html{background:#e3e3e3;font-family:monaco,monospace;font-size:14px;line-height:1.7em}#shaderReport{left:0;top:0;right:0;box-sizing:border-box;position:absolute;z-index:1000;color:#222;padding:15px;white-space:normal;list-style-type:none;margin:50px auto;max-width:1200px}#shaderReport li{background-color:#fff;margin:13px 0;box-shadow:0 1px 2px rgba(0,0,0,.15);padding:20px 30px;border-radius:2px;border-left:20px solid #e01111}span{color:#e01111;text-decoration:underline;font-weight:700}#shaderReport li p{padding:0;margin:0}#shaderReport li:nth-child(even){background-color:#f4f4f4}#shaderReport li p:first-child{margin-bottom:10px;color:#666}",r=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(r),r.textContent=n;var i=document.createElement("ul");i.setAttribute("id","shaderReport"),document.body.appendChild(i);for(var o,s=/ERROR: [\d]+:([\d]+): (.+)/gim,a=e.split("\n");null!=(o=s.exec(t));){o.index===s.lastIndex&&s.lastIndex++;var u=document.createElement("li"),h='<p><span>ERROR</span> "'+o[2]+'" in line '+o[1]+"</p>";h+="<p><b>"+a[o[1]-1].replace(/^[ \t]+/g,"")+"</b></p>",u.innerHTML=h,i.appendChild(u)}}e.exports=function(){return r(this.gl.compileShader,function(t){if(!this.getShaderParameter(t,this.COMPILE_STATUS)){var e=this.getShaderInfoLog(t),n=this.getShaderSource(t);i(e,n)}})}},{}],132:[function(t,e,n){"use strict";function r(t,e){this.gl=t,this.textureSlots=1,this.options=e||{},this.registeredMaterials={},this.flaggedUniforms=[],this.cachedUniforms={},this.uniformTypes=[],this.definitionVec4=[],this.definitionVec3=[],this.definitionFloat=[],this.applicationVec3=[],this.applicationVec4=[],this.applicationFloat=[],this.applicationVert=[],this.definitionVert=[],this.resetProgram()}var i=t("../utilities/clone"),o=t("../utilities/keyValueToArrays"),s=t("../webgl-shaders").vertex,a=t("../webgl-shaders").fragment,u=t("./Debug"),h=35633,c=35632,l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p="precision mediump float;\n",f={undefined:"float ",1:"float ",2:"vec2 ",3:"vec3 ",4:"vec4 ",16:"mat4 "},d={u_baseColor:"vec4",u_normals:"vert",u_glossiness:"vec4",u_positionOffset:"vert"},g={vert:1,vec3:2,vec4:4,float:8},v=o({u_perspective:l,u_view:l,u_resolution:[0,0,0],u_transform:l,u_size:[1,1,1],u_time:0,u_opacity:1,u_metalness:0,u_glossiness:[0,0,0,0],u_baseColor:[1,1,1,1],u_normals:[1,1,1],u_positionOffset:[0,0,0],u_lightPosition:l,u_lightColor:l,u_ambientLight:[0,0,0],u_flatShading:0,u_numLights:0}),m=o({a_pos:[0,0,0],a_texCoord:[0,0],a_normals:[0,0,0]}),_=o({v_textureCoordinate:[0,0],v_normal:[0,0,0],v_position:[0,0,0],v_eyeVector:[0,0,0]});r.prototype.registerMaterial=function(t,e){var n=e,r=d[t],i=g[r];if((this.registeredMaterials[e._id]&i)===i)return this;var o;for(o in n.uniforms)-1===v.keys.indexOf(o)&&(v.keys.push(o),v.values.push(n.uniforms[o]));for(o in n.varyings)-1===_.keys.indexOf(o)&&(_.keys.push(o),_.values.push(n.varyings[o]));for(o in n.attributes)-1===m.keys.indexOf(o)&&(m.keys.push(o),m.values.push(n.attributes[o]));return this.registeredMaterials[e._id]|=i,"float"===r&&(this.definitionFloat.push(e.defines),this.definitionFloat.push("float fa_"+e._id+"() {\n "+n.glsl+" \n}"),this.applicationFloat.push("if (int(abs(ID)) == "+e._id+") return fa_"+e._id+"();")),"vec3"===r&&(this.definitionVec3.push(e.defines),this.definitionVec3.push("vec3 fa_"+e._id+"() {\n "+n.glsl+" \n}"),this.applicationVec3.push("if (int(abs(ID.x)) == "+e._id+") return fa_"+e._id+"();")),"vec4"===r&&(this.definitionVec4.push(e.defines),this.definitionVec4.push("vec4 fa_"+e._id+"() {\n "+n.glsl+" \n}"),this.applicationVec4.push("if (int(abs(ID.x)) == "+e._id+") return fa_"+e._id+"();")),"vert"===r&&(this.definitionVert.push(e.defines),this.definitionVert.push("vec3 fa_"+e._id+"() {\n "+n.glsl+" \n}"),this.applicationVert.push("if (int(abs(ID.x)) == "+e._id+") return fa_"+e._id+"();")),this.resetProgram()},r.prototype.resetProgram=function(){var t,e,n,r,o,u,l=[p],d=[p];for(this.uniformLocations=[],this.attributeLocations={},this.uniformTypes={},this.attributeNames=i(m.keys),this.attributeValues=i(m.values),this.varyingNames=i(_.keys),this.varyingValues=i(_.values),this.uniformNames=i(v.keys),this.uniformValues=i(v.values),this.flaggedUniforms=[],
this.cachedUniforms={},d.push("uniform sampler2D u_textures[7];\n"),this.applicationVert.length&&l.push("uniform sampler2D u_textures[7];\n"),u=0;u<this.uniformNames.length;u++)r=this.uniformNames[u],o=this.uniformValues[u],l.push("uniform "+f[o.length]+r+";\n"),d.push("uniform "+f[o.length]+r+";\n");for(u=0;u<this.attributeNames.length;u++)r=this.attributeNames[u],o=this.attributeValues[u],l.push("attribute "+f[o.length]+r+";\n");for(u=0;u<this.varyingNames.length;u++)r=this.varyingNames[u],o=this.varyingValues[u],l.push("varying "+f[o.length]+r+";\n"),d.push("varying "+f[o.length]+r+";\n");e=l.join("")+s.replace("#vert_definitions",this.definitionVert.join("\n")).replace("#vert_applications",this.applicationVert.join("\n")),t=d.join("")+a.replace("#vec3_definitions",this.definitionVec3.join("\n")).replace("#vec3_applications",this.applicationVec3.join("\n")).replace("#vec4_definitions",this.definitionVec4.join("\n")).replace("#vec4_applications",this.applicationVec4.join("\n")).replace("#float_definitions",this.definitionFloat.join("\n")).replace("#float_applications",this.applicationFloat.join("\n")),n=this.gl.createProgram(),this.gl.attachShader(n,this.compileShader(this.gl.createShader(h),e)),this.gl.attachShader(n,this.compileShader(this.gl.createShader(c),t)),this.gl.linkProgram(n),this.gl.getProgramParameter(n,this.gl.LINK_STATUS)?(this.program=n,this.gl.useProgram(this.program)):(console.error("link error: "+this.gl.getProgramInfoLog(n)),this.program=null),this.setUniforms(this.uniformNames,this.uniformValues);var g=this.gl.getUniformLocation(this.program,"u_textures[0]");return this.gl.uniform1iv(g,[0,1,2,3,4,5,6]),this},r.prototype.uniformIsCached=function(t,e){if(null==this.cachedUniforms[t])return e.length?this.cachedUniforms[t]=new Float32Array(e):this.cachedUniforms[t]=e,!1;if(e.length){for(var n=e.length;n--;)if(e[n]!==this.cachedUniforms[t][n]){for(n=e.length;n--;)this.cachedUniforms[t][n]=e[n];return!1}}else if(this.cachedUniforms[t]!==e)return this.cachedUniforms[t]=e,!1;return!0},r.prototype.setUniforms=function(t,e){var n,r,i,o,s,a=this.gl;if(!this.program)return this;for(o=t.length,s=0;o>s;s++)if(i=t[s],r=e[s],n=this.uniformLocations[i],null!==n&&(void 0===n&&(n=a.getUniformLocation(this.program,i),this.uniformLocations[i]=n),!this.uniformIsCached(i,r)))switch(this.uniformTypes[i]||(this.uniformTypes[i]=this.getUniformTypeFromValue(r)),this.uniformTypes[i]){case"uniform4fv":a.uniform4fv(n,r);break;case"uniform3fv":a.uniform3fv(n,r);break;case"uniform2fv":a.uniform2fv(n,r);break;case"uniform1fv":a.uniform1fv(n,r);break;case"uniform1f":a.uniform1f(n,r);break;case"uniformMatrix3fv":a.uniformMatrix3fv(n,!1,r);break;case"uniformMatrix4fv":a.uniformMatrix4fv(n,!1,r)}return this},r.prototype.getUniformTypeFromValue=function(t){if(Array.isArray(t)||t instanceof Float32Array)switch(t.length){case 1:return"uniform1fv";case 2:return"uniform2fv";case 3:return"uniform3fv";case 4:return"uniform4fv";case 9:return"uniformMatrix3fv";case 16:return"uniformMatrix4fv"}else if(!isNaN(parseFloat(t))&&isFinite(t))return"uniform1f";throw'cant load uniform "'+name+'" with value:'+JSON.stringify(t)},r.prototype.compileShader=function(t,e){var n=1;return this.options.debug&&(this.gl.compileShader=u.call(this)),this.gl.shaderSource(t,e),this.gl.compileShader(t),this.gl.getShaderParameter(t,this.gl.COMPILE_STATUS)||(console.error("compile error: "+this.gl.getShaderInfoLog(t)),console.error("1: "+e.replace(/\n/g,function(){return"\n"+(n+=1)+": "}))),t},e.exports=r},{"../utilities/clone":99,"../utilities/keyValueToArrays":101,"../webgl-shaders":140,"./Debug":131}],133:[function(t,e,n){"use strict";function r(t,e){e=e||{},this.id=t.createTexture(),this.width=e.width||0,this.height=e.height||0,this.mipmap=e.mipmap,this.format=e.format||"RGBA",this.type=e.type||"UNSIGNED_BYTE",this.gl=t,this.bind(),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipYWebgl||!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlphaWebgl||!1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[e.magFilter]||t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[e.minFilter]||t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[e.wrapS]||t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[e.wrapT]||t.CLAMP_TO_EDGE)}r.prototype.bind=function(){return this.gl.bindTexture(this.gl.TEXTURE_2D,this.id),this},r.prototype.unbind=function(){return this.gl.bindTexture(this.gl.TEXTURE_2D,null),this},r.prototype.setImage=function(t){return this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl[this.format],this.gl[this.format],this.gl[this.type],t),this.mipmap&&this.gl.generateMipmap(this.gl.TEXTURE_2D),this},r.prototype.setArray=function(t){return this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl[this.format],this.width,this.height,0,this.gl[this.format],this.gl[this.type],t),this},r.prototype.readBack=function(t,e,n,r){var i,o=this.gl;t=t||0,e=e||0,n=n||this.width,r=r||this.height;var s=o.createFramebuffer();return o.bindFramebuffer(o.FRAMEBUFFER,s),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this.id,0),o.checkFramebufferStatus(o.FRAMEBUFFER)===o.FRAMEBUFFER_COMPLETE&&(i=new Uint8Array(n*r*4),o.readPixels(t,e,n,r,o.RGBA,o.UNSIGNED_BYTE,i)),i},e.exports=r},{}],134:[function(t,e,n){"use strict";function r(t){this.registry=[],this._needsResample=[],this._activeTexture=0,this._boundTexture=null,this._checkerboard=s(),this.gl=t}function i(t,e){var n=("string"==typeof t?new Image:t)||{};return n.crossOrigin="anonymous",n.src||(n.src=t),n.complete?e(n):n.onload=function(){e(n)},n}var o=t("./Texture"),s=t("./createCheckerboard");r.prototype.update=function(t){for(var e=this.registry.length,n=1;e>n;n++){var r=this.registry[n];r&&r.isLoaded&&r.resampleRate&&(!r.lastResample||t-r.lastResample>r.resampleRate)&&(this._needsResample[r.id]||(this._needsResample[r.id]=!0,r.lastResample=t))}},r.prototype.register=function(t,e){var n,r=this,s=t.data,a=t.id,u=t.options||{},h=this.registry[a];return h||(h=new o(this.gl,u),h.setImage(this._checkerboard),n=this.registry[a]={resampleRate:u.resampleRate||null,lastResample:null,isLoaded:!1,texture:h,source:s,id:a,slot:e},Array.isArray(s)||s instanceof Uint8Array||s instanceof Float32Array?(this.bindTexture(a),h.setArray(s),n.isLoaded=!0):s instanceof HTMLVideoElement?s.addEventListener("loadeddata",function(){r.bindTexture(a),h.setImage(s),n.isLoaded=!0,n.source=s}):"string"==typeof s&&i(s,function(t){r.bindTexture(a),h.setImage(t),n.isLoaded=!0,n.source=t})),a},r.prototype.bindTexture=function(t){var e=this.registry[t];this._activeTexture!==e.slot&&(this.gl.activeTexture(this.gl.TEXTURE0+e.slot),this._activeTexture=e.slot),this._boundTexture!==t&&(this._boundTexture=t,e.texture.bind()),this._needsResample[e.id]&&(e.texture.setImage(e.source),this._needsResample[e.id]=!1)},e.exports=r},{"./Texture":133,"./createCheckerboard":137}],135:[function(t,e,n){"use strict";function r(t,e){t.classList.add("famous-webgl-renderer"),this.canvas=t,this.compositor=e;var n=this.gl=this.getWebGLContext(this.canvas);n.clearColor(0,0,0,0),n.polygonOffset(.1,.1),n.enable(n.POLYGON_OFFSET_FILL),n.enable(n.DEPTH_TEST),n.enable(n.BLEND),n.depthFunc(n.LEQUAL),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),n.enable(n.CULL_FACE),n.cullFace(n.BACK),this.meshRegistry={},this.meshRegistryKeys=[],this.cutoutRegistry={},this.cutoutRegistryKeys=[],this.numLights=0,this.ambientLightColor=[0,0,0],this.lightRegistry={},this.lightRegistryKeys=[],this.lightPositions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.lightColors=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.textureManager=new u(n),this.texCache={},this.bufferRegistry=new o(n),this.program=new i(n,{debug:!0}),this.state={boundArrayBuffer:null,boundElementBuffer:null,lastDrawn:null,enabledAttributes:{},enabledAttributesKeys:[]},this.resolutionName=["u_resolution"],this.resolutionValues=[[0,0,0]],this.cachedSize=[],this.projectionTransform=[1,0,0,0,0,1,0,0,0,0,-1e-6,0,-1,1,0,1];var r=this.cutoutGeometry={spec:{id:-1,bufferValues:[[-1,-1,0,1,-1,0,-1,1,0,1,1,0]],bufferNames:["a_pos"],type:"TRIANGLE_STRIP"}};this.bufferRegistry.allocate(this.cutoutGeometry.spec.id,r.spec.bufferNames[0],r.spec.bufferValues[0],3)}var i=t("./Program"),o=t("./BufferRegistry"),s=t("./radixSort"),a=t("../utilities/keyValueToArrays"),u=t("./TextureManager"),h=t("./compileMaterial"),c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l=a({u_numLights:0,u_ambientLight:new Array(3),u_lightPosition:new Array(3),u_lightColor:new Array(3),u_perspective:new Array(16),u_time:0,u_view:new Array(16)});r.prototype.getWebGLContext=function(t){for(var e,n=["webgl","experimental-webgl","webkit-3d","moz-webgl"],r=0,i=n.length;i>r;r++){try{e=t.getContext(n[r])}catch(t){console.error("Error creating WebGL context: "+t.toString())}if(e)return e}return e?void 0:(console.error("Could not retrieve WebGL context. Please refer to https://www.khronos.org/webgl/ for requirements"),!1)},r.prototype.createLight=function(t){return this.numLights++,this.lightRegistryKeys.push(t),this.lightRegistry[t]={color:[0,0,0],position:[0,0,0]},this.lightRegistry[t]},r.prototype.createMesh=function(t){this.meshRegistryKeys.push(t);var e=a({u_opacity:1,u_transform:c,u_size:[0,0,0],u_baseColor:[.5,.5,.5,1],u_positionOffset:[0,0,0],u_normals:[0,0,0],u_flatShading:0,u_glossiness:[0,0,0,0]});return this.meshRegistry[t]={depth:null,uniformKeys:e.keys,uniformValues:e.values,buffers:{},geometry:null,drawType:null,textures:[],visible:!0},this.meshRegistry[t]},r.prototype.setCutoutState=function(t,e){var n=this.getOrSetCutout(t);n.visible=e},r.prototype.getOrSetCutout=function(t){if(this.cutoutRegistry[t])return this.cutoutRegistry[t];var e=a({u_opacity:0,u_transform:c.slice(),u_size:[0,0,0],u_origin:[0,0,0],u_baseColor:[0,0,0,1]});return this.cutoutRegistryKeys.push(t),this.cutoutRegistry[t]={uniformKeys:e.keys,uniformValues:e.values,geometry:this.cutoutGeometry.spec.id,drawType:this.cutoutGeometry.spec.type,visible:!0},this.cutoutRegistry[t]},r.prototype.setMeshVisibility=function(t,e){var n=this.meshRegistry[t]||this.createMesh(t);n.visible=e},r.prototype.removeMesh=function(t){var e=this.meshRegistryKeys.indexOf(t);this.meshRegistryKeys.splice(e,1),this.meshRegistry[t]=null},r.prototype.setCutoutUniform=function(t,e,n){var r=this.getOrSetCutout(t),i=r.uniformKeys.indexOf(e);if(n.length)for(var o=0,s=n.length;s>o;o++)r.uniformValues[i][o]=n[o];else r.uniformValues[i]=n},r.prototype.setMeshOptions=function(t,e){var n=this.meshRegistry[t]||this.createMesh(t);return n.options=e,this},r.prototype.setAmbientLightColor=function(t,e,n,r){return this.ambientLightColor[0]=e,this.ambientLightColor[1]=n,this.ambientLightColor[2]=r,this},r.prototype.setLightPosition=function(t,e,n,r){var i=this.lightRegistry[t]||this.createLight(t);return i.position[0]=e,i.position[1]=n,i.position[2]=r,this},r.prototype.setLightColor=function(t,e,n,r){var i=this.lightRegistry[t]||this.createLight(t);return i.color[0]=e,i.color[1]=n,i.color[2]=r,this},r.prototype.handleMaterialInput=function(t,e,n){var r=this.meshRegistry[t]||this.createMesh(t);n=h(n,r.textures.length),r.uniformValues[r.uniformKeys.indexOf(e)][0]=-n._id;for(var i=n.textures.length;i--;)r.textures.push(this.textureManager.register(n.textures[i],r.textures.length+i));return this.program.registerMaterial(e,n),this.updateSize()},r.prototype.setGeometry=function(t,e,n,r){var i=this.meshRegistry[t]||this.createMesh(t);return i.geometry=e,i.drawType=n,i.dynamic=r,this},r.prototype.setMeshUniform=function(t,e,n){var r=this.meshRegistry[t]||this.createMesh(t),i=r.uniformKeys.indexOf(e);-1===i?(r.uniformKeys.push(e),r.uniformValues.push(n)):r.uniformValues[i]=n},r.prototype.bufferData=function(t,e,n,r,i,o){return this.bufferRegistry.allocate(e,n,r,i,o),this},r.prototype.draw=function(t){var e=this.compositor.getTime();this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.textureManager.update(e),this.meshRegistryKeys=s(this.meshRegistryKeys,this.meshRegistry),this.setGlobalUniforms(t),this.drawCutouts(),this.drawMeshes()},r.prototype.drawMeshes=function(){for(var t,e,n=this.gl,r=0;r<this.meshRegistryKeys.length;r++)if(e=this.meshRegistry[this.meshRegistryKeys[r]],t=this.bufferRegistry.registry[e.geometry],e.visible&&(e.uniformValues[0]<1?(n.depthMask(!1),n.enable(n.BLEND)):(n.depthMask(!0),n.disable(n.BLEND)),t)){for(var i=e.textures.length;i--;)this.textureManager.bindTexture(e.textures[i]);e.options&&this.handleOptions(e.options,e),this.program.setUniforms(e.uniformKeys,e.uniformValues),this.drawBuffers(t,e.drawType,e.geometry),e.options&&this.resetOptions(e.options)}},r.prototype.drawCutouts=function(){var t,e,n=this.cutoutRegistryKeys.length;if(n){this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!0);for(var r=0;n>r;r++)t=this.cutoutRegistry[this.cutoutRegistryKeys[r]],e=this.bufferRegistry.registry[t.geometry],t.visible&&(this.program.setUniforms(t.uniformKeys,t.uniformValues),this.drawBuffers(e,t.drawType,t.geometry));this.gl.enable(this.gl.CULL_FACE)}},r.prototype.setGlobalUniforms=function(t){for(var e,n,r=0,i=this.lightRegistryKeys.length;i>r;r++)e=this.lightRegistry[this.lightRegistryKeys[r]],n=4*r,this.lightPositions[0+n]=e.position[0],this.lightPositions[1+n]=e.position[1],this.lightPositions[2+n]=e.position[2],this.lightColors[0+n]=e.color[0],this.lightColors[1+n]=e.color[1],this.lightColors[2+n]=e.color[2];l.values[0]=this.numLights,l.values[1]=this.ambientLightColor,l.values[2]=this.lightPositions,l.values[3]=this.lightColors,this.projectionTransform[0]=1/(.5*this.cachedSize[0]),this.projectionTransform[5]=-1/(.5*this.cachedSize[1]),this.projectionTransform[11]=t.perspectiveTransform[11],l.values[4]=this.projectionTransform,l.values[5]=.001*this.compositor.getTime(),l.values[6]=t.viewTransform,this.program.setUniforms(l.keys,l.values)},r.prototype.drawBuffers=function(t,e,n){var r,i,o,s,a,u,h,c,l=this.gl,p=0;for(u=t.keys.length,c=0;u>c;c++)r=t.keys[c],"indices"!==r?(i=this.program.attributeLocations[r],-1!==i&&(void 0!==i||(i=l.getAttribLocation(this.program.program,r),this.program.attributeLocations[r]=i,-1!==i))&&(this.state.enabledAttributes[r]||(l.enableVertexAttribArray(i),this.state.enabledAttributes[r]=!0,this.state.enabledAttributesKeys.push(r)),a=t.values[c],o=t.spacing[c],s=t.offset[c],p=t.length[c],this.state.boundArrayBuffer!==a&&(l.bindBuffer(a.target,a.buffer),this.state.boundArrayBuffer=a),this.state.lastDrawn!==n&&l.vertexAttribPointer(i,o,l.FLOAT,l.FALSE,0,4*s))):h=c;var f=this.state.enabledAttributesKeys.length;for(c=0;f>c;c++){var d=this.state.enabledAttributesKeys[c];this.state.enabledAttributes[d]&&-1===t.keys.indexOf(d)&&(l.disableVertexAttribArray(this.program.attributeLocations[d]),this.state.enabledAttributes[d]=!1)}p&&(void 0!==h?(a=t.values[h],s=t.offset[h],o=t.spacing[h],p=t.length[h],this.state.boundElementBuffer!==a&&(l.bindBuffer(a.target,a.buffer),this.state.boundElementBuffer=a),l.drawElements(l[e],p,l.UNSIGNED_SHORT,2*s)):l.drawArrays(l[e],0,p)),this.state.lastDrawn=n},r.prototype.updateSize=function(t){if(t){var e=window.devicePixelRatio||1,n=~~(t[0]*e),r=~~(t[1]*e);this.canvas.width=n,this.canvas.height=r,this.gl.viewport(0,0,n,r),this.cachedSize[0]=t[0],this.cachedSize[1]=t[1],this.cachedSize[2]=t[0]>t[1]?t[0]:t[1],this.resolutionValues[0]=this.cachedSize}return this.program.setUniforms(this.resolutionName,this.resolutionValues),this},r.prototype.handleOptions=function(t,e){var n=this.gl;t&&(t.blending&&n.enable(n.BLEND),"double"===t.side&&(this.gl.cullFace(this.gl.FRONT),this.drawBuffers(this.bufferRegistry.registry[e.geometry],e.drawType,e.geometry),this.gl.cullFace(this.gl.BACK)),"back"===t.side&&n.cullFace(n.FRONT))},r.prototype.resetOptions=function(t){var e=this.gl;t&&(t.blending&&e.disable(e.BLEND),"back"===t.side&&e.cullFace(e.BACK))},e.exports=r},{"../utilities/keyValueToArrays":101,"./BufferRegistry":130,"./Program":132,"./TextureManager":134,"./compileMaterial":136,"./radixSort":139}],136:[function(t,e,n){"use strict";function r(t,e){var n="",r={},h={},l={},p=[],f=[];return i(t,function(t,i){if(t.chunk){var d=c[o(t)],g=a(t),v=s(t.chunk.glsl,t.inputs,f.length+e);n+=d+g+" = "+v+"\n ",t.uniforms&&u(r,t.uniforms),t.varyings&&u(h,t.varyings),t.attributes&&u(l,t.attributes),t.chunk.defines&&p.push(t.chunk.defines),t.texture&&f.push(t.texture)}}),{_id:t._id,glsl:n+"return "+a(t)+";",defines:p.join("\n"),uniforms:r,varyings:h,attributes:l,textures:f}}function i(t,e){for(var n=t.inputs,r=n&&n.length,o=-1;++o<r;)i(n[o],e);return e(t),t}function o(t){if("number"==typeof t)return 1;if(Array.isArray(t))return t.length;var e=t.chunk.output;if("number"==typeof e)return e;var n=t.inputs.map(function(t){return o(t)}).join(",");return e[n]}function s(t,e,n){return t.replace(/%\d/g,function(t){return a(e[t[1]-1])}).replace(/\$TEXTURE/,"u_textures["+n+"]")}function a(t){return Array.isArray(t)?h(t):"object"==typeof t?"fa_"+t._id:t.toFixed(6)}function u(t,e){for(var n in e)t[n]=e[n]}function h(t){var e=t.length;return"vec"+e+"("+t.join(",")+")"}var c={1:"float ",2:"vec2 ",3:"vec3 ",4:"vec4 "};e.exports=r},{}],137:[function(t,e,n){"use strict";function r(){var t=document.createElement("canvas").getContext("2d");t.canvas.width=t.canvas.height=128;for(var e=0;e<t.canvas.height;e+=16)for(var n=0;n<t.canvas.width;n+=16)t.fillStyle=16&(n^e)?"#FFF":"#DDD",t.fillRect(n,e,16,16);return t.canvas}e.exports=r},{}],138:[function(t,e,n){"use strict";e.exports={Buffer:t("./Buffer"),BufferRegistry:t("./BufferRegistry"),createCheckerboard:t("./createCheckerboard"),Program:t("./Program"),WebGLRenderer:t("./WebGLRenderer"),Texture:t("./Texture")}},{"./Buffer":129,"./BufferRegistry":130,"./Program":132,"./Texture":133,"./WebGLRenderer":135,"./createCheckerboard":137}],139:[function(t,e,n){"use strict";function r(t,e,n){var r=t[n],i=e[r];return(i.depth?i.depth:e[r].uniformValues[1][14])+m}function i(t,e,n,r){var i=t[n];return e[i].depth=a(r)-m,i}function o(t,e,n){e[t[n]].depth=null}function s(t){return y[0]=t,b[0]}function a(t){return b[0]=t,y[0]}function u(t,e){var n,a,u,f,m,_,y,b,w,x,T,E=0,I=[];for(g=32/h+.999999999999999|0,n=0,f=c*g;f>n;n++)p[n]=0;for(n=0,f=t.length;f>n;n++){for(m=s(r(t,e,n)),m^=m>>31|2147483648,a=0,u=0;v>a;a+=c,u+=h)p[a+(m>>>u&l)]++;p[a+(m>>>u&d)]++}for(a=0;v>=a;a+=c)for(b=a,w=0;a+c>b;b++)x=p[b]+w,p[b]=w-1,w=x;if(--g){for(n=0,f=t.length;f>n;n++)m=s(r(t,e,n)),I[++p[m&l]]=i(t,e,n,m^=m>>31|2147483648);for(y=I,I=t,t=y;++E<g;){for(n=0,f=t.length,_=E*c,T=E*h;f>n;n++)m=s(r(t,e,n)),I[++p[_+(m>>>T&l)]]=t[n];y=I,I=t,t=y}}for(n=0,f=t.length,_=E*c,T=E*h;f>n;n++)m=s(r(t,e,n)),I[++p[_+(m>>>T&d)]]=i(t,e,n,m^(~m>>31|2147483648)),o(t,e,n);return I}var h=11,c=1<<h,l=c-1,p=new Array(c*Math.ceil(64/h)),f=1<<31%h,d=(f<<1)-1,g=32/h+.999999999999999|0,v=c*(g-1),m=Math.pow(20,6),_=new ArrayBuffer(4),y=new Float32Array(_,0,1),b=new Int32Array(_,0,1);e.exports=u},{}],140:[function(t,e,n){"use strict";var r={vertex:'#define GLSLIFY 1\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * Calculates transpose inverse matrix from transform\n * \n * @method random\n * @private\n *\n *\n */\n\n\nmat3 getNormalMatrix_1_0(in mat4 t) {\n   mat3 matNorm;\n   mat4 a = t;\n\n   float a00 = a[0][0], a01 = a[0][1], a02 = a[0][2], a03 = a[0][3],\n   a10 = a[1][0], a11 = a[1][1], a12 = a[1][2], a13 = a[1][3],\n   a20 = a[2][0], a21 = a[2][1], a22 = a[2][2], a23 = a[2][3],\n   a30 = a[3][0], a31 = a[3][1], a32 = a[3][2], a33 = a[3][3],\n   b00 = a00 * a11 - a01 * a10,\n   b01 = a00 * a12 - a02 * a10,\n   b02 = a00 * a13 - a03 * a10,\n   b03 = a01 * a12 - a02 * a11,\n   b04 = a01 * a13 - a03 * a11,\n   b05 = a02 * a13 - a03 * a12,\n   b06 = a20 * a31 - a21 * a30,\n   b07 = a20 * a32 - a22 * a30,\n   b08 = a20 * a33 - a23 * a30,\n   b09 = a21 * a32 - a22 * a31,\n   b10 = a21 * a33 - a23 * a31,\n   b11 = a22 * a33 - a23 * a32,\n\n   det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n   det = 1.0 / det;\n\n   matNorm[0][0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n   matNorm[0][1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n   matNorm[0][2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n\n   matNorm[1][0] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n   matNorm[1][1] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n   matNorm[1][2] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n\n   matNorm[2][0] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n   matNorm[2][1] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n   matNorm[2][2] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n\n   return matNorm;\n}\n\n\n\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * Calculates a matrix that creates the identity when multiplied by m\n * \n * @method inverse\n * @private\n *\n *\n */\n\n\nfloat inverse_2_1(float m) {\n    return 1.0 / m;\n}\n\nmat2 inverse_2_1(mat2 m) {\n    return mat2(m[1][1],-m[0][1],\n               -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse_2_1(mat3 m) {\n    float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n    float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n    float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n    float b01 =  a22 * a11 - a12 * a21;\n    float b11 = -a22 * a10 + a12 * a20;\n    float b21 =  a21 * a10 - a11 * a20;\n\n    float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n    return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n                b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n                b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse_2_1(mat4 m) {\n    float\n        a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n        a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n        a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n        a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n        b00 = a00 * a11 - a01 * a10,\n        b01 = a00 * a12 - a02 * a10,\n        b02 = a00 * a13 - a03 * a10,\n        b03 = a01 * a12 - a02 * a11,\n        b04 = a01 * a13 - a03 * a11,\n        b05 = a02 * a13 - a03 * a12,\n        b06 = a20 * a31 - a21 * a30,\n        b07 = a20 * a32 - a22 * a30,\n        b08 = a20 * a33 - a23 * a30,\n        b09 = a21 * a32 - a22 * a31,\n        b10 = a21 * a33 - a23 * a31,\n        b11 = a22 * a33 - a23 * a32,\n\n        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n    return mat4(\n        a11 * b11 - a12 * b10 + a13 * b09,\n        a02 * b10 - a01 * b11 - a03 * b09,\n        a31 * b05 - a32 * b04 + a33 * b03,\n        a22 * b04 - a21 * b05 - a23 * b03,\n        a12 * b08 - a10 * b11 - a13 * b07,\n        a00 * b11 - a02 * b08 + a03 * b07,\n        a32 * b02 - a30 * b05 - a33 * b01,\n        a20 * b05 - a22 * b02 + a23 * b01,\n        a10 * b10 - a11 * b08 + a13 * b06,\n        a01 * b08 - a00 * b10 - a03 * b06,\n        a30 * b04 - a31 * b02 + a33 * b00,\n        a21 * b02 - a20 * b04 - a23 * b00,\n        a11 * b07 - a10 * b09 - a12 * b06,\n        a00 * b09 - a01 * b07 + a02 * b06,\n        a31 * b01 - a30 * b03 - a32 * b00,\n        a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\n\n\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * Reflects a matrix over its main diagonal.\n * \n * @method transpose\n * @private\n *\n *\n */\n\n\nfloat transpose_3_2(float m) {\n    return m;\n}\n\nmat2 transpose_3_2(mat2 m) {\n    return mat2(m[0][0], m[1][0],\n                m[0][1], m[1][1]);\n}\n\nmat3 transpose_3_2(mat3 m) {\n    return mat3(m[0][0], m[1][0], m[2][0],\n                m[0][1], m[1][1], m[2][1],\n                m[0][2], m[1][2], m[2][2]);\n}\n\nmat4 transpose_3_2(mat4 m) {\n    return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\n                m[0][1], m[1][1], m[2][1], m[3][1],\n                m[0][2], m[1][2], m[2][2], m[3][2],\n                m[0][3], m[1][3], m[2][3], m[3][3]);\n}\n\n\n\n\n/**\n * Converts vertex from modelspace to screenspace using transform\n * information from context.\n *\n * @method applyTransform\n * @private\n *\n *\n */\n\nvec4 applyTransform(vec4 pos) {\n    //TODO: move this multiplication to application code. \n\n    /**\n     * Currently multiplied in the vertex shader to avoid consuming the complexity of holding an additional\n     * transform as state on the mesh object in WebGLRenderer. Multiplies the object\'s transformation from object space\n     * to world space with its transformation from world space to eye space.\n     */\n    mat4 MVMatrix = u_view * u_transform;\n\n    //TODO: move the origin, sizeScale and y axis inversion to application code in order to amortize redundant per-vertex calculations.\n\n    /**\n     * The transform uniform should be changed to the result of the transformation chain:\n     *\n     * view * modelTransform * invertYAxis * sizeScale * origin\n     *\n     * which could be simplified to:\n     *\n     * view * modelTransform * convertToDOMSpace\n     *\n     * where convertToDOMSpace represents the transform matrix:\n     *\n     *                           size.x 0       0       size.x \n     *                           0      -size.y 0       size.y\n     *                           0      0       1       0\n     *                           0      0       0       1\n     *\n     */\n\n    /**\n     * Assuming a unit volume, moves the object space origin [0, 0, 0] to the "top left" [1, -1, 0], the DOM space origin.\n     * Later in the transformation chain, the projection transform negates the rigidbody translation.\n     * Equivalent to (but much faster than) multiplying a translation matrix "origin"\n     *\n     *                           1 0 0 1 \n     *                           0 1 0 -1\n     *                           0 0 1 0\n     *                           0 0 0 1\n     *\n     * in the transform chain: projection * view * modelTransform * invertYAxis * sizeScale * origin * positionVector.\n     */\n    pos.x += 1.0;\n    pos.y -= 1.0;\n\n    /**\n     * Assuming a unit volume, scales an object to the amount of pixels in the size uniform vector\'s specified dimensions.\n     * Later in the transformation chain, the projection transform transforms the point into clip space by scaling\n     * by the inverse of the canvas\' resolution.\n     * Equivalent to (but much faster than) multiplying a scale matrix "sizeScale"\n     *\n     *                           size.x 0      0      0 \n     *                           0      size.y 0      0\n     *                           0      0      size.z 0\n     *                           0      0      0      1\n     *\n     * in the transform chain: projection * view * modelTransform * invertYAxis * sizeScale * origin * positionVector.\n     */\n    pos.xyz *= u_size * 0.5;\n\n    /**\n     * Inverts the object space\'s y axis in order to match DOM space conventions. \n     * Later in the transformation chain, the projection transform reinverts the y axis to convert to clip space.\n     * Equivalent to (but much faster than) multiplying a scale matrix "invertYAxis"\n     *\n     *                           1 0 0 0 \n     *                           0 -1 0 0\n     *                           0 0 1 0\n     *                           0 0 0 1\n     *\n     * in the transform chain: projection * view * modelTransform * invertYAxis * sizeScale * origin * positionVector.\n     */\n    pos.y *= -1.0;\n\n    /**\n     * Exporting the vertex\'s position as a varying, in DOM space, to be used for lighting calculations. This has to be in DOM space\n     * since light position and direction is derived from the scene graph, calculated in DOM space.\n     */\n\n    v_position = (MVMatrix * pos).xyz;\n\n    /**\n    * Exporting the eye vector (a vector from the center of the screen) as a varying, to be used for lighting calculations.\n    * In clip space deriving the eye vector is a matter of simply taking the inverse of the position, as the position is a vector\n    * from the center of the screen. However, since our points are represented in DOM space,\n    * the position is a vector from the top left corner of the screen, so some additional math is needed (specifically, subtracting\n    * the position from the center of the screen, i.e. half the resolution of the canvas).\n    */\n\n    v_eyeVector = (u_resolution * 0.5) - v_position;\n\n    /**\n     * Transforming the position (currently represented in dom space) into view space (with our dom space view transform)\n     * and then projecting the point into raster both by applying a perspective transformation and converting to clip space\n     * (the perspective matrix is a combination of both transformations, therefore it\'s probably more apt to refer to it as a\n     * projection transform).\n     */\n\n    pos = u_perspective * MVMatrix * pos;\n\n    return pos;\n}\n\n/**\n * Placeholder for positionOffset chunks to be templated in.\n * Used for mesh deformation.\n *\n * @method calculateOffset\n * @private\n *\n *\n */\n#vert_definitions\nvec3 calculateOffset(vec3 ID) {\n    #vert_applications\n    return vec3(0.0);\n}\n\n/**\n * Writes the position of the vertex onto the screen.\n * Passes texture coordinate and normal attributes as varyings\n * and passes the position attribute through position pipeline.\n *\n * @method main\n * @private\n *\n *\n */\nvoid main() {\n    v_textureCoordinate = a_texCoord;\n    vec3 invertedNormals = a_normals + (u_normals.x < 0.0 ? calculateOffset(u_normals) * 2.0 - 1.0 : vec3(0.0));\n    invertedNormals.y *= -1.0;\n    v_normal = transpose_3_2(mat3(inverse_2_1(u_transform))) * invertedNormals;\n    vec3 offsetPos = a_pos + calculateOffset(u_positionOffset);\n    gl_Position = applyTransform(vec4(offsetPos, 1.0));\n}\n',
fragment:'#define GLSLIFY 1\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * Placeholder for fragmentShader  chunks to be templated in.\n * Used for normal mapping, gloss mapping and colors.\n * \n * @method applyMaterial\n * @private\n *\n *\n */\n\n#float_definitions\nfloat applyMaterial_1_0(float ID) {\n    #float_applications\n    return 1.;\n}\n\n#vec3_definitions\nvec3 applyMaterial_1_0(vec3 ID) {\n    #vec3_applications\n    return vec3(0);\n}\n\n#vec4_definitions\nvec4 applyMaterial_1_0(vec4 ID) {\n    #vec4_applications\n\n    return vec4(0);\n}\n\n\n\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * Calculates the intensity of light on a surface.\n *\n * @method applyLight\n * @private\n *\n */\nvec4 applyLight_2_1(in vec4 baseColor, in vec3 normal, in vec4 glossiness, int numLights, vec3 ambientColor, vec3 eyeVector, mat4 lightPosition, mat4 lightColor, vec3 v_position) {\n    vec3 diffuse = vec3(0.0);\n    bool hasGlossiness = glossiness.a > 0.0;\n    bool hasSpecularColor = length(glossiness.rgb) > 0.0;\n\n    for(int i = 0; i < 4; i++) {\n        if (i >= numLights) break;\n        vec3 lightDirection = normalize(lightPosition[i].xyz - v_position);\n        float lambertian = max(dot(lightDirection, normal), 0.0);\n\n        if (lambertian > 0.0) {\n            diffuse += lightColor[i].rgb * baseColor.rgb * lambertian;\n            if (hasGlossiness) {\n                vec3 halfVector = normalize(lightDirection + eyeVector);\n                float specularWeight = pow(max(dot(halfVector, normal), 0.0), glossiness.a);\n                vec3 specularColor = hasSpecularColor ? glossiness.rgb : lightColor[i].rgb;\n                diffuse += specularColor * specularWeight * lambertian;\n            }\n        }\n\n    }\n\n    return vec4(ambientColor + diffuse, baseColor.a);\n}\n\n\n\n\n\n/**\n * Writes the color of the pixel onto the screen\n *\n * @method main\n * @private\n *\n *\n */\nvoid main() {\n    vec4 material = u_baseColor.r >= 0.0 ? u_baseColor : applyMaterial_1_0(u_baseColor);\n\n    /**\n     * Apply lights only if flat shading is false\n     * and at least one light is added to the scene\n     */\n    bool lightsEnabled = (u_flatShading == 0.0) && (u_numLights > 0.0 || length(u_ambientLight) > 0.0);\n\n    vec3 normal = normalize(v_normal);\n    vec4 glossiness = u_glossiness.x < 0.0 ? applyMaterial_1_0(u_glossiness) : u_glossiness;\n\n    vec4 color = lightsEnabled ?\n    applyLight_2_1(material, normalize(v_normal), glossiness,\n               int(u_numLights),\n               u_ambientLight * u_baseColor.rgb,\n               normalize(v_eyeVector),\n               u_lightPosition,\n               u_lightColor,   \n               v_position)\n    : material;\n\n    gl_FragColor = color;\n    gl_FragColor.a *= u_opacity;   \n}\n'};e.exports=r},{}],141:[function(t,e,n){var r=t("lodash");e.exports=r.merge(t("./lib/hash"),t("./lib/lodash"),t("./lib/log"),t("./lib/object"),t("./lib/space"),t("./lib/string"),t("./lib/type"),t("./lib/verbiage"))},{"./lib/hash":142,"./lib/lodash":143,"./lib/log":144,"./lib/object":145,"./lib/space":146,"./lib/string":147,"./lib/type":148,"./lib/verbiage":149,lodash:151}],142:[function(t,e,n){(function(){var n,r,i,o,s,a,u;for(r=t("jssha"),n=function(t,e){var n,i,o;if(!e)throw"No algorithm specified";if(n=null!=(o=e.match(/^sha-?(\d+)$/i))?o[1]:void 0,!n)throw"Unknown algorithm '"+e+"'";return e="SHA-"+n,i=new r(t,"TEXT"),i.getHash(e,"HEX")},null==e.exports&&(e.exports={}),u=[1,224,256,384,512],o=function(t){var r;return r="sha"+t,e.exports[r]=function(t){return n(t,r)}},s=0,a=u.length;a>s;s++)i=u[s],o(i);e.exports.hash=n}).call(this)},{jssha:150}],143:[function(t,e,n){(function(){var n,r;r=t("./object").snake_case_keys,n=r(t("lodash")),e.exports={lodash_snake_case:n}}).call(this)},{"./object":145,lodash:151}],144:[function(t,e,n){(function(){var n,r,i,o,s,a,u,h,c=[].slice;h=t("./type").type,i=function(){var t,e,n,r,i;for(e=1<=arguments.length?c.call(arguments,0):[],i=[],n=0,r=e.length;r>n;n++)t=e[n],i.push(console.log(t));return i},n=function(){var t,e,n,r,i;for(e=1<=arguments.length?c.call(arguments,0):[],i=[],n=0,r=e.length;r>n;n++)t=e[n],i.push(console.error(t));return i},o=a=function(){var t,e,n,r,o;for(e=1<=arguments.length?c.call(arguments,0):[],o=[],n=0,r=e.length;r>n;n++)t=e[n],o.push(i(u(t)));return o},u=function(t){var e;return"array"===(e=h(t))||"object"===e?t=s(t):t},s=function(t){return r(t,null,4)},r=function(){var t,e;t=arguments[0],e=2<=arguments.length?c.call(arguments,1):[];try{return JSON.stringify.apply(JSON,[t].concat(c.call(e)))}catch(e){return t}},e.exports={err:n,log:i,plog:a,p:o,pretty:u,json:r,pjson:s}}).call(this)},{"./type":148}],145:[function(t,e,n){(function(){var n,r,i={}.hasOwnProperty;r=t("lodash"),n=function(t){var e,n,o;n={};for(e in t)i.call(t,e)&&(o=t[e],n[r.snakeCase(e)]=o);return n},e.exports={snake_case_keys:n}}).call(this)},{lodash:151}],146:[function(t,e,n){(function(){var t,n,r;n=function(t,e){return{x:Math.cos(e)*t,y:Math.sin(e)*t}},t=function(t,e,n,i){return Math.sqrt(r(e-t)+r(i-n))},r=function(t){return t*t},e.exports={distance:t,move:n}}).call(this)},{}],147:[function(t,e,n){(function(){var n,r;r=t("lodash"),n=function(t,e){return r.trim(t.toLowerCase())===r.trim(e.toLowerCase())},e.exports={similar:n}}).call(this)},{lodash:151}],148:[function(t,e,n){(function(){var t;t=function(t){var e;return e={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Function]":"function","[object Null]":"null","[object Number]":"number","[object RegExp]":"regexp","[object String]":"string","[object Undefined]":"undefined"},e[Object.prototype.toString.call(t)]||"object"},e.exports={type:t}}).call(this)},{}],149:[function(t,e,n){(function(){var n,r,i,o,s,a,u,h,c;h=t("./type").type,c=t("./log"),i=c.log,o=c.p,n=function(t,e){return null==e&&(e="    "),i(r(t,e))},r=function(t,e){var n,r;return null==e&&(e="    "),r=function(){var r,i,o,s;for(o=t.split("\n"),s=[],r=0,i=o.length;i>r;r++)n=o[r],s.push(""+e+n);return s}(),r.join("\n")},a=function(t,e){var n,r;if(null==e&&(e=8),"string"!==h(t))throw"expected string, got "+t;return r="[0-9a-f]{"+e+"}",n=[128,160,256,384,512].map(function(t){return"[0-9a-f]{"+(t/4-e)+"}"}).join("|"),t.replace(RegExp("\\b("+r+")("+n+")\\b","g"),"$1")},u=function(t){var e,n,r,o,s;for(o=t.split("\n"),s=[],n=0,r=o.length;r>n;n++)e=o[n],s.push(i(e.trim()));return s},s=function(t){return"'"+t+"'"},e.exports={code:n,indent:r,quote:s,sane:a,say:u}}).call(this)},{"./log":144,"./type":148}],150:[function(t,e,n){"use strict";!function(t){function r(t,e,n){var r=0,i=[0],f="",d=null,f=n||"UTF8";if("UTF8"!==f&&"UTF16BE"!==f&&"UTF16LE"!==f)throw"encoding must be UTF8, UTF16BE, or UTF16LE";if("HEX"===e){if(0!==t.length%2)throw"srcString of HEX type must be in byte increments";d=s(t),r=d.binLen,i=d.value}else if("TEXT"===e||"ASCII"===e)d=o(t,f),r=d.binLen,i=d.value;else if("B64"===e)d=u(t),r=d.binLen,i=d.value;else{if("BYTES"!==e)throw"inputFormat must be HEX, TEXT, ASCII, B64, or BYTES";d=a(t),r=d.binLen,i=d.value}this.getHash=function(t,e,n,o){var s,a=null,u=i.slice(),f=r;if(3===arguments.length?"number"!=typeof n&&(o=n,n=1):2===arguments.length&&(n=1),n!==parseInt(n,10)||1>n)throw"numRounds must a integer >= 1";switch(e){case"HEX":a=h;break;case"B64":a=c;break;case"BYTES":a=l;break;default:throw"format must be HEX, B64, or BYTES"}if("SHA-1"===t)for(s=0;n>s;s+=1)u=D(u,f),f=160;else if("SHA-224"===t)for(s=0;n>s;s+=1)u=U(u,f,t),f=224;else if("SHA-256"===t)for(s=0;n>s;s+=1)u=U(u,f,t),f=256;else if("SHA-384"===t)for(s=0;n>s;s+=1)u=U(u,f,t),f=384;else{if("SHA-512"!==t)throw"Chosen SHA variant is not supported";for(s=0;n>s;s+=1)u=U(u,f,t),f=512}return a(u,p(o))},this.getHMAC=function(t,e,n,d,g){var v,m,_,y,b=[],w=[];switch(v=null,d){case"HEX":d=h;break;case"B64":d=c;break;case"BYTES":d=l;break;default:throw"outputFormat must be HEX, B64, or BYTES"}if("SHA-1"===n)m=64,y=160;else if("SHA-224"===n)m=64,y=224;else if("SHA-256"===n)m=64,y=256;else if("SHA-384"===n)m=128,y=384;else{if("SHA-512"!==n)throw"Chosen SHA variant is not supported";m=128,y=512}if("HEX"===e)v=s(t),_=v.binLen,v=v.value;else if("TEXT"===e||"ASCII"===e)v=o(t,f),_=v.binLen,v=v.value;else if("B64"===e)v=u(t),_=v.binLen,v=v.value;else{if("BYTES"!==e)throw"inputFormat must be HEX, TEXT, ASCII, B64, or BYTES";v=a(t),_=v.binLen,v=v.value}if(t=8*m,e=m/4-1,_/8>m){for(v="SHA-1"===n?D(v,_):U(v,_,n);v.length<=e;)v.push(0);v[e]&=4294967040}else if(m>_/8){for(;v.length<=e;)v.push(0);v[e]&=4294967040}for(m=0;e>=m;m+=1)b[m]=909522486^v[m],w[m]=1549556828^v[m];return n="SHA-1"===n?D(w.concat(D(b.concat(i),t+r)),t+y):U(w.concat(U(b.concat(i),t+r,n)),t+y,n),d(n,p(g))}}function i(t,e){this.a=t,this.b=e}function o(t,e){var n,r,i,o,s=[],a=[],u=0;if("UTF8"===e)for(r=0;r<t.length;r+=1)for(n=t.charCodeAt(r),a=[],128>n?a.push(n):2048>n?(a.push(192|n>>>6),a.push(128|63&n)):55296>n||n>=57344?a.push(224|n>>>12,128|n>>>6&63,128|63&n):(r+=1,n=65536+((1023&n)<<10|1023&t.charCodeAt(r)),a.push(240|n>>>18,128|n>>>12&63,128|n>>>6&63,128|63&n)),i=0;i<a.length;i+=1){for(o=u>>>2;s.length<=o;)s.push(0);s[o]|=a[i]<<24-u%4*8,u+=1}else if("UTF16BE"===e||"UTF16LE"===e)for(r=0;r<t.length;r+=1){for(n=t.charCodeAt(r),"UTF16LE"===e&&(i=255&n,n=i<<8|n>>8),o=u>>>2;s.length<=o;)s.push(0);s[o]|=n<<16-u%4*8,u+=2}return{value:s,binLen:8*u}}function s(t){var e,n,r,i=[],o=t.length;if(0!==o%2)throw"String of HEX type must be in byte increments";for(e=0;o>e;e+=2){if(n=parseInt(t.substr(e,2),16),isNaN(n))throw"String of HEX type contains invalid characters";for(r=e>>>3;i.length<=r;)i.push(0);i[e>>>3]|=n<<24-e%8*4}return{value:i,binLen:4*o}}function a(t){var e,n,r,i=[];for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),r=n>>>2,i.length<=r&&i.push(0),i[r]|=e<<24-n%4*8;return{value:i,binLen:8*t.length}}function u(t){var e,n,r,i,o,s=[],a=0;if(-1===t.search(/^[a-zA-Z0-9=+\/]+$/))throw"Invalid character in base-64 string";if(n=t.indexOf("="),t=t.replace(/\=/g,""),-1!==n&&n<t.length)throw"Invalid '=' found in base-64 string";for(n=0;n<t.length;n+=4){for(o=t.substr(n,4),r=i=0;r<o.length;r+=1)e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(o[r]),i|=e<<18-6*r;for(r=0;r<o.length-1;r+=1){for(e=a>>>2;s.length<=e;)s.push(0);s[e]|=(i>>>16-8*r&255)<<24-a%4*8,a+=1}}return{value:s,binLen:8*a}}function h(t,e){var n,r,i="",o=4*t.length;for(n=0;o>n;n+=1)r=t[n>>>2]>>>8*(3-n%4),i+="0123456789abcdef".charAt(r>>>4&15)+"0123456789abcdef".charAt(15&r);return e.outputUpper?i.toUpperCase():i}function c(t,e){var n,r,i,o="",s=4*t.length;for(n=0;s>n;n+=3)for(i=n+1>>>2,r=t.length<=i?0:t[i],i=n+2>>>2,i=t.length<=i?0:t[i],i=(t[n>>>2]>>>8*(3-n%4)&255)<<16|(r>>>8*(3-(n+1)%4)&255)<<8|i>>>8*(3-(n+2)%4)&255,r=0;4>r;r+=1)o+=8*n+6*r<=32*t.length?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>>6*(3-r)&63):e.b64Pad;return o}function l(t){var e,n,r="",i=4*t.length;for(e=0;i>e;e+=1)n=t[e>>>2]>>>8*(3-e%4)&255,r+=String.fromCharCode(n);return r}function p(t){var e={outputUpper:!1,b64Pad:"="};try{t.hasOwnProperty("outputUpper")&&(e.outputUpper=t.outputUpper),t.hasOwnProperty("b64Pad")&&(e.b64Pad=t.b64Pad)}catch(t){}if("boolean"!=typeof e.outputUpper)throw"Invalid outputUpper formatting option";if("string"!=typeof e.b64Pad)throw"Invalid b64Pad formatting option";return e}function f(t,e){return t<<e|t>>>32-e}function d(t,e){return t>>>e|t<<32-e}function g(t,e){var n=null,n=new i(t.a,t.b);return n=32>=e?new i(n.a>>>e|n.b<<32-e&4294967295,n.b>>>e|n.a<<32-e&4294967295):new i(n.b>>>e-32|n.a<<64-e&4294967295,n.a>>>e-32|n.b<<64-e&4294967295)}function v(t,e){var n=null;return n=32>=e?new i(t.a>>>e,t.b>>>e|t.a<<32-e&4294967295):new i(0,t.a>>>e-32)}function m(t,e,n){return t&e^~t&n}function _(t,e,n){return new i(t.a&e.a^~t.a&n.a,t.b&e.b^~t.b&n.b)}function y(t,e,n){return t&e^t&n^e&n}function b(t,e,n){return new i(t.a&e.a^t.a&n.a^e.a&n.a,t.b&e.b^t.b&n.b^e.b&n.b)}function w(t){return d(t,2)^d(t,13)^d(t,22)}function x(t){var e=g(t,28),n=g(t,34);return t=g(t,39),new i(e.a^n.a^t.a,e.b^n.b^t.b)}function T(t){return d(t,6)^d(t,11)^d(t,25)}function E(t){var e=g(t,14),n=g(t,18);return t=g(t,41),new i(e.a^n.a^t.a,e.b^n.b^t.b)}function I(t){return d(t,7)^d(t,18)^t>>>3}function A(t){var e=g(t,1),n=g(t,8);return t=v(t,7),new i(e.a^n.a^t.a,e.b^n.b^t.b)}function C(t){return d(t,17)^d(t,19)^t>>>10}function R(t){var e=g(t,19),n=g(t,61);return t=v(t,6),new i(e.a^n.a^t.a,e.b^n.b^t.b)}function S(t,e){var n=(65535&t)+(65535&e);return((t>>>16)+(e>>>16)+(n>>>16)&65535)<<16|65535&n}function O(t,e,n,r){var i=(65535&t)+(65535&e)+(65535&n)+(65535&r);return((t>>>16)+(e>>>16)+(n>>>16)+(r>>>16)+(i>>>16)&65535)<<16|65535&i}function M(t,e,n,r,i){var o=(65535&t)+(65535&e)+(65535&n)+(65535&r)+(65535&i);return((t>>>16)+(e>>>16)+(n>>>16)+(r>>>16)+(i>>>16)+(o>>>16)&65535)<<16|65535&o}function z(t,e){var n,r,o;return n=(65535&t.b)+(65535&e.b),r=(t.b>>>16)+(e.b>>>16)+(n>>>16),o=(65535&r)<<16|65535&n,n=(65535&t.a)+(65535&e.a)+(r>>>16),r=(t.a>>>16)+(e.a>>>16)+(n>>>16),new i((65535&r)<<16|65535&n,o)}function L(t,e,n,r){var o,s,a;return o=(65535&t.b)+(65535&e.b)+(65535&n.b)+(65535&r.b),s=(t.b>>>16)+(e.b>>>16)+(n.b>>>16)+(r.b>>>16)+(o>>>16),a=(65535&s)<<16|65535&o,o=(65535&t.a)+(65535&e.a)+(65535&n.a)+(65535&r.a)+(s>>>16),s=(t.a>>>16)+(e.a>>>16)+(n.a>>>16)+(r.a>>>16)+(o>>>16),new i((65535&s)<<16|65535&o,a)}function N(t,e,n,r,o){var s,a,u;return s=(65535&t.b)+(65535&e.b)+(65535&n.b)+(65535&r.b)+(65535&o.b),a=(t.b>>>16)+(e.b>>>16)+(n.b>>>16)+(r.b>>>16)+(o.b>>>16)+(s>>>16),u=(65535&a)<<16|65535&s,s=(65535&t.a)+(65535&e.a)+(65535&n.a)+(65535&r.a)+(65535&o.a)+(a>>>16),a=(t.a>>>16)+(e.a>>>16)+(n.a>>>16)+(r.a>>>16)+(o.a>>>16)+(s>>>16),new i((65535&a)<<16|65535&s,u)}function D(t,e){var n,r,i,o,s,a,u,h,c,l=[],p=[1732584193,4023233417,2562383102,271733878,3285377520];for(n=(e+65>>>9<<4)+15;t.length<=n;)t.push(0);for(t[e>>>5]|=128<<24-e%32,t[n]=e,c=t.length,u=0;c>u;u+=16){for(n=p[0],r=p[1],i=p[2],o=p[3],s=p[4],h=0;80>h;h+=1)l[h]=16>h?t[h+u]:f(l[h-3]^l[h-8]^l[h-14]^l[h-16],1),a=20>h?M(f(n,5),r&i^~r&o,s,1518500249,l[h]):40>h?M(f(n,5),r^i^o,s,1859775393,l[h]):60>h?M(f(n,5),y(r,i,o),s,2400959708,l[h]):M(f(n,5),r^i^o,s,3395469782,l[h]),s=o,o=i,i=f(r,30),r=n,n=a;p[0]=S(n,p[0]),p[1]=S(r,p[1]),p[2]=S(i,p[2]),p[3]=S(o,p[3]),p[4]=S(s,p[4])}return p}function U(t,e,n){var r,o,s,a,u,h,c,l,p,f,d,g,v,D,U,P,F,k,G,B,V,H,q,j,W,Y,Q=[],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];if(f=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],o=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],"SHA-224"===n||"SHA-256"===n)d=64,r=(e+65>>>9<<4)+15,D=16,U=1,W=Number,P=S,F=O,k=M,G=I,B=C,V=w,H=T,j=y,q=m,f="SHA-224"===n?f:o;else{if("SHA-384"!==n&&"SHA-512"!==n)throw"Unexpected error in SHA-2 implementation";d=80,r=(e+129>>>10<<5)+31,D=32,U=2,W=i,P=z,F=L,k=N,G=A,B=R,V=x,H=E,j=b,q=_,K=[new W(K[0],3609767458),new W(K[1],602891725),new W(K[2],3964484399),new W(K[3],2173295548),new W(K[4],4081628472),new W(K[5],3053834265),new W(K[6],2937671579),new W(K[7],3664609560),new W(K[8],2734883394),new W(K[9],1164996542),new W(K[10],1323610764),new W(K[11],3590304994),new W(K[12],4068182383),new W(K[13],991336113),new W(K[14],633803317),new W(K[15],3479774868),new W(K[16],2666613458),new W(K[17],944711139),new W(K[18],2341262773),new W(K[19],2007800933),new W(K[20],1495990901),new W(K[21],1856431235),new W(K[22],3175218132),new W(K[23],2198950837),new W(K[24],3999719339),new W(K[25],766784016),new W(K[26],2566594879),new W(K[27],3203337956),new W(K[28],1034457026),new W(K[29],2466948901),new W(K[30],3758326383),new W(K[31],168717936),new W(K[32],1188179964),new W(K[33],1546045734),new W(K[34],1522805485),new W(K[35],2643833823),new W(K[36],2343527390),new W(K[37],1014477480),new W(K[38],1206759142),new W(K[39],344077627),new W(K[40],1290863460),new W(K[41],3158454273),new W(K[42],3505952657),new W(K[43],106217008),new W(K[44],3606008344),new W(K[45],1432725776),new W(K[46],1467031594),new W(K[47],851169720),new W(K[48],3100823752),new W(K[49],1363258195),new W(K[50],3750685593),new W(K[51],3785050280),new W(K[52],3318307427),new W(K[53],3812723403),new W(K[54],2003034995),new W(K[55],3602036899),new W(K[56],1575990012),new W(K[57],1125592928),new W(K[58],2716904306),new W(K[59],442776044),new W(K[60],593698344),new W(K[61],3733110249),new W(K[62],2999351573),new W(K[63],3815920427),new W(3391569614,3928383900),new W(3515267271,566280711),new W(3940187606,3454069534),new W(4118630271,4000239992),new W(116418474,1914138554),new W(174292421,2731055270),new W(289380356,3203993006),new W(460393269,320620315),new W(685471733,587496836),new W(852142971,1086792851),new W(1017036298,365543100),new W(1126000580,2618297676),new W(1288033470,3409855158),new W(1501505948,4234509866),new W(1607167915,987167468),new W(1816402316,1246189591)],f="SHA-384"===n?[new W(3418070365,f[0]),new W(1654270250,f[1]),new W(2438529370,f[2]),new W(355462360,f[3]),new W(1731405415,f[4]),new W(41048885895,f[5]),new W(3675008525,f[6]),new W(1203062813,f[7])]:[new W(o[0],4089235720),new W(o[1],2227873595),new W(o[2],4271175723),new W(o[3],1595750129),new W(o[4],2917565137),new W(o[5],725511199),new W(o[6],4215389547),new W(o[7],327033209)]}for(;t.length<=r;)t.push(0);for(t[e>>>5]|=128<<24-e%32,t[r]=e,Y=t.length,g=0;Y>g;g+=D){for(e=f[0],r=f[1],o=f[2],s=f[3],a=f[4],u=f[5],h=f[6],c=f[7],v=0;d>v;v+=1)16>v?(p=v*U+g,l=t.length<=p?0:t[p],p=t.length<=p+1?0:t[p+1],Q[v]=new W(l,p)):Q[v]=F(B(Q[v-2]),Q[v-7],G(Q[v-15]),Q[v-16]),l=k(c,H(a),q(a,u,h),K[v],Q[v]),p=P(V(e),j(e,r,o)),c=h,h=u,u=a,a=P(s,l),s=o,o=r,r=e,e=P(l,p);f[0]=P(e,f[0]),f[1]=P(r,f[1]),f[2]=P(o,f[2]),f[3]=P(s,f[3]),f[4]=P(a,f[4]),f[5]=P(u,f[5]),f[6]=P(h,f[6]),f[7]=P(c,f[7])}if("SHA-224"===n)t=[f[0],f[1],f[2],f[3],f[4],f[5],f[6]];else if("SHA-256"===n)t=f;else if("SHA-384"===n)t=[f[0].a,f[0].b,f[1].a,f[1].b,f[2].a,f[2].b,f[3].a,f[3].b,f[4].a,f[4].b,f[5].a,f[5].b];else{if("SHA-512"!==n)throw"Unexpected error in SHA-2 implementation";t=[f[0].a,f[0].b,f[1].a,f[1].b,f[2].a,f[2].b,f[3].a,f[3].b,f[4].a,f[4].b,f[5].a,f[5].b,f[6].a,f[6].b,f[7].a,f[7].b]}return t}"function"==typeof define&&define.amd?define(function(){return r}):"undefined"!=typeof n?"undefined"!=typeof e&&e.exports?e.exports=n=r:n=r:t.jsSHA=r}(this)},{}],151:[function(t,e,n){(function(t){(function(){function r(t,e){if(t!==e){var n=null===t,r=t===E,i=t===t,o=null===e,s=e===E,a=e===e;if(t>e&&!o||!i||n&&!s&&a||r&&a)return 1;if(e>t&&!n||!a||o&&!r&&i||s&&i)return-1}return 0}function i(t,e,n){for(var r=t.length,i=n?r:-1;n?i--:++i<r;)if(e(t[i],i,t))return i;return-1}function o(t,e,n){if(e!==e)return g(t,n);for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function s(t){return"function"==typeof t||!1}function a(t){return"string"==typeof t?t:null==t?"":t+""}function u(t,e){for(var n=-1,r=t.length;++n<r&&e.indexOf(t.charAt(n))>-1;);return n}function h(t,e){for(var n=t.length;n--&&e.indexOf(t.charAt(n))>-1;);return n}function c(t,e){return r(t.criteria,e.criteria)||t.index-e.index}function l(t,e,n){for(var i=-1,o=t.criteria,s=e.criteria,a=o.length,u=n.length;++i<a;){var h=r(o[i],s[i]);if(h)return i>=u?h:h*(n[i]?1:-1)}return t.index-e.index}function p(t){return jt[t]}function f(t){return Wt[t]}function d(t){return"\\"+Kt[t]}function g(t,e,n){for(var r=t.length,i=e+(n?0:-1);n?i--:++i<r;){var o=t[i];if(o!==o)return i}return-1}function v(t){return!!t&&"object"==typeof t}function m(t){return 160>=t&&t>=9&&13>=t||32==t||160==t||5760==t||6158==t||t>=8192&&(8202>=t||8232==t||8233==t||8239==t||8287==t||12288==t||65279==t)}function _(t,e){for(var n=-1,r=t.length,i=-1,o=[];++n<r;)t[n]===e&&(t[n]=H,o[++i]=n);return o}function y(t,e){for(var n,r=-1,i=t.length,o=-1,s=[];++r<i;){var a=t[r],u=e?e(a,r,t):a;r&&n===u||(n=u,s[++o]=a)}return s}function b(t){for(var e=-1,n=t.length;++e<n&&m(t.charCodeAt(e)););return e}function w(t){for(var e=t.length;e--&&m(t.charCodeAt(e)););return e}function x(t){return Yt[t]}function T(t){function e(t){if(v(t)&&!Ca(t)&&!(t instanceof X)){if(t instanceof m)return t;if(Ko.call(t,"__chain__")&&Ko.call(t,"__wrapped__"))return hr(t)}return new m(t)}function n(){}function m(t,e,n){this.__wrapped__=t,this.__actions__=n||[],this.__chain__=!!e}function X(t){this.__wrapped__=t,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=Is,this.__views__=null}function tt(){var t=this.__actions__,e=this.__iteratees__,n=this.__views__,r=new X(this.__wrapped__);return r.__actions__=t?te(t):null,r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=e?te(e):null,r.__takeCount__=this.__takeCount__,r.__views__=n?te(n):null,r}function nt(){if(this.__filtered__){var t=new X(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function jt(){var t=this.__wrapped__.value();if(!Ca(t))return en(t,this.__actions__);var e=this.__dir__,n=0>e,r=Vn(0,t.length,this.__views__),i=r.start,o=r.end,s=o-i,a=n?o:i-1,u=ys(s,this.__takeCount__),h=this.__iteratees__,c=h?h.length:0,l=0,p=[];t:for(;s--&&u>l;){a+=e;for(var f=-1,d=t[a];++f<c;){var g=h[f],v=g.iteratee,m=g.type;if(m==k){if(g.done&&(n?a>g.index:a<g.index)&&(g.count=0,g.done=!1),g.index=a,!g.done){var _=g.limit;if(!(g.done=_>-1?g.count++>=_:!v(d)))continue t}}else{var y=v(d);if(m==B)d=y;else if(!y){if(m==G)continue t;break t}}}p[l++]=d}return p}function Wt(){this.__data__={}}function Yt(t){return this.has(t)&&delete this.__data__[t]}function Qt(t){return"__proto__"==t?E:this.__data__[t]}function Kt(t){return"__proto__"!=t&&Ko.call(this.__data__,t)}function Xt(t,e){return"__proto__"!=t&&(this.__data__[t]=e),this}function $t(t){var e=t?t.length:0;for(this.data={hash:ds(null),set:new us};e--;)this.push(t[e])}function Jt(t,e){var n=t.data,r="string"==typeof e||Ri(e)?n.set.has(e):n.hash[e];return r?0:-1}function Zt(t){var e=this.data;"string"==typeof t||Ri(t)?e.set.add(t):e.hash[t]=!0}function te(t,e){var n=-1,r=t.length;for(e||(e=No(r));++n<r;)e[n]=t[n];return e}function ee(t,e){for(var n=-1,r=t.length;++n<r&&e(t[n],n,t)!==!1;);return t}function ie(t,e){for(var n=t.length;n--&&e(t[n],n,t)!==!1;);return t}function oe(t,e){for(var n=-1,r=t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function se(t,e,n,r){for(var i=-1,o=t.length,s=r,a=s;++i<o;){var u=t[i],h=+e(u);n(h,s)&&(s=h,a=u)}return a}function ae(t,e){for(var n=-1,r=t.length,i=-1,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[++i]=s)}return o}function ue(t,e){for(var n=-1,r=t.length,i=No(r);++n<r;)i[n]=e(t[n],n,t);return i}function he(t,e,n,r){var i=-1,o=t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function ce(t,e,n,r){var i=t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function le(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function pe(t){for(var e=t.length,n=0;e--;)n+=+t[e]||0;return n}function fe(t,e){return t===E?e:t}function de(t,e,n,r){return t!==E&&Ko.call(r,n)?t:e}function ge(t,e,n){for(var r=-1,i=ka(e),o=i.length;++r<o;){var s=i[r],a=t[s],u=n(a,e[s],s,t,e);(u===u?u===a:a!==a)&&(a!==E||s in t)||(t[s]=u)}return t}function ve(t,e){return null==e?t:_e(e,ka(e),t)}function me(t,e){for(var n=-1,r=null==t,i=!r&&Yn(t),o=i?t.length:0,s=e.length,a=No(s);++n<s;){var u=e[n];i?a[n]=Qn(u,o)?t[u]:E:a[n]=r?E:t[u]}return a}function _e(t,e,n){n||(n={});for(var r=-1,i=e.length;++r<i;){var o=e[r];n[o]=t[o]}return n}function ye(t,e,n){var r=typeof t;return"function"==r?e===E?t:on(t,e,n):null==t?wo:"object"==r?Fe(t):e===E?Co(t):ke(t,e)}function be(t,e,n,r,i,o,s){var a;if(n&&(a=i?n(t,r,i):n(t)),a!==E)return a;if(!Ri(t))return t;var u=Ca(t);if(u){if(a=Hn(t),!e)return te(t,a)}else{var h=$o.call(t),c=h==K;if(h!=J&&h!=q&&(!c||i))return Ht[h]?jn(t,h,e):i?t:{};if(a=qn(c?{}:t),!e)return ve(a,t)}o||(o=[]),s||(s=[]);for(var l=o.length;l--;)if(o[l]==t)return s[l];return o.push(t),s.push(a),(u?ee:Oe)(t,function(r,i){a[i]=be(r,e,n,i,t,o,s)}),a}function we(t,e,n){if("function"!=typeof t)throw new Ho(V);return hs(function(){t.apply(E,n)},e)}function xe(t,e){var n=t?t.length:0,r=[];if(!n)return r;var i=-1,s=kn(),a=s==o,u=a&&e.length>=200?Gs(e):null,h=e.length;u&&(s=Jt,a=!1,e=u);t:for(;++i<n;){var c=t[i];if(a&&c===c){for(var l=h;l--;)if(e[l]===c)continue t;r.push(c)}else s(e,c,0)<0&&r.push(c)}return r}function Te(t,e){var n=!0;return Ds(t,function(t,r,i){return n=!!e(t,r,i)}),n}function Ee(t,e,n,r){var i=r,o=i;return Ds(t,function(t,s,a){var u=+e(t,s,a);(n(u,i)||u===r&&u===o)&&(i=u,o=t)}),o}function Ie(t,e,n,r){var i=t.length;for(n=null==n?0:+n||0,0>n&&(n=-n>i?0:i+n),r=r===E||r>i?i:+r||0,0>r&&(r+=i),i=n>r?0:r>>>0,n>>>=0;i>n;)t[n++]=e;return t}function Ae(t,e){var n=[];return Ds(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function Ce(t,e,n,r){var i;return n(t,function(t,n,o){return e(t,n,o)?(i=r?n:t,!1):void 0}),i}function Re(t,e,n){for(var r=-1,i=t.length,o=-1,s=[];++r<i;){var a=t[r];if(v(a)&&Yn(a)&&(n||Ca(a)||wi(a))){e&&(a=Re(a,e,n));for(var u=-1,h=a.length;++u<h;)s[++o]=a[u]}else n||(s[++o]=a)}return s}function Se(t,e){return Ps(t,e,Yi)}function Oe(t,e){return Ps(t,e,ka)}function Me(t,e){return Fs(t,e,ka)}function ze(t,e){for(var n=-1,r=e.length,i=-1,o=[];++n<r;){var s=e[n];Sa(t[s])&&(o[++i]=s)}return o}function Le(t,e,n){if(null!=t){n!==E&&n in ar(t)&&(e=[n]);for(var r=0,i=e.length;null!=t&&i>r;)t=t[e[r++]];return r&&r==i?t:E}}function Ne(t,e,n,r,i,o){return t===e?!0:null==t||null==e||!Ri(t)&&!v(e)?t!==t&&e!==e:De(t,e,Ne,n,r,i,o)}function De(t,e,n,r,i,o,s){var a=Ca(t),u=Ca(e),h=j,c=j;a||(h=$o.call(t),h==q?h=J:h!=J&&(a=Ui(t))),u||(c=$o.call(e),c==q?c=J:c!=J&&(u=Ui(e)));var l=h==J,p=c==J,f=h==c;if(f&&!a&&!l)return Dn(t,e,h);if(!i){var d=l&&Ko.call(t,"__wrapped__"),g=p&&Ko.call(e,"__wrapped__");if(d||g)return n(d?t.value():t,g?e.value():e,r,i,o,s)}if(!f)return!1;o||(o=[]),s||(s=[]);for(var v=o.length;v--;)if(o[v]==t)return s[v]==e;o.push(t),s.push(e);var m=(a?Nn:Un)(t,e,n,r,i,o,s);return o.pop(),s.pop(),m}function Ue(t,e,n){var r=e.length,i=r,o=!n;if(null==t)return!i;for(t=ar(t);r--;){var s=e[r];if(o&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++r<i;){s=e[r];var a=s[0],u=t[a],h=s[1];if(o&&s[2]){if(u===E&&!(a in t))return!1}else{var c=n?n(u,h,a):E;if(!(c===E?Ne(h,u,n,!0):c))return!1}}return!0}function Pe(t,e){var n=-1,r=Yn(t)?No(t.length):[];return Ds(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function Fe(t){var e=Gn(t);if(1==e.length&&e[0][2]){var n=e[0][0],r=e[0][1];return function(t){return null==t?!1:t[n]===r&&(r!==E||n in ar(t))}}return function(t){return Ue(t,e)}}function ke(t,e){var n=Ca(t),r=Xn(t)&&Zn(e),i=t+"";return t=ur(t),function(o){if(null==o)return!1;var s=i;if(o=ar(o),!(!n&&r||s in o)){if(o=1==t.length?o:Le(o,Ye(t,0,-1)),null==o)return!1;s=xr(t),o=ar(o)}return o[s]===e?e!==E||s in o:Ne(e,o[s],E,!0)}}function Ge(t,e,n,r,i){if(!Ri(t))return t;var o=Yn(e)&&(Ca(e)||Ui(e)),s=o?null:ka(e);return ee(s||e,function(a,u){if(s&&(u=a,a=e[u]),v(a))r||(r=[]),i||(i=[]),Be(t,e,u,Ge,n,r,i);else{var h=t[u],c=n?n(h,a,u,t,e):E,l=c===E;l&&(c=a),c===E&&(!o||u in t)||!l&&(c===c?c===h:h!==h)||(t[u]=c)}}),t}function Be(t,e,n,r,i,o,s){for(var a=o.length,u=e[n];a--;)if(o[a]==u)return void(t[n]=s[a]);var h=t[n],c=i?i(h,u,n,t,e):E,l=c===E;l&&(c=u,Yn(u)&&(Ca(u)||Ui(u))?c=Ca(h)?h:Yn(h)?te(h):[]:Oa(u)||wi(u)?c=wi(h)?Bi(h):Oa(h)?h:{}:l=!1),o.push(u),s.push(c),l?t[n]=r(c,u,i,o,s):(c===c?c!==h:h===h)&&(t[n]=c)}function Ve(t){return function(e){return null==e?E:e[t]}}function He(t){var e=t+"";return t=ur(t),function(n){return Le(n,t,e)}}function qe(t,e){for(var n=t?e.length:0;n--;){var r=e[n];if(r!=i&&Qn(r)){var i=r;cs.call(t,r,1)}}return t}function je(t,e){return t+is(Ts()*(e-t+1))}function We(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function Ye(t,e,n){var r=-1,i=t.length;e=null==e?0:+e||0,0>e&&(e=-e>i?0:i+e),n=n===E||n>i?i:+n||0,0>n&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=No(i);++r<i;)o[r]=t[r+e];return o}function Qe(t,e){var n;return Ds(t,function(t,r,i){return n=e(t,r,i),
!n}),!!n}function Ke(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function Xe(t,e,n){var r=Pn(),i=-1;e=ue(e,function(t){return r(t)});var o=Pe(t,function(t){var n=ue(e,function(e){return e(t)});return{criteria:n,index:++i,value:t}});return Ke(o,function(t,e){return l(t,e,n)})}function $e(t,e){var n=0;return Ds(t,function(t,r,i){n+=+e(t,r,i)||0}),n}function Je(t,e){var n=-1,r=kn(),i=t.length,s=r==o,a=s&&i>=200,u=a?Gs():null,h=[];u?(r=Jt,s=!1):(a=!1,u=e?[]:h);t:for(;++n<i;){var c=t[n],l=e?e(c,n,t):c;if(s&&c===c){for(var p=u.length;p--;)if(u[p]===l)continue t;e&&u.push(l),h.push(c)}else r(u,l,0)<0&&((e||a)&&u.push(l),h.push(c))}return h}function Ze(t,e){for(var n=-1,r=e.length,i=No(r);++n<r;)i[n]=t[e[n]];return i}function tn(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?Ye(t,r?0:o,r?o+1:i):Ye(t,r?o+1:0,r?i:o)}function en(t,e){var n=t;n instanceof X&&(n=n.value());for(var r=-1,i=e.length;++r<i;){var o=[n],s=e[r];as.apply(o,s.args),n=s.func.apply(s.thisArg,o)}return n}function nn(t,e,n){var r=0,i=t?t.length:r;if("number"==typeof e&&e===e&&Rs>=i){for(;i>r;){var o=r+i>>>1,s=t[o];(n?e>=s:e>s)&&null!==s?r=o+1:i=o}return i}return rn(t,e,wo,n)}function rn(t,e,n,r){e=n(e);for(var i=0,o=t?t.length:0,s=e!==e,a=null===e,u=e===E;o>i;){var h=is((i+o)/2),c=n(t[h]),l=c!==E,p=c===c;if(s)var f=p||r;else f=a?p&&l&&(r||null!=c):u?p&&(r||l):null==c?!1:r?e>=c:e>c;f?i=h+1:o=h}return ys(o,Cs)}function on(t,e,n){if("function"!=typeof t)return wo;if(e===E)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)};case 5:return function(n,r,i,o,s){return t.call(e,n,r,i,o,s)}}return function(){return t.apply(e,arguments)}}function sn(t){return es.call(t,0)}function an(t,e,n){for(var r=n.length,i=-1,o=_s(t.length-r,0),s=-1,a=e.length,u=No(o+a);++s<a;)u[s]=e[s];for(;++i<r;)u[n[i]]=t[i];for(;o--;)u[s++]=t[i++];return u}function un(t,e,n){for(var r=-1,i=n.length,o=-1,s=_s(t.length-i,0),a=-1,u=e.length,h=No(s+u);++o<s;)h[o]=t[o];for(var c=o;++a<u;)h[c+a]=e[a];for(;++r<i;)h[c+n[r]]=t[o++];return h}function hn(t,e){return function(n,r,i){var o=e?e():{};if(r=Pn(r,i,3),Ca(n))for(var s=-1,a=n.length;++s<a;){var u=n[s];t(o,u,r(u,s,n),n)}else Ds(n,function(e,n,i){t(o,e,r(e,n,i),i)});return o}}function cn(t){return fi(function(e,n){var r=-1,i=null==e?0:n.length,o=i>2?n[i-2]:E,s=i>2?n[2]:E,a=i>1?n[i-1]:E;for("function"==typeof o?(o=on(o,a,5),i-=2):(o="function"==typeof a?a:E,i-=o?1:0),s&&Kn(n[0],n[1],s)&&(o=3>i?E:o,i=1);++r<i;){var u=n[r];u&&t(e,u,o)}return e})}function ln(t,e){return function(n,r){var i=n?Vs(n):0;if(!Jn(i))return t(n,r);for(var o=e?i:-1,s=ar(n);(e?o--:++o<i)&&r(s[o],o,s)!==!1;);return n}}function pn(t){return function(e,n,r){for(var i=ar(e),o=r(e),s=o.length,a=t?s:-1;t?a--:++a<s;){var u=o[a];if(n(i[u],u,i)===!1)break}return e}}function fn(t,e){function n(){var i=this&&this!==ne&&this instanceof n?r:t;return i.apply(e,arguments)}var r=gn(t);return n}function dn(t){return function(e){for(var n=-1,r=_o(ro(e)),i=r.length,o="";++n<i;)o=t(o,r[n],n);return o}}function gn(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4])}var n=Ns(t.prototype),r=t.apply(n,e);return Ri(r)?r:n}}function vn(t){function e(n,r,i){i&&Kn(n,r,i)&&(r=null);var o=Ln(n,t,null,null,null,null,null,r);return o.placeholder=e.placeholder,o}return e}function mn(t,e){return function(n,r,i){if(i&&Kn(n,r,i)&&(r=null),r=Pn(r,i,3),1==r.length){n=sr(n);var o=se(n,r,t,e);if(!n.length||o!==e)return o}return Ee(n,r,t,e)}}function _n(t,e){return function(n,r,o){if(r=Pn(r,o,3),Ca(n)){var s=i(n,r,e);return s>-1?n[s]:E}return Ce(n,r,t)}}function yn(t){return function(e,n,r){return e&&e.length?(n=Pn(n,r,3),i(e,n,t)):-1}}function bn(t){return function(e,n,r){return n=Pn(n,r,3),Ce(e,n,t,!0)}}function wn(t){return function(){for(var e,n=arguments.length,r=t?n:-1,i=0,o=No(n);t?r--:++r<n;){var s=o[i++]=arguments[r];if("function"!=typeof s)throw new Ho(V);!e&&m.prototype.thru&&"wrapper"==Fn(s)&&(e=new m([]))}for(r=e?-1:n;++r<n;){s=o[r];var a=Fn(s),u="wrapper"==a?Bs(s):null;e=u&&$n(u[0])&&u[1]==(L|S|M|N)&&!u[4].length&&1==u[9]?e[Fn(u[0])].apply(e,u[3]):1==s.length&&$n(s)?e[a]():e.thru(s)}return function(){var t=arguments;if(e&&1==t.length&&Ca(t[0]))return e.plant(t[0]).value();for(var r=0,i=n?o[r].apply(this,t):t[0];++r<n;)i=o[r].call(this,i);return i}}}function xn(t,e){return function(n,r,i){return"function"==typeof r&&i===E&&Ca(n)?t(n,r):e(n,on(r,i,3))}}function Tn(t){return function(e,n,r){return("function"!=typeof n||r!==E)&&(n=on(n,r,3)),t(e,n,Yi)}}function En(t){return function(e,n,r){return("function"!=typeof n||r!==E)&&(n=on(n,r,3)),t(e,n)}}function In(t){return function(e,n,r){var i={};return n=Pn(n,r,3),Oe(e,function(e,r,o){var s=n(e,r,o);r=t?s:r,e=t?e:s,i[r]=e}),i}}function An(t){return function(e,n,r){return e=a(e),(t?e:"")+On(e,n,r)+(t?"":e)}}function Cn(t){var e=fi(function(n,r){var i=_(r,e.placeholder);return Ln(n,t,null,r,i)});return e}function Rn(t,e){return function(n,r,i,o){var s=arguments.length<3;return"function"==typeof r&&o===E&&Ca(n)?t(n,r,i,s):We(n,Pn(r,o,4),i,s,e)}}function Sn(t,e,n,r,i,o,s,a,u,h){function c(){for(var y=arguments.length,b=y,w=No(y);b--;)w[b]=arguments[b];if(r&&(w=an(w,r,i)),o&&(w=un(w,o,s)),d||v){var x=c.placeholder,T=_(w,x);if(y-=T.length,h>y){var I=a?te(a):null,R=_s(h-y,0),S=d?T:null,O=d?null:T,L=d?w:null,N=d?null:w;e|=d?M:z,e&=~(d?z:M),g||(e&=~(A|C));var D=[t,e,n,L,S,N,O,I,u,R],U=Sn.apply(E,D);return $n(t)&&Hs(U,D),U.placeholder=x,U}}var P=p?n:this,F=f?P[t]:t;return a&&(w=rr(w,a)),l&&u<w.length&&(w.length=u),this&&this!==ne&&this instanceof c&&(F=m||gn(t)),F.apply(P,w)}var l=e&L,p=e&A,f=e&C,d=e&S,g=e&R,v=e&O,m=f?null:gn(t);return c}function On(t,e,n){var r=t.length;if(e=+e,r>=e||!vs(e))return"";var i=e-r;return n=null==n?" ":n+"",ho(n,ns(i/n.length)).slice(0,i)}function Mn(t,e,n,r){function i(){for(var e=-1,a=arguments.length,u=-1,h=r.length,c=No(a+h);++u<h;)c[u]=r[u];for(;a--;)c[u++]=arguments[++e];var l=this&&this!==ne&&this instanceof i?s:t;return l.apply(o?n:this,c)}var o=e&A,s=gn(t);return i}function zn(t){return function(e,n,r,i){var o=Pn(r);return null==r&&o===ye?nn(e,n,t):rn(e,n,o(r,i,1),t)}}function Ln(t,e,n,r,i,o,s,a){var u=e&C;if(!u&&"function"!=typeof t)throw new Ho(V);var h=r?r.length:0;if(h||(e&=~(M|z),r=i=null),h-=i?i.length:0,e&z){var c=r,l=i;r=i=null}var p=u?null:Bs(t),f=[t,e,n,r,i,c,l,o,s,a];if(p&&(tr(f,p),e=f[1],a=f[9]),f[9]=null==a?u?0:t.length:_s(a-h,0)||0,e==A)var d=fn(f[0],f[2]);else d=e!=M&&e!=(A|M)||f[4].length?Sn.apply(E,f):Mn.apply(E,f);var g=p?ks:Hs;return g(d,f)}function Nn(t,e,n,r,i,o,s){var a=-1,u=t.length,h=e.length;if(u!=h&&!(i&&h>u))return!1;for(;++a<u;){var c=t[a],l=e[a],p=r?r(i?l:c,i?c:l,a):E;if(p!==E){if(p)continue;return!1}if(i){if(!le(e,function(t){return c===t||n(c,t,r,i,o,s)}))return!1}else if(c!==l&&!n(c,l,r,i,o,s))return!1}return!0}function Dn(t,e,n){switch(n){case W:case Y:return+t==+e;case Q:return t.name==e.name&&t.message==e.message;case $:return t!=+t?e!=+e:t==+e;case Z:case et:return t==e+""}return!1}function Un(t,e,n,r,i,o,s){var a=ka(t),u=a.length,h=ka(e),c=h.length;if(u!=c&&!i)return!1;for(var l=u;l--;){var p=a[l];if(!(i?p in e:Ko.call(e,p)))return!1}for(var f=i;++l<u;){p=a[l];var d=t[p],g=e[p],v=r?r(i?g:d,i?d:g,p):E;if(!(v===E?n(d,g,r,i,o,s):v))return!1;f||(f="constructor"==p)}if(!f){var m=t.constructor,_=e.constructor;if(m!=_&&"constructor"in t&&"constructor"in e&&!("function"==typeof m&&m instanceof m&&"function"==typeof _&&_ instanceof _))return!1}return!0}function Pn(t,n,r){var i=e.callback||yo;return i=i===yo?ye:i,r?i(t,n,r):i}function Fn(t){for(var e=t.name,n=zs[e],r=n?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function kn(t,n,r){var i=e.indexOf||br;return i=i===br?o:i,t?i(t,n,r):i}function Gn(t){for(var e=Qi(t),n=e.length;n--;)e[n][2]=Zn(e[n][1]);return e}function Bn(t,e){var n=null==t?E:t[e];return Mi(n)?n:E}function Vn(t,e,n){for(var r=-1,i=n?n.length:0;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=ys(e,t+s);break;case"takeRight":t=_s(t,e-s)}}return{start:t,end:e}}function Hn(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Ko.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function qn(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=Go),new e}function jn(t,e,n){var r=t.constructor;switch(e){case rt:return sn(t);case W:case Y:return new r(+t);case it:case ot:case st:case at:case ut:case ht:case ct:case lt:case pt:var i=t.buffer;return new r(n?sn(i):i,t.byteOffset,t.length);case $:case et:return new r(t);case Z:var o=new r(t.source,Mt.exec(t));o.lastIndex=t.lastIndex}return o}function Wn(t,e,n){null==t||Xn(e,t)||(e=ur(e),t=1==e.length?t:Le(t,Ye(e,0,-1)),e=xr(e));var r=null==t?t:t[e];return null==r?E:r.apply(t,n)}function Yn(t){return null!=t&&Jn(Vs(t))}function Qn(t,e){return t="number"==typeof t||Nt.test(t)?+t:-1,e=null==e?Os:e,t>-1&&t%1==0&&e>t}function Kn(t,e,n){if(!Ri(n))return!1;var r=typeof e;if("number"==r?Yn(n)&&Qn(e,n.length):"string"==r&&e in n){var i=n[e];return t===t?t===i:i!==i}return!1}function Xn(t,e){var n=typeof t;if("string"==n&&Et.test(t)||"number"==n)return!0;if(Ca(t))return!1;var r=!Tt.test(t);return r||null!=e&&t in ar(e)}function $n(t){var n=Fn(t);if(!(n in X.prototype))return!1;var r=e[n];if(t===r)return!0;var i=Bs(r);return!!i&&t===i[0]}function Jn(t){return"number"==typeof t&&t>-1&&t%1==0&&Os>=t}function Zn(t){return t===t&&!Ri(t)}function tr(t,e){var n=t[1],r=e[1],i=n|r,o=L>i,s=r==L&&n==S||r==L&&n==N&&t[7].length<=e[8]||r==(L|N)&&n==S;if(!o&&!s)return t;r&A&&(t[2]=e[2],i|=n&A?0:R);var a=e[3];if(a){var u=t[3];t[3]=u?an(u,a,e[4]):te(a),t[4]=u?_(t[3],H):te(e[4])}return a=e[5],a&&(u=t[5],t[5]=u?un(u,a,e[6]):te(a),t[6]=u?_(t[5],H):te(e[6])),a=e[7],a&&(t[7]=te(a)),r&L&&(t[8]=null==t[8]?e[8]:ys(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}function er(t,e){t=ar(t);for(var n=-1,r=e.length,i={};++n<r;){var o=e[n];o in t&&(i[o]=t[o])}return i}function nr(t,e){var n={};return Se(t,function(t,r,i){e(t,r,i)&&(n[r]=t)}),n}function rr(t,e){for(var n=t.length,r=ys(e.length,n),i=te(t);r--;){var o=e[r];t[r]=Qn(o,n)?i[o]:E}return t}function ir(t){var n;if(e.support,!v(t)||$o.call(t)!=J||!Ko.call(t,"constructor")&&(n=t.constructor,"function"==typeof n&&!(n instanceof n)))return!1;var r;return Se(t,function(t,e){r=e}),r===E||Ko.call(t,r)}function or(t){for(var e=Yi(t),n=e.length,r=n&&t.length,i=!!r&&Jn(r)&&(Ca(t)||wi(t)),o=-1,s=[];++o<n;){var a=e[o];(i&&Qn(a,r)||Ko.call(t,a))&&s.push(a)}return s}function sr(t){return null==t?[]:Yn(t)?Ri(t)?t:Go(t):Ji(t)}function ar(t){return Ri(t)?t:Go(t)}function ur(t){if(Ca(t))return t;var e=[];return a(t).replace(It,function(t,n,r,i){e.push(r?i.replace(St,"$1"):n||t)}),e}function hr(t){return t instanceof X?t.clone():new m(t.__wrapped__,t.__chain__,te(t.__actions__))}function cr(t,e,n){e=(n?Kn(t,e,n):null==e)?1:_s(+e||1,1);for(var r=0,i=t?t.length:0,o=-1,s=No(ns(i/e));i>r;)s[++o]=Ye(t,r,r+=e);return s}function lr(t){for(var e=-1,n=t?t.length:0,r=-1,i=[];++e<n;){var o=t[e];o&&(i[++r]=o)}return i}function pr(t,e,n){var r=t?t.length:0;return r?((n?Kn(t,e,n):null==e)&&(e=1),Ye(t,0>e?0:e)):[]}function fr(t,e,n){var r=t?t.length:0;return r?((n?Kn(t,e,n):null==e)&&(e=1),e=r-(+e||0),Ye(t,0,0>e?0:e)):[]}function dr(t,e,n){return t&&t.length?tn(t,Pn(e,n,3),!0,!0):[]}function gr(t,e,n){return t&&t.length?tn(t,Pn(e,n,3),!0):[]}function vr(t,e,n,r){var i=t?t.length:0;return i?(n&&"number"!=typeof n&&Kn(t,e,n)&&(n=0,r=i),Ie(t,e,n,r)):[]}function mr(t){return t?t[0]:E}function _r(t,e,n){var r=t?t.length:0;return n&&Kn(t,e,n)&&(e=!1),r?Re(t,e):[]}function yr(t){var e=t?t.length:0;return e?Re(t,!0):[]}function br(t,e,n){var r=t?t.length:0;if(!r)return-1;if("number"==typeof n)n=0>n?_s(r+n,0):n;else if(n){var i=nn(t,e),s=t[i];return(e===e?e===s:s!==s)?i:-1}return o(t,e,n||0)}function wr(t){return fr(t,1)}function xr(t){var e=t?t.length:0;return e?t[e-1]:E}function Tr(t,e,n){var r=t?t.length:0;if(!r)return-1;var i=r;if("number"==typeof n)i=(0>n?_s(r+n,0):ys(n||0,r-1))+1;else if(n){i=nn(t,e,!0)-1;var o=t[i];return(e===e?e===o:o!==o)?i:-1}if(e!==e)return g(t,i,!0);for(;i--;)if(t[i]===e)return i;return-1}function Er(){var t=arguments,e=t[0];if(!e||!e.length)return e;for(var n=0,r=kn(),i=t.length;++n<i;)for(var o=0,s=t[n];(o=r(e,s,o))>-1;)cs.call(e,o,1);return e}function Ir(t,e,n){var r=[];if(!t||!t.length)return r;var i=-1,o=[],s=t.length;for(e=Pn(e,n,3);++i<s;){var a=t[i];e(a,i,t)&&(r.push(a),o.push(i))}return qe(t,o),r}function Ar(t){return pr(t,1)}function Cr(t,e,n){var r=t?t.length:0;return r?(n&&"number"!=typeof n&&Kn(t,e,n)&&(e=0,n=r),Ye(t,e,n)):[]}function Rr(t,e,n){var r=t?t.length:0;return r?((n?Kn(t,e,n):null==e)&&(e=1),Ye(t,0,0>e?0:e)):[]}function Sr(t,e,n){var r=t?t.length:0;return r?((n?Kn(t,e,n):null==e)&&(e=1),e=r-(+e||0),Ye(t,0>e?0:e)):[]}function Or(t,e,n){return t&&t.length?tn(t,Pn(e,n,3),!1,!0):[]}function Mr(t,e,n){return t&&t.length?tn(t,Pn(e,n,3)):[]}function zr(t,e,n,r){var i=t?t.length:0;if(!i)return[];null!=e&&"boolean"!=typeof e&&(r=n,n=Kn(t,e,r)?null:e,e=!1);var s=Pn();return(null!=n||s!==ye)&&(n=s(n,r,3)),e&&kn()==o?y(t,n):Je(t,n)}function Lr(t){if(!t||!t.length)return[];var e=-1,n=0;t=ae(t,function(t){return Yn(t)?(n=_s(t.length,n),!0):void 0});for(var r=No(n);++e<n;)r[e]=ue(t,Ve(e));return r}function Nr(t,e,n){var r=t?t.length:0;if(!r)return[];var i=Lr(t);return null==e?i:(e=on(e,n,4),ue(i,function(t){return he(t,e,E,!0)}))}function Dr(){for(var t=-1,e=arguments.length;++t<e;){var n=arguments[t];if(Yn(n))var r=r?xe(r,n).concat(xe(n,r)):n}return r?Je(r):[]}function Ur(t,e){var n=-1,r=t?t.length:0,i={};for(!r||e||Ca(t[0])||(e=[]);++n<r;){var o=t[n];e?i[o]=e[n]:o&&(i[o[0]]=o[1])}return i}function Pr(t){var n=e(t);return n.__chain__=!0,n}function Fr(t,e,n){return e.call(n,t),t}function kr(t,e,n){return e.call(n,t)}function Gr(){return Pr(this)}function Br(){return new m(this.value(),this.__chain__)}function Vr(t){for(var e,r=this;r instanceof n;){var i=hr(r);e?o.__wrapped__=i:e=i;var o=i;r=r.__wrapped__}return o.__wrapped__=t,e}function Hr(){var t=this.__wrapped__;return t instanceof X?(this.__actions__.length&&(t=new X(this)),new m(t.reverse(),this.__chain__)):this.thru(function(t){return t.reverse()})}function qr(){return this.value()+""}function jr(){return en(this.__wrapped__,this.__actions__)}function Wr(t,e,n){var r=Ca(t)?oe:Te;return n&&Kn(t,e,n)&&(e=null),("function"!=typeof e||n!==E)&&(e=Pn(e,n,3)),r(t,e)}function Yr(t,e,n){var r=Ca(t)?ae:Ae;return e=Pn(e,n,3),r(t,e)}function Qr(t,e){return ra(t,Fe(e))}function Kr(t,e,n,r){var i=t?Vs(t):0;return Jn(i)||(t=Ji(t),i=t.length),i?(n="number"!=typeof n||r&&Kn(e,n,r)?0:0>n?_s(i+n,0):n||0,"string"==typeof t||!Ca(t)&&Di(t)?i>n&&t.indexOf(e,n)>-1:kn(t,e,n)>-1):!1}function Xr(t,e,n){var r=Ca(t)?ue:Pe;return e=Pn(e,n,3),r(t,e)}function $r(t,e){return Xr(t,Co(e))}function Jr(t,e,n){var r=Ca(t)?ae:Ae;return e=Pn(e,n,3),r(t,function(t,n,r){return!e(t,n,r)})}function Zr(t,e,n){if(n?Kn(t,e,n):null==e){t=sr(t);var r=t.length;return r>0?t[je(0,r-1)]:E}var i=-1,o=Gi(t),r=o.length,s=r-1;for(e=ys(0>e?0:+e||0,r);++i<e;){var a=je(i,s),u=o[a];o[a]=o[i],o[i]=u}return o.length=e,o}function ti(t){return Zr(t,Is)}function ei(t){var e=t?Vs(t):0;return Jn(e)?e:ka(t).length}function ni(t,e,n){var r=Ca(t)?le:Qe;return n&&Kn(t,e,n)&&(e=null),("function"!=typeof e||n!==E)&&(e=Pn(e,n,3)),r(t,e)}function ri(t,e,n){if(null==t)return[];n&&Kn(t,e,n)&&(e=null);var r=-1;e=Pn(e,n,3);var i=Pe(t,function(t,n,i){return{criteria:e(t,n,i),index:++r,value:t}});return Ke(i,c)}function ii(t,e,n,r){return null==t?[]:(r&&Kn(e,n,r)&&(n=null),Ca(e)||(e=null==e?[]:[e]),Ca(n)||(n=null==n?[]:[n]),Xe(t,e,n))}function oi(t,e){return Yr(t,Fe(e))}function si(t,e){if("function"!=typeof e){if("function"!=typeof t)throw new Ho(V);var n=t;t=e,e=n}return t=vs(t=+t)?t:0,function(){return--t<1?e.apply(this,arguments):void 0}}function ai(t,e,n){return n&&Kn(t,e,n)&&(e=null),e=t&&null==e?t.length:_s(+e||0,0),Ln(t,L,null,null,null,null,e)}function ui(t,e){var n;if("function"!=typeof e){if("function"!=typeof t)throw new Ho(V);var r=t;t=e,e=r}return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}}function hi(t,e,n){function r(){p&&rs(p),u&&rs(u),u=p=f=E}function i(){var n=e-(da()-c);if(0>=n||n>e){u&&rs(u);var r=f;u=p=f=E,r&&(d=da(),h=t.apply(l,a),p||u||(a=l=null))}else p=hs(i,n)}function o(){p&&rs(p),u=p=f=E,(v||g!==e)&&(d=da(),h=t.apply(l,a),p||u||(a=l=null))}function s(){if(a=arguments,c=da(),l=this,f=v&&(p||!m),g===!1)var n=m&&!p;else{u||m||(d=c);var r=g-(c-d),s=0>=r||r>g;s?(u&&(u=rs(u)),d=c,h=t.apply(l,a)):u||(u=hs(o,r))}return s&&p?p=rs(p):p||e===g||(p=hs(i,e)),n&&(s=!0,h=t.apply(l,a)),!s||p||u||(a=l=null),h}var a,u,h,c,l,p,f,d=0,g=!1,v=!0;if("function"!=typeof t)throw new Ho(V);if(e=0>e?0:+e||0,n===!0){var m=!0;v=!1}else Ri(n)&&(m=n.leading,g="maxWait"in n&&_s(+n.maxWait||0,e),v="trailing"in n?n.trailing:v);return s.cancel=r,s}function ci(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new Ho(V);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=t.apply(this,r);return n.cache=o.set(i,s),s};return n.cache=new ci.Cache,n}function li(t){if("function"!=typeof t)throw new Ho(V);return function(){return!t.apply(this,arguments)}}function pi(t){return ui(2,t)}function fi(t,e){if("function"!=typeof t)throw new Ho(V);return e=_s(e===E?t.length-1:+e||0,0),function(){for(var n=arguments,r=-1,i=_s(n.length-e,0),o=No(i);++r<i;)o[r]=n[e+r];switch(e){case 0:return t.call(this,o);case 1:return t.call(this,n[0],o);case 2:return t.call(this,n[0],n[1],o)}var s=No(e+1);for(r=-1;++r<e;)s[r]=n[r];return s[e]=o,t.apply(this,s)}}function di(t){if("function"!=typeof t)throw new Ho(V);return function(e){return t.apply(this,e)}}function gi(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new Ho(V);return n===!1?r=!1:Ri(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),qt.leading=r,qt.maxWait=+e,qt.trailing=i,hi(t,e,qt)}function vi(t,e){return e=null==e?wo:e,Ln(e,M,null,[t],[])}function mi(t,e,n,r){return e&&"boolean"!=typeof e&&Kn(t,e,n)?e=!1:"function"==typeof e&&(r=n,n=e,e=!1),"function"==typeof n?be(t,e,on(n,r,1)):be(t,e)}function _i(t,e,n){return"function"==typeof e?be(t,!0,on(e,n,1)):be(t,!0)}function yi(t,e){return t>e}function bi(t,e){return t>=e}function wi(t){return v(t)&&Yn(t)&&$o.call(t)==q}function xi(t){return t===!0||t===!1||v(t)&&$o.call(t)==W}function Ti(t){return v(t)&&$o.call(t)==Y}function Ei(t){return!!t&&1===t.nodeType&&v(t)&&$o.call(t).indexOf("Element")>-1}function Ii(t){return null==t?!0:Yn(t)&&(Ca(t)||Di(t)||wi(t)||v(t)&&Sa(t.splice))?!t.length:!ka(t).length}function Ai(t,e,n,r){n="function"==typeof n?on(n,r,3):E;var i=n?n(t,e):E;return i===E?Ne(t,e,n):!!i}function Ci(t){return v(t)&&"string"==typeof t.message&&$o.call(t)==Q}function Ri(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Si(t,e,n,r){return n="function"==typeof n?on(n,r,3):E,Ue(t,Gn(e),n)}function Oi(t){return Li(t)&&t!=+t}function Mi(t){return null==t?!1:$o.call(t)==K?Zo.test(Qo.call(t)):v(t)&&Lt.test(t)}function zi(t){return null===t}function Li(t){return"number"==typeof t||v(t)&&$o.call(t)==$}function Ni(t){return v(t)&&$o.call(t)==Z}function Di(t){return"string"==typeof t||v(t)&&$o.call(t)==et}function Ui(t){return v(t)&&Jn(t.length)&&!!Vt[$o.call(t)]}function Pi(t){return t===E}function Fi(t,e){return e>t}function ki(t,e){return e>=t}function Gi(t){var e=t?Vs(t):0;return Jn(e)?e?te(t):[]:Ji(t)}function Bi(t){return _e(t,Yi(t))}function Vi(t,e,n){var r=Ns(t);return n&&Kn(t,e,n)&&(e=null),e?ve(r,e):r}function Hi(t){return ze(t,Yi(t))}function qi(t,e,n){var r=null==t?E:Le(t,ur(e),e+"");return r===E?n:r}function ji(t,e){if(null==t)return!1;var n=Ko.call(t,e);if(!n&&!Xn(e)){if(e=ur(e),t=1==e.length?t:Le(t,Ye(e,0,-1)),null==t)return!1;e=xr(e),n=Ko.call(t,e)}return n||Jn(t.length)&&Qn(e,t.length)&&(Ca(t)||wi(t))}function Wi(t,e,n){n&&Kn(t,e,n)&&(e=null);for(var r=-1,i=ka(t),o=i.length,s={};++r<o;){var a=i[r],u=t[a];e?Ko.call(s,u)?s[u].push(a):s[u]=[a]:s[u]=a}return s}function Yi(t){if(null==t)return[];Ri(t)||(t=Go(t));var e=t.length;e=e&&Jn(e)&&(Ca(t)||wi(t))&&e||0;for(var n=t.constructor,r=-1,i="function"==typeof n&&n.prototype===t,o=No(e),s=e>0;++r<e;)o[r]=r+"";for(var a in t)s&&Qn(a,e)||"constructor"==a&&(i||!Ko.call(t,a))||o.push(a);return o}function Qi(t){t=ar(t);for(var e=-1,n=ka(t),r=n.length,i=No(r);++e<r;){var o=n[e];i[e]=[o,t[o]]}return i}function Ki(t,e,n){var r=null==t?E:t[e];return r===E&&(null==t||Xn(e,t)||(e=ur(e),t=1==e.length?t:Le(t,Ye(e,0,-1)),r=null==t?E:t[xr(e)]),r=r===E?n:r),Sa(r)?r.call(t):r}function Xi(t,e,n){if(null==t)return t;var r=e+"";e=null!=t[r]||Xn(e,t)?[r]:ur(e);for(var i=-1,o=e.length,s=o-1,a=t;null!=a&&++i<o;){var u=e[i];Ri(a)&&(i==s?a[u]=n:null==a[u]&&(a[u]=Qn(e[i+1])?[]:{})),a=a[u]}return t}function $i(t,e,n,r){var i=Ca(t)||Ui(t);if(e=Pn(e,r,4),null==n)if(i||Ri(t)){var o=t.constructor;n=i?Ca(t)?new o:[]:Ns(Sa(o)?o.prototype:null)}else n={};return(i?ee:Oe)(t,function(t,r,i){return e(n,t,r,i)}),n}function Ji(t){return Ze(t,ka(t))}function Zi(t){return Ze(t,Yi(t))}function to(t,e,n){return e=+e||0,"undefined"==typeof n?(n=e,e=0):n=+n||0,t>=ys(e,n)&&t<_s(e,n)}function eo(t,e,n){n&&Kn(t,e,n)&&(e=n=null);var r=null==t,i=null==e;if(null==n&&(i&&"boolean"==typeof t?(n=t,t=1):"boolean"==typeof e&&(n=e,i=!0)),r&&i&&(e=1,i=!1),t=+t||0,i?(e=t,t=0):e=+e||0,n||t%1||e%1){var o=Ts();return ys(t+o*(e-t+ss("1e-"+((o+"").length-1))),e)}return je(t,e)}function no(t){return t=a(t),t&&t.charAt(0).toUpperCase()+t.slice(1)}function ro(t){return t=a(t),t&&t.replace(Dt,p).replace(Rt,"")}function io(t,e,n){t=a(t),e+="";var r=t.length;return n=n===E?r:ys(0>n?0:+n||0,r),n-=e.length,n>=0&&t.indexOf(e,n)==n}function oo(t){return t=a(t),t&&yt.test(t)?t.replace(mt,f):t}function so(t){return t=a(t),t&&Ct.test(t)?t.replace(At,"\\$&"):t}function ao(t,e,n){t=a(t),e=+e;var r=t.length;if(r>=e||!vs(e))return t;var i=(e-r)/2,o=is(i),s=ns(i);return n=On("",s,n),n.slice(0,o)+t+n}function uo(t,e,n){return n&&Kn(t,e,n)&&(e=0),xs(t,e)}function ho(t,e){var n="";if(t=a(t),e=+e,1>e||!t||!vs(e))return n;do e%2&&(n+=t),e=is(e/2),t+=t;while(e);return n}function co(t,e,n){return t=a(t),n=null==n?0:ys(0>n?0:+n||0,t.length),t.lastIndexOf(e,n)==n}function lo(t,n,r){var i=e.templateSettings;r&&Kn(t,n,r)&&(n=r=null),t=a(t),n=ge(ve({},r||n),i,de);var o,s,u=ge(ve({},n.imports),i.imports,de),h=ka(u),c=Ze(u,h),l=0,p=n.interpolate||Ut,f="__p += '",g=Bo((n.escape||Ut).source+"|"+p.source+"|"+(p===xt?Ot:Ut).source+"|"+(n.evaluate||Ut).source+"|$","g"),v="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++Bt+"]")+"\n";t.replace(g,function(e,n,r,i,a,u){return r||(r=i),f+=t.slice(l,u).replace(Pt,d),n&&(o=!0,f+="' +\n__e("+n+") +\n'"),a&&(s=!0,f+="';\n"+a+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+e.length,e}),f+="';\n";var m=n.variable;m||(f="with (obj) {\n"+f+"\n}\n"),f=(s?f.replace(ft,""):f).replace(dt,"$1").replace(gt,"$1;"),f="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var _=$a(function(){return Po(h,v+"return "+f).apply(E,c)});if(_.source=f,Ci(_))throw _;return _}function po(t,e,n){var r=t;return(t=a(t))?(n?Kn(r,e,n):null==e)?t.slice(b(t),w(t)+1):(e+="",t.slice(u(t,e),h(t,e)+1)):t}function fo(t,e,n){var r=t;return t=a(t),t?(n?Kn(r,e,n):null==e)?t.slice(b(t)):t.slice(u(t,e+"")):t}function go(t,e,n){var r=t;return t=a(t),t?(n?Kn(r,e,n):null==e)?t.slice(0,w(t)+1):t.slice(0,h(t,e+"")+1):t}function vo(t,e,n){n&&Kn(t,e,n)&&(e=null);var r=D,i=U;if(null!=e)if(Ri(e)){var o="separator"in e?e.separator:o;r="length"in e?+e.length||0:r,i="omission"in e?a(e.omission):i}else r=+e||0;if(t=a(t),r>=t.length)return t;var s=r-i.length;if(1>s)return i;var u=t.slice(0,s);if(null==o)return u+i;if(Ni(o)){if(t.slice(s).search(o)){var h,c,l=t.slice(0,s);for(o.global||(o=Bo(o.source,(Mt.exec(o)||"")+"g")),o.lastIndex=0;h=o.exec(l);)c=h.index;u=u.slice(0,null==c?s:c)}}else if(t.indexOf(o,s)!=s){var p=u.lastIndexOf(o);p>-1&&(u=u.slice(0,p))}return u+i}function mo(t){return t=a(t),t&&_t.test(t)?t.replace(vt,x):t}function _o(t,e,n){return n&&Kn(t,e,n)&&(e=null),t=a(t),t.match(e||Ft)||[]}function yo(t,e,n){return n&&Kn(t,e,n)&&(e=null),v(t)?xo(t):ye(t,e)}function bo(t){return function(){return t}}function wo(t){return t}function xo(t){return Fe(be(t,!0))}function To(t,e){return ke(t,be(e,!0))}function Eo(t,e,n){if(null==n){var r=Ri(e),i=r?ka(e):null,o=i&&i.length?ze(e,i):null;(o?o.length:r)||(o=!1,n=e,e=t,t=this)}o||(o=ze(e,ka(e)));var s=!0,a=-1,u=Sa(t),h=o.length;n===!1?s=!1:Ri(n)&&"chain"in n&&(s=n.chain);for(;++a<h;){var c=o[a],l=e[c];t[c]=l,u&&(t.prototype[c]=function(e){return function(){var n=this.__chain__;if(s||n){var r=t(this.__wrapped__),i=r.__actions__=te(this.__actions__);return i.push({func:e,args:arguments,thisArg:t}),r.__chain__=n,r}var o=[this.value()];return as.apply(o,arguments),e.apply(t,o)}}(l))}return t}function Io(){return t._=Jo,this}function Ao(){}function Co(t){return Xn(t)?Ve(t):He(t)}function Ro(t){return function(e){return Le(t,ur(e),e+"")}}function So(t,e,n){n&&Kn(t,e,n)&&(e=n=null),t=+t||0,n=null==n?1:+n||0,null==e?(e=t,t=0):e=+e||0;for(var r=-1,i=_s(ns((e-t)/(n||1)),0),o=No(i);++r<i;)o[r]=t,t+=n;return o}function Oo(t,e,n){if(t=is(t),1>t||!vs(t))return[];var r=-1,i=No(ys(t,As));for(e=on(e,n,1);++r<t;)As>r?i[r]=e(r):e(r);return i}function Mo(t){var e=++Xo;return a(t)+e}function zo(t,e){return(+t||0)+(+e||0)}function Lo(t,e,n){n&&Kn(t,e,n)&&(e=null);var r=Pn(),i=null==e;return i&&r===ye||(i=!1,e=r(e,n,3)),i?pe(Ca(t)?t:sr(t)):$e(t,e)}t=t?re.defaults(ne.Object(),t,re.pick(ne,Gt)):ne;var No=t.Array,Do=t.Date,Uo=t.Error,Po=t.Function,Fo=t.Math,ko=t.Number,Go=t.Object,Bo=t.RegExp,Vo=t.String,Ho=t.TypeError,qo=No.prototype,jo=Go.prototype,Wo=Vo.prototype,Yo=(Yo=t.window)?Yo.document:null,Qo=Po.prototype.toString,Ko=jo.hasOwnProperty,Xo=0,$o=jo.toString,Jo=t._,Zo=Bo("^"+so(Qo.call(Ko)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ts=Bn(t,"ArrayBuffer"),es=Bn(ts&&new ts(0),"slice"),ns=Fo.ceil,rs=t.clearTimeout,is=Fo.floor,os=Bn(Go,"getPrototypeOf"),ss=t.parseFloat,as=qo.push,us=Bn(t,"Set"),hs=t.setTimeout,cs=qo.splice,ls=Bn(t,"Uint8Array"),ps=Bn(t,"WeakMap"),fs=function(){try{var e=Bn(t,"Float64Array"),n=new e(new ts(10),0,1)&&e}catch(t){}return n||null}(),ds=Bn(Go,"create"),gs=Bn(No,"isArray"),vs=t.isFinite,ms=Bn(Go,"keys"),_s=Fo.max,ys=Fo.min,bs=Bn(Do,"now"),ws=Bn(ko,"isFinite"),xs=t.parseInt,Ts=Fo.random,Es=ko.NEGATIVE_INFINITY,Is=ko.POSITIVE_INFINITY,As=4294967295,Cs=As-1,Rs=As>>>1,Ss=fs?fs.BYTES_PER_ELEMENT:0,Os=9007199254740991,Ms=ps&&new ps,zs={},Ls=e.support={};!function(t){var e=function(){this.x=t},n=[];e.prototype={valueOf:t,y:t};for(var r in new e)n.push(r);try{Ls.dom=11===Yo.createDocumentFragment().nodeType}catch(t){Ls.dom=!1}}(1,0),e.templateSettings={escape:bt,evaluate:wt,interpolate:xt,variable:"",imports:{_:e}};var Ns=function(){function t(){}return function(e){if(Ri(e)){t.prototype=e;var n=new t;t.prototype=null}return n||{}}}(),Ds=ln(Oe),Us=ln(Me,!0),Ps=pn(),Fs=pn(!0),ks=Ms?function(t,e){return Ms.set(t,e),t}:wo;es||(sn=ts&&ls?function(t){var e=t.byteLength,n=fs?is(e/Ss):0,r=n*Ss,i=new ts(e);if(n){var o=new fs(i,0,n);o.set(new fs(t,0,n))}return e!=r&&(o=new ls(i,r),o.set(new ls(t,r))),i}:bo(null));var Gs=ds&&us?function(t){return new $t(t)}:bo(null),Bs=Ms?function(t){return Ms.get(t)}:Ao,Vs=Ve("length"),Hs=function(){var t=0,e=0;return function(n,r){var i=da(),o=F-(i-e);if(e=i,o>0){if(++t>=P)return n}else t=0;return ks(n,r)}}(),qs=fi(function(t,e){return Yn(t)?xe(t,Re(e,!1,!0)):[]}),js=yn(),Ws=yn(!0),Ys=fi(function(t){for(var e=t.length,n=e,r=No(l),i=kn(),s=i==o,a=[];n--;){var u=t[n]=Yn(u=t[n])?u:[];r[n]=s&&u.length>=120?Gs(n&&u):null}var h=t[0],c=-1,l=h?h.length:0,p=r[0];t:for(;++c<l;)if(u=h[c],(p?Jt(p,u):i(a,u,0))<0){for(var n=e;--n;){var f=r[n];if((f?Jt(f,u):i(t[n],u,0))<0)continue t}p&&p.push(u),a.push(u)}return a}),Qs=fi(function(t,e){e=Re(e);var n=me(t,e);return qe(t,e.sort(r)),n}),Ks=zn(),Xs=zn(!0),$s=fi(function(t){return Je(Re(t,!1,!0))}),Js=fi(function(t,e){return Yn(t)?xe(t,e):[]}),Zs=fi(Lr),ta=fi(function(t){var e=t.length,n=e>2?t[e-2]:E,r=e>1?t[e-1]:E;return e>2&&"function"==typeof n?e-=2:(n=e>1&&"function"==typeof r?(--e,r):E,r=E),t.length=e,Nr(t,n,r)}),ea=fi(function(t,e){return me(t,Re(e))}),na=hn(function(t,e,n){Ko.call(t,n)?++t[n]:t[n]=1}),ra=_n(Ds),ia=_n(Us,!0),oa=xn(ee,Ds),sa=xn(ie,Us),aa=hn(function(t,e,n){Ko.call(t,n)?t[n].push(e):t[n]=[e]}),ua=hn(function(t,e,n){t[n]=e}),ha=fi(function(t,e,n){var r=-1,i="function"==typeof e,o=Xn(e),s=Yn(t)?No(t.length):[];return Ds(t,function(t){var a=i?e:o&&null!=t?t[e]:null;s[++r]=a?a.apply(t,n):Wn(t,e,n)}),s}),ca=hn(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),la=Rn(he,Ds),pa=Rn(ce,Us),fa=fi(function(t,e){if(null==t)return[];var n=e[2];return n&&Kn(e[0],e[1],n)&&(e.length=1),Xe(t,Re(e),[])}),da=bs||function(){return(new Do).getTime()},ga=fi(function(t,e,n){var r=A;if(n.length){var i=_(n,ga.placeholder);r|=M}return Ln(t,r,e,n,i)}),va=fi(function(t,e){e=e.length?Re(e):Hi(t);for(var n=-1,r=e.length;++n<r;){var i=e[n];t[i]=Ln(t[i],A,t)}return t}),ma=fi(function(t,e,n){var r=A|C;if(n.length){var i=_(n,ma.placeholder);r|=M}return Ln(e,r,t,n,i)}),_a=vn(S),ya=vn(O),ba=fi(function(t,e){return we(t,1,e)}),wa=fi(function(t,e,n){return we(t,e,n)}),xa=wn(),Ta=wn(!0),Ea=Cn(M),Ia=Cn(z),Aa=fi(function(t,e){return Ln(t,N,null,null,null,Re(e))}),Ca=gs||function(t){return v(t)&&Jn(t.length)&&$o.call(t)==j};Ls.dom||(Ei=function(t){return!!t&&1===t.nodeType&&v(t)&&!Oa(t)});var Ra=ws||function(t){return"number"==typeof t&&vs(t)},Sa=s(/x/)||ls&&!s(ls)?function(t){return $o.call(t)==K}:s,Oa=os?function(t){if(!t||$o.call(t)!=J)return!1;var e=Bn(t,"valueOf"),n=e&&(n=os(e))&&os(n);return n?t==n||os(t)==n:ir(t)}:ir,Ma=cn(function(t,e,n){return n?ge(t,e,n):ve(t,e)}),za=fi(function(t){var e=t[0];return null==e?e:(t.push(fe),Ma.apply(E,t))}),La=bn(Oe),Na=bn(Me),Da=Tn(Ps),Ua=Tn(Fs),Pa=En(Oe),Fa=En(Me),ka=ms?function(t){var e=null==t?null:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&Yn(t)?or(t):Ri(t)?ms(t):[]}:or,Ga=In(!0),Ba=In(),Va=cn(Ge),Ha=fi(function(t,e){if(null==t)return{};if("function"!=typeof e[0]){var e=ue(Re(e),Vo);return er(t,xe(Yi(t),e))}var n=on(e[0],e[1],3);return nr(t,function(t,e,r){return!n(t,e,r)})}),qa=fi(function(t,e){return null==t?{}:"function"==typeof e[0]?nr(t,on(e[0],e[1],3)):er(t,Re(e))}),ja=dn(function(t,e,n){return e=e.toLowerCase(),t+(n?e.charAt(0).toUpperCase()+e.slice(1):e)}),Wa=dn(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Ya=An(),Qa=An(!0);8!=xs(kt+"08")&&(uo=function(t,e,n){return(n?Kn(t,e,n):null==e)?e=0:e&&(e=+e),t=po(t),xs(t,e||(zt.test(t)?16:10))});var Ka=dn(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Xa=dn(function(t,e,n){return t+(n?" ":"")+(e.charAt(0).toUpperCase()+e.slice(1))}),$a=fi(function(t,e){try{return t.apply(E,e)}catch(t){return Ci(t)?t:new Uo(t)}}),Ja=fi(function(t,e){return function(n){return Wn(n,t,e)}}),Za=fi(function(t,e){return function(n){return Wn(t,n,e)}}),tu=mn(yi,Es),eu=mn(Fi,Is);return e.prototype=n.prototype,m.prototype=Ns(n.prototype),m.prototype.constructor=m,X.prototype=Ns(n.prototype),X.prototype.constructor=X,Wt.prototype.delete=Yt,Wt.prototype.get=Qt,Wt.prototype.has=Kt,Wt.prototype.set=Xt,$t.prototype.push=Zt,ci.Cache=Wt,e.after=si,e.ary=ai,e.assign=Ma,e.at=ea,e.before=ui,e.bind=ga,e.bindAll=va,e.bindKey=ma,e.callback=yo,
e.chain=Pr,e.chunk=cr,e.compact=lr,e.constant=bo,e.countBy=na,e.create=Vi,e.curry=_a,e.curryRight=ya,e.debounce=hi,e.defaults=za,e.defer=ba,e.delay=wa,e.difference=qs,e.drop=pr,e.dropRight=fr,e.dropRightWhile=dr,e.dropWhile=gr,e.fill=vr,e.filter=Yr,e.flatten=_r,e.flattenDeep=yr,e.flow=xa,e.flowRight=Ta,e.forEach=oa,e.forEachRight=sa,e.forIn=Da,e.forInRight=Ua,e.forOwn=Pa,e.forOwnRight=Fa,e.functions=Hi,e.groupBy=aa,e.indexBy=ua,e.initial=wr,e.intersection=Ys,e.invert=Wi,e.invoke=ha,e.keys=ka,e.keysIn=Yi,e.map=Xr,e.mapKeys=Ga,e.mapValues=Ba,e.matches=xo,e.matchesProperty=To,e.memoize=ci,e.merge=Va,e.method=Ja,e.methodOf=Za,e.mixin=Eo,e.negate=li,e.omit=Ha,e.once=pi,e.pairs=Qi,e.partial=Ea,e.partialRight=Ia,e.partition=ca,e.pick=qa,e.pluck=$r,e.property=Co,e.propertyOf=Ro,e.pull=Er,e.pullAt=Qs,e.range=So,e.rearg=Aa,e.reject=Jr,e.remove=Ir,e.rest=Ar,e.restParam=fi,e.set=Xi,e.shuffle=ti,e.slice=Cr,e.sortBy=ri,e.sortByAll=fa,e.sortByOrder=ii,e.spread=di,e.take=Rr,e.takeRight=Sr,e.takeRightWhile=Or,e.takeWhile=Mr,e.tap=Fr,e.throttle=gi,e.thru=kr,e.times=Oo,e.toArray=Gi,e.toPlainObject=Bi,e.transform=$i,e.union=$s,e.uniq=zr,e.unzip=Lr,e.unzipWith=Nr,e.values=Ji,e.valuesIn=Zi,e.where=oi,e.without=Js,e.wrap=vi,e.xor=Dr,e.zip=Zs,e.zipObject=Ur,e.zipWith=ta,e.backflow=Ta,e.collect=Xr,e.compose=Ta,e.each=oa,e.eachRight=sa,e.extend=Ma,e.iteratee=yo,e.methods=Hi,e.object=Ur,e.select=Yr,e.tail=Ar,e.unique=zr,Eo(e,e),e.add=zo,e.attempt=$a,e.camelCase=ja,e.capitalize=no,e.clone=mi,e.cloneDeep=_i,e.deburr=ro,e.endsWith=io,e.escape=oo,e.escapeRegExp=so,e.every=Wr,e.find=ra,e.findIndex=js,e.findKey=La,e.findLast=ia,e.findLastIndex=Ws,e.findLastKey=Na,e.findWhere=Qr,e.first=mr,e.get=qi,e.gt=yi,e.gte=bi,e.has=ji,e.identity=wo,e.includes=Kr,e.indexOf=br,e.inRange=to,e.isArguments=wi,e.isArray=Ca,e.isBoolean=xi,e.isDate=Ti,e.isElement=Ei,e.isEmpty=Ii,e.isEqual=Ai,e.isError=Ci,e.isFinite=Ra,e.isFunction=Sa,e.isMatch=Si,e.isNaN=Oi,e.isNative=Mi,e.isNull=zi,e.isNumber=Li,e.isObject=Ri,e.isPlainObject=Oa,e.isRegExp=Ni,e.isString=Di,e.isTypedArray=Ui,e.isUndefined=Pi,e.kebabCase=Wa,e.last=xr,e.lastIndexOf=Tr,e.lt=Fi,e.lte=ki,e.max=tu,e.min=eu,e.noConflict=Io,e.noop=Ao,e.now=da,e.pad=ao,e.padLeft=Ya,e.padRight=Qa,e.parseInt=uo,e.random=eo,e.reduce=la,e.reduceRight=pa,e.repeat=ho,e.result=Ki,e.runInContext=T,e.size=ei,e.snakeCase=Ka,e.some=ni,e.sortedIndex=Ks,e.sortedLastIndex=Xs,e.startCase=Xa,e.startsWith=co,e.sum=Lo,e.template=lo,e.trim=po,e.trimLeft=fo,e.trimRight=go,e.trunc=vo,e.unescape=mo,e.uniqueId=Mo,e.words=_o,e.all=Wr,e.any=ni,e.contains=Kr,e.eq=Ai,e.detect=ra,e.foldl=la,e.foldr=pa,e.head=mr,e.include=Kr,e.inject=la,Eo(e,function(){var t={};return Oe(e,function(n,r){e.prototype[r]||(t[r]=n)}),t}(),!1),e.sample=Zr,e.prototype.sample=function(t){return this.__chain__||null!=t?this.thru(function(e){return Zr(e,t)}):Zr(this.value())},e.VERSION=I,ee(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){e[t].placeholder=e}),ee(["dropWhile","filter","map","takeWhile"],function(t,e){var n=e!=B,r=e==k;X.prototype[t]=function(t,i){var o=this.__filtered__,s=o&&r?new X(this):this.clone(),a=s.__iteratees__||(s.__iteratees__=[]);return a.push({done:!1,count:0,index:0,iteratee:Pn(t,i,1),limit:-1,type:e}),s.__filtered__=o||n,s}}),ee(["drop","take"],function(t,e){var n=t+"While";X.prototype[t]=function(n){var r=this.__filtered__,i=r&&!e?this.dropWhile():this.clone();if(n=null==n?1:_s(is(n)||0,0),r)e?i.__takeCount__=ys(i.__takeCount__,n):xr(i.__iteratees__).limit=n;else{var o=i.__views__||(i.__views__=[]);o.push({size:n,type:t+(i.__dir__<0?"Right":"")})}return i},X.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()},X.prototype[t+"RightWhile"]=function(t,e){return this.reverse()[n](t,e).reverse()}}),ee(["first","last"],function(t,e){var n="take"+(e?"Right":"");X.prototype[t]=function(){return this[n](1).value()[0]}}),ee(["initial","rest"],function(t,e){var n="drop"+(e?"":"Right");X.prototype[t]=function(){return this[n](1)}}),ee(["pluck","where"],function(t,e){var n=e?"filter":"map",r=e?Fe:Co;X.prototype[t]=function(t){return this[n](r(t))}}),X.prototype.compact=function(){return this.filter(wo)},X.prototype.reject=function(t,e){return t=Pn(t,e,1),this.filter(function(e){return!t(e)})},X.prototype.slice=function(t,e){t=null==t?0:+t||0;var n=this;return 0>t?n=this.takeRight(-t):t&&(n=this.drop(t)),e!==E&&(e=+e||0,n=0>e?n.dropRight(-e):n.take(e-t)),n},X.prototype.toArray=function(){return this.drop(0)},Oe(X.prototype,function(t,n){var r=e[n];if(r){var i=/^(?:filter|map|reject)|While$/.test(n),o=/^(?:first|last)$/.test(n);e.prototype[n]=function(){var n=arguments,s=this.__chain__,a=this.__wrapped__,u=!!this.__actions__.length,h=a instanceof X,c=n[0],l=h||Ca(a);l&&i&&"function"==typeof c&&1!=c.length&&(h=l=!1);var p=h&&!u;if(o&&!s)return p?t.call(a):r.call(e,this.value());var f=function(t){var i=[t];return as.apply(i,n),r.apply(e,i)};if(l){var d=p?a:new X(this),g=t.apply(d,n);if(!o&&(u||g.__actions__)){var v=g.__actions__||(g.__actions__=[]);v.push({func:kr,args:[f],thisArg:e})}return new m(g,s)}return this.thru(f)}}}),ee(["concat","join","pop","push","replace","shift","sort","splice","split","unshift"],function(t){var n=(/^(?:replace|split)$/.test(t)?Wo:qo)[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:join|pop|replace|shift)$/.test(t);e.prototype[t]=function(){var t=arguments;return i&&!this.__chain__?n.apply(this.value(),t):this[r](function(e){return n.apply(e,t)})}}),Oe(X.prototype,function(t,n){var r=e[n];if(r){var i=r.name,o=zs[i]||(zs[i]=[]);o.push({name:n,func:r})}}),zs[Sn(null,C).name]=[{name:"wrapper",func:null}],X.prototype.clone=tt,X.prototype.reverse=nt,X.prototype.value=jt,e.prototype.chain=Gr,e.prototype.commit=Br,e.prototype.plant=Vr,e.prototype.reverse=Hr,e.prototype.toString=qr,e.prototype.run=e.prototype.toJSON=e.prototype.valueOf=e.prototype.value=jr,e.prototype.collect=e.prototype.map,e.prototype.head=e.prototype.first,e.prototype.select=e.prototype.filter,e.prototype.tail=e.prototype.rest,e}var E,I="3.9.3",A=1,C=2,R=4,S=8,O=16,M=32,z=64,L=128,N=256,D=30,U="...",P=150,F=16,k=0,G=1,B=2,V="Expected a function",H="__lodash_placeholder__",q="[object Arguments]",j="[object Array]",W="[object Boolean]",Y="[object Date]",Q="[object Error]",K="[object Function]",X="[object Map]",$="[object Number]",J="[object Object]",Z="[object RegExp]",tt="[object Set]",et="[object String]",nt="[object WeakMap]",rt="[object ArrayBuffer]",it="[object Float32Array]",ot="[object Float64Array]",st="[object Int8Array]",at="[object Int16Array]",ut="[object Int32Array]",ht="[object Uint8Array]",ct="[object Uint8ClampedArray]",lt="[object Uint16Array]",pt="[object Uint32Array]",ft=/\b__p \+= '';/g,dt=/\b(__p \+=) '' \+/g,gt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,vt=/&(?:amp|lt|gt|quot|#39|#96);/g,mt=/[&<>"'`]/g,_t=RegExp(vt.source),yt=RegExp(mt.source),bt=/<%-([\s\S]+?)%>/g,wt=/<%([\s\S]+?)%>/g,xt=/<%=([\s\S]+?)%>/g,Tt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,Et=/^\w*$/,It=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,At=/[.*+?^${}()|[\]\/\\]/g,Ct=RegExp(At.source),Rt=/[\u0300-\u036f\ufe20-\ufe23]/g,St=/\\(\\)?/g,Ot=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Mt=/\w*$/,zt=/^0[xX]/,Lt=/^\[object .+?Constructor\]$/,Nt=/^\d+$/,Dt=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Ut=/($^)/,Pt=/['\n\r\u2028\u2029\\]/g,Ft=function(){var t="[A-Z\\xc0-\\xd6\\xd8-\\xde]",e="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(t+"+(?="+t+e+")|"+t+"?"+e+"|"+t+"+|[0-9]+","g")}(),kt=" 	\f \ufeff\n\r\u2028\u2029 ᠎             　",Gt=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","document","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","window"],Bt=-1,Vt={};Vt[it]=Vt[ot]=Vt[st]=Vt[at]=Vt[ut]=Vt[ht]=Vt[ct]=Vt[lt]=Vt[pt]=!0,Vt[q]=Vt[j]=Vt[rt]=Vt[W]=Vt[Y]=Vt[Q]=Vt[K]=Vt[X]=Vt[$]=Vt[J]=Vt[Z]=Vt[tt]=Vt[et]=Vt[nt]=!1;var Ht={};Ht[q]=Ht[j]=Ht[rt]=Ht[W]=Ht[Y]=Ht[it]=Ht[ot]=Ht[st]=Ht[at]=Ht[ut]=Ht[$]=Ht[J]=Ht[Z]=Ht[et]=Ht[ht]=Ht[ct]=Ht[lt]=Ht[pt]=!0,Ht[Q]=Ht[K]=Ht[X]=Ht[tt]=Ht[nt]=!1;var qt={leading:!1,maxWait:0,trailing:!1},jt={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Wt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Yt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Qt={function:!0,object:!0},Kt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Xt=Qt[typeof n]&&n&&!n.nodeType&&n,$t=Qt[typeof e]&&e&&!e.nodeType&&e,Jt=Xt&&$t&&"object"==typeof t&&t&&t.Object&&t,Zt=Qt[typeof self]&&self&&self.Object&&self,te=Qt[typeof window]&&window&&window.Object&&window,ee=$t&&$t.exports===Xt&&Xt,ne=Jt||te!==(this&&this.window)&&te||Zt||this,re=T();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(ne._=re,define(function(){return re})):Xt&&$t?ee?($t.exports=re)._=re:Xt._=re:ne._=re}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],152:[function(t,e,n){(function(t){(function(){function r(t,e){if(t!==e){var n=null===t,r=t===I,i=t===t,o=null===e,s=e===I,a=e===e;if(t>e&&!o||!i||n&&!s&&a||r&&a)return 1;if(e>t&&!n||!a||o&&!r&&i||s&&i)return-1}return 0}function i(t,e,n){for(var r=t.length,i=n?r:-1;n?i--:++i<r;)if(e(t[i],i,t))return i;return-1}function o(t,e,n){if(e!==e)return v(t,n);for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function s(t){return"function"==typeof t||!1}function a(t){return null==t?"":t+""}function u(t,e){for(var n=-1,r=t.length;++n<r&&e.indexOf(t.charAt(n))>-1;);return n}function h(t,e){for(var n=t.length;n--&&e.indexOf(t.charAt(n))>-1;);return n}function c(t,e){return r(t.criteria,e.criteria)||t.index-e.index}function l(t,e,n){for(var i=-1,o=t.criteria,s=e.criteria,a=o.length,u=n.length;++i<a;){var h=r(o[i],s[i]);if(h){if(i>=u)return h;var c=n[i];return h*("asc"===c||c===!0?1:-1)}}return t.index-e.index}function p(t){return qt[t]}function f(t){return jt[t]}function d(t,e,n){return e?t=Qt[t]:n&&(t=Kt[t]),"\\"+t}function g(t){return"\\"+Kt[t]}function v(t,e,n){for(var r=t.length,i=e+(n?0:-1);n?i--:++i<r;){var o=t[i];if(o!==o)return i}return-1}function m(t){return!!t&&"object"==typeof t}function _(t){return 160>=t&&t>=9&&13>=t||32==t||160==t||5760==t||6158==t||t>=8192&&(8202>=t||8232==t||8233==t||8239==t||8287==t||12288==t||65279==t)}function y(t,e){for(var n=-1,r=t.length,i=-1,o=[];++n<r;)t[n]===e&&(t[n]=q,o[++i]=n);return o}function b(t,e){for(var n,r=-1,i=t.length,o=-1,s=[];++r<i;){var a=t[r],u=e?e(a,r,t):a;r&&n===u||(n=u,s[++o]=a)}return s}function w(t){for(var e=-1,n=t.length;++e<n&&_(t.charCodeAt(e)););return e}function x(t){for(var e=t.length;e--&&_(t.charCodeAt(e)););return e}function T(t){return Wt[t]}function E(t){function e(t){if(m(t)&&!Sa(t)&&!(t instanceof $)){if(t instanceof _)return t;if(es.call(t,"__chain__")&&es.call(t,"__wrapped__"))return fr(t)}return new _(t)}function n(){}function _(t,e,n){this.__wrapped__=t,this.__actions__=n||[],this.__chain__=!!e}function $(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Rs,this.__views__=[]}function et(){var t=new $(this.__wrapped__);return t.__actions__=te(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=te(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=te(this.__views__),t}function rt(){if(this.__filtered__){var t=new $(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function qt(){var t=this.__wrapped__.value(),e=this.__dir__,n=Sa(t),r=0>e,i=n?t.length:0,o=Wn(0,i,this.__views__),s=o.start,a=o.end,u=a-s,h=r?a:s-1,c=this.__iteratees__,l=c.length,p=0,f=Ts(u,this.__takeCount__);if(!n||G>i||i==u&&f==u)return nn(r&&n?t.reverse():t,this.__actions__);var d=[];t:for(;u--&&f>p;){h+=e;for(var g=-1,v=t[h];++g<l;){var m=c[g],_=m.iteratee,y=m.type,b=_(v);if(y==V)v=b;else if(!b){if(y==B)continue t;break t}}d[p++]=v}return d}function jt(){this.__data__={}}function Wt(t){return this.has(t)&&delete this.__data__[t]}function Yt(t){return"__proto__"==t?I:this.__data__[t]}function Qt(t){return"__proto__"!=t&&es.call(this.__data__,t)}function Kt(t,e){return"__proto__"!=t&&(this.__data__[t]=e),this}function Xt(t){var e=t?t.length:0;for(this.data={hash:ms(null),set:new ls};e--;)this.push(t[e])}function $t(t,e){var n=t.data,r="string"==typeof e||Ni(e)?n.set.has(e):n.hash[e];return r?0:-1}function Jt(t){var e=this.data;"string"==typeof t||Ni(t)?e.set.add(t):e.hash[t]=!0}function Zt(t,e){for(var n=-1,r=t.length,i=-1,o=e.length,s=Bo(r+o);++n<r;)s[n]=t[n];for(;++i<o;)s[n++]=e[i];return s}function te(t,e){var n=-1,r=t.length;for(e||(e=Bo(r));++n<r;)e[n]=t[n];return e}function ee(t,e){for(var n=-1,r=t.length;++n<r&&e(t[n],n,t)!==!1;);return t}function ie(t,e){for(var n=t.length;n--&&e(t[n],n,t)!==!1;);return t}function oe(t,e){for(var n=-1,r=t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function se(t,e,n,r){for(var i=-1,o=t.length,s=r,a=s;++i<o;){var u=t[i],h=+e(u);n(h,s)&&(s=h,a=u)}return a}function ae(t,e){for(var n=-1,r=t.length,i=-1,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[++i]=s)}return o}function ue(t,e){for(var n=-1,r=t.length,i=Bo(r);++n<r;)i[n]=e(t[n],n,t);return i}function he(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function ce(t,e,n,r){var i=-1,o=t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function le(t,e,n,r){var i=t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function pe(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function fe(t,e){for(var n=t.length,r=0;n--;)r+=+e(t[n])||0;return r}function de(t,e){return t===I?e:t}function ge(t,e,n,r){return t!==I&&es.call(r,n)?t:e}function ve(t,e,n){for(var r=-1,i=Ga(e),o=i.length;++r<o;){var s=i[r],a=t[s],u=n(a,e[s],s,t,e);(u===u?u===a:a!==a)&&(a!==I||s in t)||(t[s]=u)}return t}function me(t,e){return null==e?t:ye(e,Ga(e),t)}function _e(t,e){for(var n=-1,r=null==t,i=!r&&$n(t),o=i?t.length:0,s=e.length,a=Bo(s);++n<s;){var u=e[n];i?a[n]=Jn(u,o)?t[u]:I:a[n]=r?I:t[u]}return a}function ye(t,e,n){n||(n={});for(var r=-1,i=e.length;++r<i;){var o=e[r];n[o]=t[o]}return n}function be(t,e,n){var r=typeof t;return"function"==r?e===I?t:sn(t,e,n):null==t?Ro:"object"==r?ke(t):e===I?No(t):Ge(t,e)}function we(t,e,n,r,i,o,s){var a;if(n&&(a=i?n(t,r,i):n(t)),a!==I)return a;if(!Ni(t))return t;var u=Sa(t);if(u){if(a=Yn(t),!e)return te(t,a)}else{var h=rs.call(t),c=h==X;if(h!=Z&&h!=j&&(!c||i))return Ht[h]?Kn(t,h,e):i?t:{};if(a=Qn(c?{}:t),!e)return me(a,t)}o||(o=[]),s||(s=[]);for(var l=o.length;l--;)if(o[l]==t)return s[l];return o.push(t),s.push(a),(u?ee:Me)(t,function(r,i){a[i]=we(r,e,n,i,t,o,s)}),a}function xe(t,e,n){if("function"!=typeof t)throw new Xo(H);return ps(function(){t.apply(I,n)},e)}function Te(t,e){var n=t?t.length:0,r=[];if(!n)return r;var i=-1,s=Hn(),a=s==o,u=a&&e.length>=G?gn(e):null,h=e.length;u&&(s=$t,a=!1,e=u);t:for(;++i<n;){var c=t[i];if(a&&c===c){for(var l=h;l--;)if(e[l]===c)continue t;r.push(c)}else s(e,c,0)<0&&r.push(c)}return r}function Ee(t,e){var n=!0;return Us(t,function(t,r,i){return n=!!e(t,r,i)}),n}function Ie(t,e,n,r){var i=r,o=i;return Us(t,function(t,s,a){var u=+e(t,s,a);(n(u,i)||u===r&&u===o)&&(i=u,o=t)}),o}function Ae(t,e,n,r){var i=t.length;for(n=null==n?0:+n||0,0>n&&(n=-n>i?0:i+n),r=r===I||r>i?i:+r||0,0>r&&(r+=i),i=n>r?0:r>>>0,n>>>=0;i>n;)t[n++]=e;return t}function Ce(t,e){var n=[];return Us(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function Re(t,e,n,r){var i;return n(t,function(t,n,o){return e(t,n,o)?(i=r?n:t,!1):void 0}),i}function Se(t,e,n,r){r||(r=[]);for(var i=-1,o=t.length;++i<o;){var s=t[i];m(s)&&$n(s)&&(n||Sa(s)||Ii(s))?e?Se(s,e,n,r):he(r,s):n||(r[r.length]=s)}return r}function Oe(t,e){return Fs(t,e,to)}function Me(t,e){return Fs(t,e,Ga)}function ze(t,e){return ks(t,e,Ga)}function Le(t,e){for(var n=-1,r=e.length,i=-1,o=[];++n<r;){var s=e[n];Li(t[s])&&(o[++i]=s)}return o}function Ne(t,e,n){if(null!=t){n!==I&&n in lr(t)&&(e=[n]);for(var r=0,i=e.length;null!=t&&i>r;)t=t[e[r++]];return r&&r==i?t:I}}function De(t,e,n,r,i,o){return t===e?!0:null==t||null==e||!Ni(t)&&!m(e)?t!==t&&e!==e:Ue(t,e,De,n,r,i,o)}function Ue(t,e,n,r,i,o,s){var a=Sa(t),u=Sa(e),h=W,c=W;a||(h=rs.call(t),h==j?h=Z:h!=Z&&(a=Hi(t))),u||(c=rs.call(e),c==j?c=Z:c!=Z&&(u=Hi(e)));var l=h==Z,p=c==Z,f=h==c;if(f&&!a&&!l)return kn(t,e,h);if(!i){var d=l&&es.call(t,"__wrapped__"),g=p&&es.call(e,"__wrapped__");if(d||g)return n(d?t.value():t,g?e.value():e,r,i,o,s)}if(!f)return!1;o||(o=[]),s||(s=[]);for(var v=o.length;v--;)if(o[v]==t)return s[v]==e;o.push(t),s.push(e);var m=(a?Fn:Gn)(t,e,n,r,i,o,s);return o.pop(),s.pop(),m}function Pe(t,e,n){var r=e.length,i=r,o=!n;if(null==t)return!i;for(t=lr(t);r--;){var s=e[r];if(o&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++r<i;){s=e[r];var a=s[0],u=t[a],h=s[1];if(o&&s[2]){if(u===I&&!(a in t))return!1}else{var c=n?n(u,h,a):I;if(!(c===I?De(h,u,n,!0):c))return!1}}return!0}function Fe(t,e){var n=-1,r=$n(t)?Bo(t.length):[];return Us(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function ke(t){var e=qn(t);if(1==e.length&&e[0][2]){var n=e[0][0],r=e[0][1];return function(t){return null==t?!1:t[n]===r&&(r!==I||n in lr(t))}}return function(t){return Pe(t,e)}}function Ge(t,e){var n=Sa(t),r=tr(t)&&rr(e),i=t+"";return t=pr(t),function(o){if(null==o)return!1;var s=i;if(o=lr(o),!(!n&&r||s in o)){if(o=1==t.length?o:Ne(o,Qe(t,0,-1)),null==o)return!1;s=Ar(t),o=lr(o)}return o[s]===e?e!==I||s in o:De(e,o[s],I,!0)}}function Be(t,e,n,r,i){if(!Ni(t))return t;var o=$n(e)&&(Sa(e)||Hi(e)),s=o?I:Ga(e);return ee(s||e,function(a,u){if(s&&(u=a,a=e[u]),m(a))r||(r=[]),i||(i=[]),Ve(t,e,u,Be,n,r,i);else{var h=t[u],c=n?n(h,a,u,t,e):I,l=c===I;l&&(c=a),c===I&&(!o||u in t)||!l&&(c===c?c===h:h!==h)||(t[u]=c)}}),t}function Ve(t,e,n,r,i,o,s){for(var a=o.length,u=e[n];a--;)if(o[a]==u)return void(t[n]=s[a]);var h=t[n],c=i?i(h,u,n,t,e):I,l=c===I;l&&(c=u,$n(u)&&(Sa(u)||Hi(u))?c=Sa(h)?h:$n(h)?te(h):[]:Gi(u)||Ii(u)?c=Ii(h)?Qi(h):Gi(h)?h:{}:l=!1),o.push(u),s.push(c),l?t[n]=r(c,u,i,o,s):(c===c?c!==h:h===h)&&(t[n]=c)}function He(t){return function(e){return null==e?I:e[t]}}function qe(t){var e=t+"";return t=pr(t),function(n){return Ne(n,t,e)}}function je(t,e){for(var n=t?e.length:0;n--;){var r=e[n];if(r!=i&&Jn(r)){var i=r;fs.call(t,r,1)}}return t}function We(t,e){return t+_s(As()*(e-t+1))}function Ye(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function Qe(t,e,n){var r=-1,i=t.length;e=null==e?0:+e||0,0>e&&(e=-e>i?0:i+e),n=n===I||n>i?i:+n||0,0>n&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=Bo(i);++r<i;)o[r]=t[r+e];return o}function Ke(t,e){var n;return Us(t,function(t,r,i){return n=e(t,r,i),!n}),!!n}function Xe(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function $e(t,e,n){var r=Bn(),i=-1;e=ue(e,function(t){return r(t)});var o=Fe(t,function(t){var n=ue(e,function(e){return e(t)});return{criteria:n,index:++i,value:t}});return Xe(o,function(t,e){return l(t,e,n)})}function Je(t,e){var n=0;return Us(t,function(t,r,i){n+=+e(t,r,i)||0}),n}function Ze(t,e){var n=-1,r=Hn(),i=t.length,s=r==o,a=s&&i>=G,u=a?gn():null,h=[];u?(r=$t,s=!1):(a=!1,u=e?[]:h);t:for(;++n<i;){var c=t[n],l=e?e(c,n,t):c;if(s&&c===c){for(var p=u.length;p--;)if(u[p]===l)continue t;e&&u.push(l),h.push(c)}else r(u,l,0)<0&&((e||a)&&u.push(l),h.push(c))}return h}function tn(t,e){for(var n=-1,r=e.length,i=Bo(r);++n<r;)i[n]=t[e[n]];return i}function en(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?Qe(t,r?0:o,r?o+1:i):Qe(t,r?o+1:0,r?i:o)}function nn(t,e){var n=t;n instanceof $&&(n=n.value());for(var r=-1,i=e.length;++r<i;){var o=e[r];n=o.func.apply(o.thisArg,he([n],o.args))}return n}function rn(t,e,n){var r=0,i=t?t.length:r;if("number"==typeof e&&e===e&&Ms>=i){for(;i>r;){var o=r+i>>>1,s=t[o];(n?e>=s:e>s)&&null!==s?r=o+1:i=o}return i}return on(t,e,Ro,n)}function on(t,e,n,r){e=n(e);for(var i=0,o=t?t.length:0,s=e!==e,a=null===e,u=e===I;o>i;){var h=_s((i+o)/2),c=n(t[h]),l=c!==I,p=c===c;if(s)var f=p||r;else f=a?p&&l&&(r||null!=c):u?p&&(r||l):null==c?!1:r?e>=c:e>c;f?i=h+1:o=h}return Ts(o,Os)}function sn(t,e,n){if("function"!=typeof t)return Ro;if(e===I)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)};case 5:return function(n,r,i,o,s){return t.call(e,n,r,i,o,s)}}return function(){return t.apply(e,arguments)}}function an(t){var e=new ss(t.byteLength),n=new ds(e);return n.set(new ds(t)),e}function un(t,e,n){for(var r=n.length,i=-1,o=xs(t.length-r,0),s=-1,a=e.length,u=Bo(a+o);++s<a;)u[s]=e[s];for(;++i<r;)u[n[i]]=t[i];for(;o--;)u[s++]=t[i++];return u}function hn(t,e,n){for(var r=-1,i=n.length,o=-1,s=xs(t.length-i,0),a=-1,u=e.length,h=Bo(s+u);++o<s;)h[o]=t[o];for(var c=o;++a<u;)h[c+a]=e[a];for(;++r<i;)h[c+n[r]]=t[o++];return h}function cn(t,e){return function(n,r,i){var o=e?e():{};if(r=Bn(r,i,3),Sa(n))for(var s=-1,a=n.length;++s<a;){var u=n[s];t(o,u,r(u,s,n),n)}else Us(n,function(e,n,i){t(o,e,r(e,n,i),i)});return o}}function ln(t){return mi(function(e,n){var r=-1,i=null==e?0:n.length,o=i>2?n[i-2]:I,s=i>2?n[2]:I,a=i>1?n[i-1]:I;for("function"==typeof o?(o=sn(o,a,5),i-=2):(o="function"==typeof a?a:I,i-=o?1:0),s&&Zn(n[0],n[1],s)&&(o=3>i?I:o,i=1);++r<i;){var u=n[r];u&&t(e,u,o)}return e})}function pn(t,e){return function(n,r){var i=n?Vs(n):0;if(!nr(i))return t(n,r);for(var o=e?i:-1,s=lr(n);(e?o--:++o<i)&&r(s[o],o,s)!==!1;);return n}}function fn(t){return function(e,n,r){for(var i=lr(e),o=r(e),s=o.length,a=t?s:-1;t?a--:++a<s;){var u=o[a];if(n(i[u],u,i)===!1)break}return e}}function dn(t,e){function n(){var i=this&&this!==ne&&this instanceof n?r:t;return i.apply(e,arguments)}var r=mn(t);return n}function gn(t){return ms&&ls?new Xt(t):null}function vn(t){return function(e){for(var n=-1,r=Io(co(e)),i=r.length,o="";++n<i;)o=t(o,r[n],n);return o}}function mn(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Ds(t.prototype),r=t.apply(n,e);return Ni(r)?r:n}}function _n(t){function e(n,r,i){i&&Zn(n,r,i)&&(r=I);var o=Pn(n,t,I,I,I,I,I,r);return o.placeholder=e.placeholder,o}return e}function yn(t,e){return mi(function(n){var r=n[0];return null==r?r:(n.push(e),t.apply(I,n))})}function bn(t,e){return function(n,r,i){if(i&&Zn(n,r,i)&&(r=I),r=Bn(r,i,3),1==r.length){n=Sa(n)?n:cr(n);var o=se(n,r,t,e);if(!n.length||o!==e)return o}return Ie(n,r,t,e)}}function wn(t,e){return function(n,r,o){if(r=Bn(r,o,3),Sa(n)){var s=i(n,r,e);return s>-1?n[s]:I}return Re(n,r,t)}}function xn(t){return function(e,n,r){return e&&e.length?(n=Bn(n,r,3),i(e,n,t)):-1}}function Tn(t){return function(e,n,r){return n=Bn(n,r,3),Re(e,n,t,!0)}}function En(t){return function(){for(var e,n=arguments.length,r=t?n:-1,i=0,o=Bo(n);t?r--:++r<n;){var s=o[i++]=arguments[r];if("function"!=typeof s)throw new Xo(H);!e&&_.prototype.thru&&"wrapper"==Vn(s)&&(e=new _([],!0))}for(r=e?-1:n;++r<n;){s=o[r];var a=Vn(s),u="wrapper"==a?Bs(s):I;e=u&&er(u[0])&&u[1]==(N|O|z|D)&&!u[4].length&&1==u[9]?e[Vn(u[0])].apply(e,u[3]):1==s.length&&er(s)?e[a]():e.thru(s)}return function(){var t=arguments,r=t[0];if(e&&1==t.length&&Sa(r)&&r.length>=G)return e.plant(r).value();for(var i=0,s=n?o[i].apply(this,t):r;++i<n;)s=o[i].call(this,s);return s}}}function In(t,e){return function(n,r,i){return"function"==typeof r&&i===I&&Sa(n)?t(n,r):e(n,sn(r,i,3))}}function An(t){return function(e,n,r){return("function"!=typeof n||r!==I)&&(n=sn(n,r,3)),t(e,n,to)}}function Cn(t){return function(e,n,r){return("function"!=typeof n||r!==I)&&(n=sn(n,r,3)),t(e,n)}}function Rn(t){return function(e,n,r){var i={};return n=Bn(n,r,3),Me(e,function(e,r,o){var s=n(e,r,o);r=t?s:r,e=t?e:s,i[r]=e}),i}}function Sn(t){return function(e,n,r){return e=a(e),(t?e:"")+Ln(e,n,r)+(t?"":e)}}function On(t){var e=mi(function(n,r){var i=y(r,e.placeholder);return Pn(n,t,I,r,i)});return e}function Mn(t,e){return function(n,r,i,o){var s=arguments.length<3;return"function"==typeof r&&o===I&&Sa(n)?t(n,r,i,s):Ye(n,Bn(r,o,4),i,s,e)}}function zn(t,e,n,r,i,o,s,a,u,h){function c(){for(var _=arguments.length,b=_,w=Bo(_);b--;)w[b]=arguments[b];if(r&&(w=un(w,r,i)),o&&(w=hn(w,o,s)),d||v){var x=c.placeholder,T=y(w,x);if(_-=T.length,h>_){var E=a?te(a):I,A=xs(h-_,0),S=d?T:I,O=d?I:T,M=d?w:I,N=d?I:w;e|=d?z:L,e&=~(d?L:z),g||(e&=~(C|R));var D=[t,e,n,M,S,N,O,E,u,A],U=zn.apply(I,D);return er(t)&&Hs(U,D),U.placeholder=x,U}}var P=p?n:this,F=f?P[t]:t;return a&&(w=ur(w,a)),l&&u<w.length&&(w.length=u),this&&this!==ne&&this instanceof c&&(F=m||mn(t)),F.apply(P,w)}var l=e&N,p=e&C,f=e&R,d=e&O,g=e&S,v=e&M,m=f?I:mn(t);return c}function Ln(t,e,n){var r=t.length;if(e=+e,r>=e||!bs(e))return"";var i=e-r;return n=null==n?" ":n+"",mo(n,vs(i/n.length)).slice(0,i)}function Nn(t,e,n,r){function i(){for(var e=-1,a=arguments.length,u=-1,h=r.length,c=Bo(h+a);++u<h;)c[u]=r[u];for(;a--;)c[u++]=arguments[++e];var l=this&&this!==ne&&this instanceof i?s:t;return l.apply(o?n:this,c)}var o=e&C,s=mn(t);return i}function Dn(t){var e=jo[t];return function(t,n){return n=n===I?0:+n||0,n?(n=hs(10,n),e(t*n)/n):e(t)}}function Un(t){return function(e,n,r,i){var o=Bn(r);return null==r&&o===be?rn(e,n,t):on(e,n,o(r,i,1),t)}}function Pn(t,e,n,r,i,o,s,a){var u=e&R;if(!u&&"function"!=typeof t)throw new Xo(H);var h=r?r.length:0;if(h||(e&=~(z|L),r=i=I),h-=i?i.length:0,e&L){var c=r,l=i;r=i=I}var p=u?I:Bs(t),f=[t,e,n,r,i,c,l,o,s,a];if(p&&(ir(f,p),e=f[1],a=f[9]),f[9]=null==a?u?0:t.length:xs(a-h,0)||0,e==C)var d=dn(f[0],f[2]);else d=e!=z&&e!=(C|z)||f[4].length?zn.apply(I,f):Nn.apply(I,f);var g=p?Gs:Hs;return g(d,f)}function Fn(t,e,n,r,i,o,s){var a=-1,u=t.length,h=e.length;if(u!=h&&!(i&&h>u))return!1;for(;++a<u;){var c=t[a],l=e[a],p=r?r(i?l:c,i?c:l,a):I;if(p!==I){if(p)continue;return!1}if(i){if(!pe(e,function(t){return c===t||n(c,t,r,i,o,s)}))return!1}else if(c!==l&&!n(c,l,r,i,o,s))return!1}return!0}function kn(t,e,n){switch(n){case Y:case Q:return+t==+e;case K:return t.name==e.name&&t.message==e.message;case J:return t!=+t?e!=+e:t==+e;case tt:case nt:return t==e+""}return!1}function Gn(t,e,n,r,i,o,s){var a=Ga(t),u=a.length,h=Ga(e),c=h.length;if(u!=c&&!i)return!1;for(var l=u;l--;){var p=a[l];if(!(i?p in e:es.call(e,p)))return!1}for(var f=i;++l<u;){p=a[l];var d=t[p],g=e[p],v=r?r(i?g:d,i?d:g,p):I;if(!(v===I?n(d,g,r,i,o,s):v))return!1;f||(f="constructor"==p)}if(!f){var m=t.constructor,_=e.constructor;if(m!=_&&"constructor"in t&&"constructor"in e&&!("function"==typeof m&&m instanceof m&&"function"==typeof _&&_ instanceof _))return!1}return!0}function Bn(t,n,r){var i=e.callback||Ao;return i=i===Ao?be:i,r?i(t,n,r):i}function Vn(t){for(var e=t.name,n=Ns[e],r=n?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function Hn(t,n,r){var i=e.indexOf||Er;return i=i===Er?o:i,t?i(t,n,r):i}function qn(t){for(var e=eo(t),n=e.length;n--;)e[n][2]=rr(e[n][1]);return e}function jn(t,e){var n=null==t?I:t[e];return Pi(n)?n:I}function Wn(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=Ts(e,t+s);break;case"takeRight":t=xs(t,e-s)}}return{start:t,end:e}}function Yn(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&es.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Qn(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=Yo),new e}function Kn(t,e,n){var r=t.constructor;switch(e){case it:return an(t);case Y:case Q:return new r(+t);case ot:case st:case at:case ut:case ht:case ct:case lt:case pt:case ft:var i=t.buffer;return new r(n?an(i):i,t.byteOffset,t.length);case J:case nt:return new r(t);case tt:var o=new r(t.source,zt.exec(t));o.lastIndex=t.lastIndex}return o}function Xn(t,e,n){null==t||tr(e,t)||(e=pr(e),t=1==e.length?t:Ne(t,Qe(e,0,-1)),e=Ar(e));var r=null==t?t:t[e];return null==r?I:r.apply(t,n)}function $n(t){return null!=t&&nr(Vs(t))}function Jn(t,e){return t="number"==typeof t||Dt.test(t)?+t:-1,e=null==e?zs:e,t>-1&&t%1==0&&e>t}function Zn(t,e,n){if(!Ni(n))return!1;var r=typeof e;if("number"==r?$n(n)&&Jn(e,n.length):"string"==r&&e in n){var i=n[e];return t===t?t===i:i!==i}return!1}function tr(t,e){var n=typeof t;if("string"==n&&It.test(t)||"number"==n)return!0;if(Sa(t))return!1;var r=!Et.test(t);return r||null!=e&&t in lr(e)}function er(t){var n=Vn(t);if(!(n in $.prototype))return!1;var r=e[n];if(t===r)return!0;var i=Bs(r);return!!i&&t===i[0]}function nr(t){return"number"==typeof t&&t>-1&&t%1==0&&zs>=t}function rr(t){return t===t&&!Ni(t)}function ir(t,e){var n=t[1],r=e[1],i=n|r,o=N>i,s=r==N&&n==O||r==N&&n==D&&t[7].length<=e[8]||r==(N|D)&&n==O;if(!o&&!s)return t;r&C&&(t[2]=e[2],i|=n&C?0:S);var a=e[3];if(a){var u=t[3];t[3]=u?un(u,a,e[4]):te(a),t[4]=u?y(t[3],q):te(e[4])}return a=e[5],a&&(u=t[5],t[5]=u?hn(u,a,e[6]):te(a),t[6]=u?y(t[5],q):te(e[6])),a=e[7],a&&(t[7]=te(a)),r&N&&(t[8]=null==t[8]?e[8]:Ts(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}function or(t,e){return t===I?e:Oa(t,e,or)}function sr(t,e){t=lr(t);for(var n=-1,r=e.length,i={};++n<r;){var o=e[n];o in t&&(i[o]=t[o])}return i}function ar(t,e){var n={};return Oe(t,function(t,r,i){e(t,r,i)&&(n[r]=t)}),n}function ur(t,e){for(var n=t.length,r=Ts(e.length,n),i=te(t);r--;){var o=e[r];t[r]=Jn(o,n)?i[o]:I}return t}function hr(t){for(var e=to(t),n=e.length,r=n&&t.length,i=!!r&&nr(r)&&(Sa(t)||Ii(t)),o=-1,s=[];++o<n;){var a=e[o];(i&&Jn(a,r)||es.call(t,a))&&s.push(a)}return s}function cr(t){return null==t?[]:$n(t)?Ni(t)?t:Yo(t):oo(t)}function lr(t){return Ni(t)?t:Yo(t)}function pr(t){if(Sa(t))return t;var e=[];return a(t).replace(At,function(t,n,r,i){e.push(r?i.replace(Ot,"$1"):n||t)}),e}function fr(t){return t instanceof $?t.clone():new _(t.__wrapped__,t.__chain__,te(t.__actions__))}function dr(t,e,n){e=(n?Zn(t,e,n):null==e)?1:xs(_s(e)||1,1);for(var r=0,i=t?t.length:0,o=-1,s=Bo(vs(i/e));i>r;)s[++o]=Qe(t,r,r+=e);return s}function gr(t){for(var e=-1,n=t?t.length:0,r=-1,i=[];++e<n;){var o=t[e];o&&(i[++r]=o)}return i}function vr(t,e,n){var r=t?t.length:0;return r?((n?Zn(t,e,n):null==e)&&(e=1),Qe(t,0>e?0:e)):[]}function mr(t,e,n){var r=t?t.length:0;return r?((n?Zn(t,e,n):null==e)&&(e=1),e=r-(+e||0),Qe(t,0,0>e?0:e)):[]}function _r(t,e,n){return t&&t.length?en(t,Bn(e,n,3),!0,!0):[]}function yr(t,e,n){return t&&t.length?en(t,Bn(e,n,3),!0):[]}function br(t,e,n,r){var i=t?t.length:0;return i?(n&&"number"!=typeof n&&Zn(t,e,n)&&(n=0,r=i),Ae(t,e,n,r)):[]}function wr(t){return t?t[0]:I}function xr(t,e,n){var r=t?t.length:0;return n&&Zn(t,e,n)&&(e=!1),r?Se(t,e):[]}function Tr(t){var e=t?t.length:0;return e?Se(t,!0):[]}function Er(t,e,n){var r=t?t.length:0;if(!r)return-1;if("number"==typeof n)n=0>n?xs(r+n,0):n;else if(n){var i=rn(t,e);return r>i&&(e===e?e===t[i]:t[i]!==t[i])?i:-1}return o(t,e,n||0)}function Ir(t){return mr(t,1)}function Ar(t){var e=t?t.length:0;return e?t[e-1]:I}function Cr(t,e,n){var r=t?t.length:0;if(!r)return-1;var i=r;if("number"==typeof n)i=(0>n?xs(r+n,0):Ts(n||0,r-1))+1;else if(n){i=rn(t,e,!0)-1;var o=t[i];return(e===e?e===o:o!==o)?i:-1}if(e!==e)return v(t,i,!0);for(;i--;)if(t[i]===e)return i;return-1}function Rr(){var t=arguments,e=t[0];
if(!e||!e.length)return e;for(var n=0,r=Hn(),i=t.length;++n<i;)for(var o=0,s=t[n];(o=r(e,s,o))>-1;)fs.call(e,o,1);return e}function Sr(t,e,n){var r=[];if(!t||!t.length)return r;var i=-1,o=[],s=t.length;for(e=Bn(e,n,3);++i<s;){var a=t[i];e(a,i,t)&&(r.push(a),o.push(i))}return je(t,o),r}function Or(t){return vr(t,1)}function Mr(t,e,n){var r=t?t.length:0;return r?(n&&"number"!=typeof n&&Zn(t,e,n)&&(e=0,n=r),Qe(t,e,n)):[]}function zr(t,e,n){var r=t?t.length:0;return r?((n?Zn(t,e,n):null==e)&&(e=1),Qe(t,0,0>e?0:e)):[]}function Lr(t,e,n){var r=t?t.length:0;return r?((n?Zn(t,e,n):null==e)&&(e=1),e=r-(+e||0),Qe(t,0>e?0:e)):[]}function Nr(t,e,n){return t&&t.length?en(t,Bn(e,n,3),!1,!0):[]}function Dr(t,e,n){return t&&t.length?en(t,Bn(e,n,3)):[]}function Ur(t,e,n,r){var i=t?t.length:0;if(!i)return[];null!=e&&"boolean"!=typeof e&&(r=n,n=Zn(t,e,r)?I:e,e=!1);var s=Bn();return(null!=n||s!==be)&&(n=s(n,r,3)),e&&Hn()==o?b(t,n):Ze(t,n)}function Pr(t){if(!t||!t.length)return[];var e=-1,n=0;t=ae(t,function(t){return $n(t)?(n=xs(t.length,n),!0):void 0});for(var r=Bo(n);++e<n;)r[e]=ue(t,He(e));return r}function Fr(t,e,n){var r=t?t.length:0;if(!r)return[];var i=Pr(t);return null==e?i:(e=sn(e,n,4),ue(i,function(t){return ce(t,e,I,!0)}))}function kr(){for(var t=-1,e=arguments.length;++t<e;){var n=arguments[t];if($n(n))var r=r?he(Te(r,n),Te(n,r)):n}return r?Ze(r):[]}function Gr(t,e){var n=-1,r=t?t.length:0,i={};for(!r||e||Sa(t[0])||(e=[]);++n<r;){var o=t[n];e?i[o]=e[n]:o&&(i[o[0]]=o[1])}return i}function Br(t){var n=e(t);return n.__chain__=!0,n}function Vr(t,e,n){return e.call(n,t),t}function Hr(t,e,n){return e.call(n,t)}function qr(){return Br(this)}function jr(){return new _(this.value(),this.__chain__)}function Wr(t){for(var e,r=this;r instanceof n;){var i=fr(r);e?o.__wrapped__=i:e=i;var o=i;r=r.__wrapped__}return o.__wrapped__=t,e}function Yr(){var t=this.__wrapped__,e=function(t){return n&&n.__dir__<0?t:t.reverse()};if(t instanceof $){var n=t;return this.__actions__.length&&(n=new $(this)),n=n.reverse(),n.__actions__.push({func:Hr,args:[e],thisArg:I}),new _(n,this.__chain__)}return this.thru(e)}function Qr(){return this.value()+""}function Kr(){return nn(this.__wrapped__,this.__actions__)}function Xr(t,e,n){var r=Sa(t)?oe:Ee;return n&&Zn(t,e,n)&&(e=I),("function"!=typeof e||n!==I)&&(e=Bn(e,n,3)),r(t,e)}function $r(t,e,n){var r=Sa(t)?ae:Ce;return e=Bn(e,n,3),r(t,e)}function Jr(t,e){return ia(t,ke(e))}function Zr(t,e,n,r){var i=t?Vs(t):0;return nr(i)||(t=oo(t),i=t.length),n="number"!=typeof n||r&&Zn(e,n,r)?0:0>n?xs(i+n,0):n||0,"string"==typeof t||!Sa(t)&&Vi(t)?i>=n&&t.indexOf(e,n)>-1:!!i&&Hn(t,e,n)>-1}function ti(t,e,n){var r=Sa(t)?ue:Fe;return e=Bn(e,n,3),r(t,e)}function ei(t,e){return ti(t,No(e))}function ni(t,e,n){var r=Sa(t)?ae:Ce;return e=Bn(e,n,3),r(t,function(t,n,r){return!e(t,n,r)})}function ri(t,e,n){if(n?Zn(t,e,n):null==e){t=cr(t);var r=t.length;return r>0?t[We(0,r-1)]:I}var i=-1,o=Yi(t),r=o.length,s=r-1;for(e=Ts(0>e?0:+e||0,r);++i<e;){var a=We(i,s),u=o[a];o[a]=o[i],o[i]=u}return o.length=e,o}function ii(t){return ri(t,Rs)}function oi(t){var e=t?Vs(t):0;return nr(e)?e:Ga(t).length}function si(t,e,n){var r=Sa(t)?pe:Ke;return n&&Zn(t,e,n)&&(e=I),("function"!=typeof e||n!==I)&&(e=Bn(e,n,3)),r(t,e)}function ai(t,e,n){if(null==t)return[];n&&Zn(t,e,n)&&(e=I);var r=-1;e=Bn(e,n,3);var i=Fe(t,function(t,n,i){return{criteria:e(t,n,i),index:++r,value:t}});return Xe(i,c)}function ui(t,e,n,r){return null==t?[]:(r&&Zn(e,n,r)&&(n=I),Sa(e)||(e=null==e?[]:[e]),Sa(n)||(n=null==n?[]:[n]),$e(t,e,n))}function hi(t,e){return $r(t,ke(e))}function ci(t,e){if("function"!=typeof e){if("function"!=typeof t)throw new Xo(H);var n=t;t=e,e=n}return t=bs(t=+t)?t:0,function(){return--t<1?e.apply(this,arguments):void 0}}function li(t,e,n){return n&&Zn(t,e,n)&&(e=I),e=t&&null==e?t.length:xs(+e||0,0),Pn(t,N,I,I,I,I,e)}function pi(t,e){var n;if("function"!=typeof e){if("function"!=typeof t)throw new Xo(H);var r=t;t=e,e=r}return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=I),n}}function fi(t,e,n){function r(){f&&as(f),h&&as(h),g=0,h=f=d=I}function i(e,n){n&&as(n),h=f=d=I,e&&(g=ga(),c=t.apply(p,u),f||h||(u=p=I))}function o(){var t=e-(ga()-l);0>=t||t>e?i(d,h):f=ps(o,t)}function s(){i(m,f)}function a(){if(u=arguments,l=ga(),p=this,d=m&&(f||!_),v===!1)var n=_&&!f;else{h||_||(g=l);var r=v-(l-g),i=0>=r||r>v;i?(h&&(h=as(h)),g=l,c=t.apply(p,u)):h||(h=ps(s,r))}return i&&f?f=as(f):f||e===v||(f=ps(o,e)),n&&(i=!0,c=t.apply(p,u)),!i||f||h||(u=p=I),c}var u,h,c,l,p,f,d,g=0,v=!1,m=!0;if("function"!=typeof t)throw new Xo(H);if(e=0>e?0:+e||0,n===!0){var _=!0;m=!1}else Ni(n)&&(_=!!n.leading,v="maxWait"in n&&xs(+n.maxWait||0,e),m="trailing"in n?!!n.trailing:m);return a.cancel=r,a}function di(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new Xo(H);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=t.apply(this,r);return n.cache=o.set(i,s),s};return n.cache=new di.Cache,n}function gi(t){if("function"!=typeof t)throw new Xo(H);return function(){return!t.apply(this,arguments)}}function vi(t){return pi(2,t)}function mi(t,e){if("function"!=typeof t)throw new Xo(H);return e=xs(e===I?t.length-1:+e||0,0),function(){for(var n=arguments,r=-1,i=xs(n.length-e,0),o=Bo(i);++r<i;)o[r]=n[e+r];switch(e){case 0:return t.call(this,o);case 1:return t.call(this,n[0],o);case 2:return t.call(this,n[0],n[1],o)}var s=Bo(e+1);for(r=-1;++r<e;)s[r]=n[r];return s[e]=o,t.apply(this,s)}}function _i(t){if("function"!=typeof t)throw new Xo(H);return function(e){return t.apply(this,e)}}function yi(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new Xo(H);return n===!1?r=!1:Ni(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),fi(t,e,{leading:r,maxWait:+e,trailing:i})}function bi(t,e){return e=null==e?Ro:e,Pn(e,z,I,[t],[])}function wi(t,e,n,r){return e&&"boolean"!=typeof e&&Zn(t,e,n)?e=!1:"function"==typeof e&&(r=n,n=e,e=!1),"function"==typeof n?we(t,e,sn(n,r,1)):we(t,e)}function xi(t,e,n){return"function"==typeof e?we(t,!0,sn(e,n,1)):we(t,!0)}function Ti(t,e){return t>e}function Ei(t,e){return t>=e}function Ii(t){return m(t)&&$n(t)&&es.call(t,"callee")&&!cs.call(t,"callee")}function Ai(t){return t===!0||t===!1||m(t)&&rs.call(t)==Y}function Ci(t){return m(t)&&rs.call(t)==Q}function Ri(t){return!!t&&1===t.nodeType&&m(t)&&!Gi(t)}function Si(t){return null==t?!0:$n(t)&&(Sa(t)||Vi(t)||Ii(t)||m(t)&&Li(t.splice))?!t.length:!Ga(t).length}function Oi(t,e,n,r){n="function"==typeof n?sn(n,r,3):I;var i=n?n(t,e):I;return i===I?De(t,e,n):!!i}function Mi(t){return m(t)&&"string"==typeof t.message&&rs.call(t)==K}function zi(t){return"number"==typeof t&&bs(t)}function Li(t){return Ni(t)&&rs.call(t)==X}function Ni(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Di(t,e,n,r){return n="function"==typeof n?sn(n,r,3):I,Pe(t,qn(e),n)}function Ui(t){return ki(t)&&t!=+t}function Pi(t){return null==t?!1:Li(t)?os.test(ts.call(t)):m(t)&&Nt.test(t)}function Fi(t){return null===t}function ki(t){return"number"==typeof t||m(t)&&rs.call(t)==J}function Gi(t){var e;if(!m(t)||rs.call(t)!=Z||Ii(t)||!es.call(t,"constructor")&&(e=t.constructor,"function"==typeof e&&!(e instanceof e)))return!1;var n;return Oe(t,function(t,e){n=e}),n===I||es.call(t,n)}function Bi(t){return Ni(t)&&rs.call(t)==tt}function Vi(t){return"string"==typeof t||m(t)&&rs.call(t)==nt}function Hi(t){return m(t)&&nr(t.length)&&!!Vt[rs.call(t)]}function qi(t){return t===I}function ji(t,e){return e>t}function Wi(t,e){return e>=t}function Yi(t){var e=t?Vs(t):0;return nr(e)?e?te(t):[]:oo(t)}function Qi(t){return ye(t,to(t))}function Ki(t,e,n){var r=Ds(t);return n&&Zn(t,e,n)&&(e=I),e?me(r,e):r}function Xi(t){return Le(t,to(t))}function $i(t,e,n){var r=null==t?I:Ne(t,pr(e),e+"");return r===I?n:r}function Ji(t,e){if(null==t)return!1;var n=es.call(t,e);if(!n&&!tr(e)){if(e=pr(e),t=1==e.length?t:Ne(t,Qe(e,0,-1)),null==t)return!1;e=Ar(e),n=es.call(t,e)}return n||nr(t.length)&&Jn(e,t.length)&&(Sa(t)||Ii(t))}function Zi(t,e,n){n&&Zn(t,e,n)&&(e=I);for(var r=-1,i=Ga(t),o=i.length,s={};++r<o;){var a=i[r],u=t[a];e?es.call(s,u)?s[u].push(a):s[u]=[a]:s[u]=a}return s}function to(t){if(null==t)return[];Ni(t)||(t=Yo(t));var e=t.length;e=e&&nr(e)&&(Sa(t)||Ii(t))&&e||0;for(var n=t.constructor,r=-1,i="function"==typeof n&&n.prototype===t,o=Bo(e),s=e>0;++r<e;)o[r]=r+"";for(var a in t)s&&Jn(a,e)||"constructor"==a&&(i||!es.call(t,a))||o.push(a);return o}function eo(t){t=lr(t);for(var e=-1,n=Ga(t),r=n.length,i=Bo(r);++e<r;){var o=n[e];i[e]=[o,t[o]]}return i}function no(t,e,n){var r=null==t?I:t[e];return r===I&&(null==t||tr(e,t)||(e=pr(e),t=1==e.length?t:Ne(t,Qe(e,0,-1)),r=null==t?I:t[Ar(e)]),r=r===I?n:r),Li(r)?r.call(t):r}function ro(t,e,n){if(null==t)return t;var r=e+"";e=null!=t[r]||tr(e,t)?[r]:pr(e);for(var i=-1,o=e.length,s=o-1,a=t;null!=a&&++i<o;){var u=e[i];Ni(a)&&(i==s?a[u]=n:null==a[u]&&(a[u]=Jn(e[i+1])?[]:{})),a=a[u]}return t}function io(t,e,n,r){var i=Sa(t)||Hi(t);if(e=Bn(e,r,4),null==n)if(i||Ni(t)){var o=t.constructor;n=i?Sa(t)?new o:[]:Ds(Li(o)?o.prototype:I)}else n={};return(i?ee:Me)(t,function(t,r,i){return e(n,t,r,i)}),n}function oo(t){return tn(t,Ga(t))}function so(t){return tn(t,to(t))}function ao(t,e,n){return e=+e||0,n===I?(n=e,e=0):n=+n||0,t>=Ts(e,n)&&t<xs(e,n)}function uo(t,e,n){n&&Zn(t,e,n)&&(e=n=I);var r=null==t,i=null==e;if(null==n&&(i&&"boolean"==typeof t?(n=t,t=1):"boolean"==typeof e&&(n=e,i=!0)),r&&i&&(e=1,i=!1),t=+t||0,i?(e=t,t=0):e=+e||0,n||t%1||e%1){var o=As();return Ts(t+o*(e-t+us("1e-"+((o+"").length-1))),e)}return We(t,e)}function ho(t){return t=a(t),t&&t.charAt(0).toUpperCase()+t.slice(1)}function co(t){return t=a(t),t&&t.replace(Ut,p).replace(St,"")}function lo(t,e,n){t=a(t),e+="";var r=t.length;return n=n===I?r:Ts(0>n?0:+n||0,r),n-=e.length,n>=0&&t.indexOf(e,n)==n}function po(t){return t=a(t),t&&bt.test(t)?t.replace(_t,f):t}function fo(t){return t=a(t),t&&Rt.test(t)?t.replace(Ct,d):t||"(?:)"}function go(t,e,n){t=a(t),e=+e;var r=t.length;if(r>=e||!bs(e))return t;var i=(e-r)/2,o=_s(i),s=vs(i);return n=Ln("",s,n),n.slice(0,o)+t+n}function vo(t,e,n){return(n?Zn(t,e,n):null==e)?e=0:e&&(e=+e),t=bo(t),Is(t,e||(Lt.test(t)?16:10))}function mo(t,e){var n="";if(t=a(t),e=+e,1>e||!t||!bs(e))return n;do e%2&&(n+=t),e=_s(e/2),t+=t;while(e);return n}function _o(t,e,n){return t=a(t),n=null==n?0:Ts(0>n?0:+n||0,t.length),t.lastIndexOf(e,n)==n}function yo(t,n,r){var i=e.templateSettings;r&&Zn(t,n,r)&&(n=r=I),t=a(t),n=ve(me({},r||n),i,ge);var o,s,u=ve(me({},n.imports),i.imports,ge),h=Ga(u),c=tn(u,h),l=0,p=n.interpolate||Pt,f="__p += '",d=Qo((n.escape||Pt).source+"|"+p.source+"|"+(p===Tt?Mt:Pt).source+"|"+(n.evaluate||Pt).source+"|$","g"),v="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++Bt+"]")+"\n";t.replace(d,function(e,n,r,i,a,u){return r||(r=i),f+=t.slice(l,u).replace(Ft,g),n&&(o=!0,f+="' +\n__e("+n+") +\n'"),a&&(s=!0,f+="';\n"+a+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+e.length,e}),f+="';\n";var m=n.variable;m||(f="with (obj) {\n"+f+"\n}\n"),f=(s?f.replace(dt,""):f).replace(gt,"$1").replace(vt,"$1;"),f="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var _=$a(function(){return qo(h,v+"return "+f).apply(I,c)});if(_.source=f,Mi(_))throw _;return _}function bo(t,e,n){var r=t;return(t=a(t))?(n?Zn(r,e,n):null==e)?t.slice(w(t),x(t)+1):(e+="",t.slice(u(t,e),h(t,e)+1)):t}function wo(t,e,n){var r=t;return t=a(t),t?(n?Zn(r,e,n):null==e)?t.slice(w(t)):t.slice(u(t,e+"")):t}function xo(t,e,n){var r=t;return t=a(t),t?(n?Zn(r,e,n):null==e)?t.slice(0,x(t)+1):t.slice(0,h(t,e+"")+1):t}function To(t,e,n){n&&Zn(t,e,n)&&(e=I);var r=U,i=P;if(null!=e)if(Ni(e)){var o="separator"in e?e.separator:o;r="length"in e?+e.length||0:r,i="omission"in e?a(e.omission):i}else r=+e||0;if(t=a(t),r>=t.length)return t;var s=r-i.length;if(1>s)return i;var u=t.slice(0,s);if(null==o)return u+i;if(Bi(o)){if(t.slice(s).search(o)){var h,c,l=t.slice(0,s);for(o.global||(o=Qo(o.source,(zt.exec(o)||"")+"g")),o.lastIndex=0;h=o.exec(l);)c=h.index;u=u.slice(0,null==c?s:c)}}else if(t.indexOf(o,s)!=s){var p=u.lastIndexOf(o);p>-1&&(u=u.slice(0,p))}return u+i}function Eo(t){return t=a(t),t&&yt.test(t)?t.replace(mt,T):t}function Io(t,e,n){return n&&Zn(t,e,n)&&(e=I),t=a(t),t.match(e||kt)||[]}function Ao(t,e,n){return n&&Zn(t,e,n)&&(e=I),m(t)?So(t):be(t,e)}function Co(t){return function(){return t}}function Ro(t){return t}function So(t){return ke(we(t,!0))}function Oo(t,e){return Ge(t,we(e,!0))}function Mo(t,e,n){if(null==n){var r=Ni(e),i=r?Ga(e):I,o=i&&i.length?Le(e,i):I;(o?o.length:r)||(o=!1,n=e,e=t,t=this)}o||(o=Le(e,Ga(e)));var s=!0,a=-1,u=Li(t),h=o.length;n===!1?s=!1:Ni(n)&&"chain"in n&&(s=n.chain);for(;++a<h;){var c=o[a],l=e[c];t[c]=l,u&&(t.prototype[c]=function(e){return function(){var n=this.__chain__;if(s||n){var r=t(this.__wrapped__),i=r.__actions__=te(this.__actions__);return i.push({func:e,args:arguments,thisArg:t}),r.__chain__=n,r}return e.apply(t,he([this.value()],arguments))}}(l))}return t}function zo(){return ne._=is,this}function Lo(){}function No(t){return tr(t)?He(t):qe(t)}function Do(t){return function(e){return Ne(t,pr(e),e+"")}}function Uo(t,e,n){n&&Zn(t,e,n)&&(e=n=I),t=+t||0,n=null==n?1:+n||0,null==e?(e=t,t=0):e=+e||0;for(var r=-1,i=xs(vs((e-t)/(n||1)),0),o=Bo(i);++r<i;)o[r]=t,t+=n;return o}function Po(t,e,n){if(t=_s(t),1>t||!bs(t))return[];var r=-1,i=Bo(Ts(t,Ss));for(e=sn(e,n,1);++r<t;)Ss>r?i[r]=e(r):e(r);return i}function Fo(t){var e=++ns;return a(t)+e}function ko(t,e){return(+t||0)+(+e||0)}function Go(t,e,n){return n&&Zn(t,e,n)&&(e=I),e=Bn(e,n,3),1==e.length?fe(Sa(t)?t:cr(t),e):Je(t,e)}t=t?re.defaults(ne.Object(),t,re.pick(ne,Gt)):ne;var Bo=t.Array,Vo=t.Date,Ho=t.Error,qo=t.Function,jo=t.Math,Wo=t.Number,Yo=t.Object,Qo=t.RegExp,Ko=t.String,Xo=t.TypeError,$o=Bo.prototype,Jo=Yo.prototype,Zo=Ko.prototype,ts=qo.prototype.toString,es=Jo.hasOwnProperty,ns=0,rs=Jo.toString,is=ne._,os=Qo("^"+ts.call(es).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ss=t.ArrayBuffer,as=t.clearTimeout,us=t.parseFloat,hs=jo.pow,cs=Jo.propertyIsEnumerable,ls=jn(t,"Set"),ps=t.setTimeout,fs=$o.splice,ds=t.Uint8Array,gs=jn(t,"WeakMap"),vs=jo.ceil,ms=jn(Yo,"create"),_s=jo.floor,ys=jn(Bo,"isArray"),bs=t.isFinite,ws=jn(Yo,"keys"),xs=jo.max,Ts=jo.min,Es=jn(Vo,"now"),Is=t.parseInt,As=jo.random,Cs=Wo.NEGATIVE_INFINITY,Rs=Wo.POSITIVE_INFINITY,Ss=4294967295,Os=Ss-1,Ms=Ss>>>1,zs=9007199254740991,Ls=gs&&new gs,Ns={};e.support={},e.templateSettings={escape:wt,evaluate:xt,interpolate:Tt,variable:"",imports:{_:e}};var Ds=function(){function t(){}return function(e){if(Ni(e)){t.prototype=e;var n=new t;t.prototype=I}return n||{}}}(),Us=pn(Me),Ps=pn(ze,!0),Fs=fn(),ks=fn(!0),Gs=Ls?function(t,e){return Ls.set(t,e),t}:Ro,Bs=Ls?function(t){return Ls.get(t)}:Lo,Vs=He("length"),Hs=function(){var t=0,e=0;return function(n,r){var i=ga(),o=k-(i-e);if(e=i,o>0){if(++t>=F)return n}else t=0;return Gs(n,r)}}(),qs=mi(function(t,e){return m(t)&&$n(t)?Te(t,Se(e,!1,!0)):[]}),js=xn(),Ws=xn(!0),Ys=mi(function(t){for(var e=t.length,n=e,r=Bo(l),i=Hn(),s=i==o,a=[];n--;){var u=t[n]=$n(u=t[n])?u:[];r[n]=s&&u.length>=120?gn(n&&u):null}var h=t[0],c=-1,l=h?h.length:0,p=r[0];t:for(;++c<l;)if(u=h[c],(p?$t(p,u):i(a,u,0))<0){for(var n=e;--n;){var f=r[n];if((f?$t(f,u):i(t[n],u,0))<0)continue t}p&&p.push(u),a.push(u)}return a}),Qs=mi(function(t,e){e=Se(e);var n=_e(t,e);return je(t,e.sort(r)),n}),Ks=Un(),Xs=Un(!0),$s=mi(function(t){return Ze(Se(t,!1,!0))}),Js=mi(function(t,e){return $n(t)?Te(t,e):[]}),Zs=mi(Pr),ta=mi(function(t){var e=t.length,n=e>2?t[e-2]:I,r=e>1?t[e-1]:I;return e>2&&"function"==typeof n?e-=2:(n=e>1&&"function"==typeof r?(--e,r):I,r=I),t.length=e,Fr(t,n,r)}),ea=mi(function(t){return t=Se(t),this.thru(function(e){return Zt(Sa(e)?e:[lr(e)],t)})}),na=mi(function(t,e){return _e(t,Se(e))}),ra=cn(function(t,e,n){es.call(t,n)?++t[n]:t[n]=1}),ia=wn(Us),oa=wn(Ps,!0),sa=In(ee,Us),aa=In(ie,Ps),ua=cn(function(t,e,n){es.call(t,n)?t[n].push(e):t[n]=[e]}),ha=cn(function(t,e,n){t[n]=e}),ca=mi(function(t,e,n){var r=-1,i="function"==typeof e,o=tr(e),s=$n(t)?Bo(t.length):[];return Us(t,function(t){var a=i?e:o&&null!=t?t[e]:I;s[++r]=a?a.apply(t,n):Xn(t,e,n)}),s}),la=cn(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),pa=Mn(ce,Us),fa=Mn(le,Ps),da=mi(function(t,e){if(null==t)return[];var n=e[2];return n&&Zn(e[0],e[1],n)&&(e.length=1),$e(t,Se(e),[])}),ga=Es||function(){return(new Vo).getTime()},va=mi(function(t,e,n){var r=C;if(n.length){var i=y(n,va.placeholder);r|=z}return Pn(t,r,e,n,i)}),ma=mi(function(t,e){e=e.length?Se(e):Xi(t);for(var n=-1,r=e.length;++n<r;){var i=e[n];t[i]=Pn(t[i],C,t)}return t}),_a=mi(function(t,e,n){var r=C|R;if(n.length){var i=y(n,_a.placeholder);r|=z}return Pn(e,r,t,n,i)}),ya=_n(O),ba=_n(M),wa=mi(function(t,e){return xe(t,1,e)}),xa=mi(function(t,e,n){return xe(t,e,n)}),Ta=En(),Ea=En(!0),Ia=mi(function(t,e){if(e=Se(e),"function"!=typeof t||!oe(e,s))throw new Xo(H);var n=e.length;return mi(function(r){for(var i=Ts(r.length,n);i--;)r[i]=e[i](r[i]);return t.apply(this,r)})}),Aa=On(z),Ca=On(L),Ra=mi(function(t,e){return Pn(t,D,I,I,I,Se(e))}),Sa=ys||function(t){return m(t)&&nr(t.length)&&rs.call(t)==W},Oa=ln(Be),Ma=ln(function(t,e,n){return n?ve(t,e,n):me(t,e)}),za=yn(Ma,de),La=yn(Oa,or),Na=Tn(Me),Da=Tn(ze),Ua=An(Fs),Pa=An(ks),Fa=Cn(Me),ka=Cn(ze),Ga=ws?function(t){var e=null==t?I:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&$n(t)?hr(t):Ni(t)?ws(t):[]}:hr,Ba=Rn(!0),Va=Rn(),Ha=mi(function(t,e){if(null==t)return{};if("function"!=typeof e[0]){var e=ue(Se(e),Ko);return sr(t,Te(to(t),e))}var n=sn(e[0],e[1],3);return ar(t,function(t,e,r){return!n(t,e,r)})}),qa=mi(function(t,e){return null==t?{}:"function"==typeof e[0]?ar(t,sn(e[0],e[1],3)):sr(t,Se(e))}),ja=vn(function(t,e,n){return e=e.toLowerCase(),t+(n?e.charAt(0).toUpperCase()+e.slice(1):e)}),Wa=vn(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Ya=Sn(),Qa=Sn(!0),Ka=vn(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Xa=vn(function(t,e,n){return t+(n?" ":"")+(e.charAt(0).toUpperCase()+e.slice(1))}),$a=mi(function(t,e){try{return t.apply(I,e)}catch(t){return Mi(t)?t:new Ho(t)}}),Ja=mi(function(t,e){return function(n){return Xn(n,t,e)}}),Za=mi(function(t,e){return function(n){return Xn(t,n,e)}}),tu=Dn("ceil"),eu=Dn("floor"),nu=bn(Ti,Cs),ru=bn(ji,Rs),iu=Dn("round");return e.prototype=n.prototype,_.prototype=Ds(n.prototype),_.prototype.constructor=_,$.prototype=Ds(n.prototype),$.prototype.constructor=$,jt.prototype.delete=Wt,jt.prototype.get=Yt,jt.prototype.has=Qt,jt.prototype.set=Kt,Xt.prototype.push=Jt,di.Cache=jt,e.after=ci,e.ary=li,e.assign=Ma,e.at=na,e.before=pi,e.bind=va,e.bindAll=ma,e.bindKey=_a,e.callback=Ao,e.chain=Br,e.chunk=dr,e.compact=gr,e.constant=Co,e.countBy=ra,e.create=Ki,e.curry=ya,e.curryRight=ba,e.debounce=fi,e.defaults=za,e.defaultsDeep=La,e.defer=wa,e.delay=xa,e.difference=qs,e.drop=vr,e.dropRight=mr,e.dropRightWhile=_r,e.dropWhile=yr,e.fill=br,e.filter=$r,e.flatten=xr,e.flattenDeep=Tr,e.flow=Ta,e.flowRight=Ea,e.forEach=sa,e.forEachRight=aa,e.forIn=Ua,e.forInRight=Pa,e.forOwn=Fa,e.forOwnRight=ka,e.functions=Xi,e.groupBy=ua,e.indexBy=ha,e.initial=Ir,e.intersection=Ys,e.invert=Zi,e.invoke=ca,e.keys=Ga,e.keysIn=to,e.map=ti,e.mapKeys=Ba,e.mapValues=Va,e.matches=So,e.matchesProperty=Oo,e.memoize=di,e.merge=Oa,e.method=Ja,e.methodOf=Za,e.mixin=Mo,e.modArgs=Ia,e.negate=gi,e.omit=Ha,e.once=vi,e.pairs=eo,e.partial=Aa,e.partialRight=Ca,e.partition=la,e.pick=qa,e.pluck=ei,e.property=No,e.propertyOf=Do,e.pull=Rr,e.pullAt=Qs,e.range=Uo,e.rearg=Ra,e.reject=ni,e.remove=Sr,e.rest=Or,e.restParam=mi,e.set=ro,e.shuffle=ii,e.slice=Mr,e.sortBy=ai,e.sortByAll=da,e.sortByOrder=ui,e.spread=_i,e.take=zr,e.takeRight=Lr,e.takeRightWhile=Nr,e.takeWhile=Dr,e.tap=Vr,e.throttle=yi,e.thru=Hr,e.times=Po,e.toArray=Yi,e.toPlainObject=Qi,e.transform=io,e.union=$s,e.uniq=Ur,e.unzip=Pr,e.unzipWith=Fr,e.values=oo,e.valuesIn=so,e.where=hi,e.without=Js,e.wrap=bi,e.xor=kr,e.zip=Zs,e.zipObject=Gr,e.zipWith=ta,e.backflow=Ea,e.collect=ti,e.compose=Ea,e.each=sa,e.eachRight=aa,e.extend=Ma,e.iteratee=Ao,e.methods=Xi,e.object=Gr,e.select=$r,e.tail=Or,e.unique=Ur,Mo(e,e),e.add=ko,e.attempt=$a,e.camelCase=ja,e.capitalize=ho,e.ceil=tu,e.clone=wi,e.cloneDeep=xi,e.deburr=co,e.endsWith=lo,e.escape=po,e.escapeRegExp=fo,e.every=Xr,e.find=ia,e.findIndex=js,e.findKey=Na,e.findLast=oa,e.findLastIndex=Ws,e.findLastKey=Da,e.findWhere=Jr,e.first=wr,e.floor=eu,e.get=$i,e.gt=Ti,e.gte=Ei,e.has=Ji,e.identity=Ro,e.includes=Zr,e.indexOf=Er,e.inRange=ao,e.isArguments=Ii,e.isArray=Sa,e.isBoolean=Ai,e.isDate=Ci,e.isElement=Ri,e.isEmpty=Si,e.isEqual=Oi,e.isError=Mi,e.isFinite=zi,e.isFunction=Li,e.isMatch=Di,e.isNaN=Ui,e.isNative=Pi,e.isNull=Fi,e.isNumber=ki,e.isObject=Ni,e.isPlainObject=Gi,e.isRegExp=Bi,e.isString=Vi,e.isTypedArray=Hi,e.isUndefined=qi,e.kebabCase=Wa,e.last=Ar,e.lastIndexOf=Cr,e.lt=ji,e.lte=Wi,e.max=nu,e.min=ru,e.noConflict=zo,e.noop=Lo,e.now=ga,e.pad=go,e.padLeft=Ya,e.padRight=Qa,e.parseInt=vo,e.random=uo,e.reduce=pa,e.reduceRight=fa,e.repeat=mo,e.result=no,e.round=iu,e.runInContext=E,e.size=oi,e.snakeCase=Ka,e.some=si,e.sortedIndex=Ks,e.sortedLastIndex=Xs,e.startCase=Xa,e.startsWith=_o,e.sum=Go,e.template=yo,e.trim=bo,e.trimLeft=wo,e.trimRight=xo,e.trunc=To,e.unescape=Eo,e.uniqueId=Fo,e.words=Io,e.all=Xr,e.any=si,e.contains=Zr,e.eq=Oi,e.detect=ia,e.foldl=pa,e.foldr=fa,e.head=wr,e.include=Zr,e.inject=pa,Mo(e,function(){var t={};return Me(e,function(n,r){e.prototype[r]||(t[r]=n)}),t}(),!1),e.sample=ri,e.prototype.sample=function(t){return this.__chain__||null!=t?this.thru(function(e){return ri(e,t)}):ri(this.value())},e.VERSION=A,ee(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){e[t].placeholder=e}),ee(["drop","take"],function(t,e){$.prototype[t]=function(n){var r=this.__filtered__;if(r&&!e)return new $(this);n=null==n?1:xs(_s(n)||0,0);var i=this.clone();return r?i.__takeCount__=Ts(i.__takeCount__,n):i.__views__.push({size:n,type:t+(i.__dir__<0?"Right":"")}),i},$.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),ee(["filter","map","takeWhile"],function(t,e){var n=e+1,r=n!=V;$.prototype[t]=function(t,e){var i=this.clone();return i.__iteratees__.push({iteratee:Bn(t,e,1),type:n}),i.__filtered__=i.__filtered__||r,i}}),ee(["first","last"],function(t,e){var n="take"+(e?"Right":"");$.prototype[t]=function(){return this[n](1).value()[0]}}),ee(["initial","rest"],function(t,e){var n="drop"+(e?"":"Right");$.prototype[t]=function(){return this.__filtered__?new $(this):this[n](1)}}),ee(["pluck","where"],function(t,e){var n=e?"filter":"map",r=e?ke:No;$.prototype[t]=function(t){return this[n](r(t))}}),$.prototype.compact=function(){return this.filter(Ro)},$.prototype.reject=function(t,e){return t=Bn(t,e,1),this.filter(function(e){return!t(e)})},$.prototype.slice=function(t,e){t=null==t?0:+t||0;var n=this;return n.__filtered__&&(t>0||0>e)?new $(n):(0>t?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==I&&(e=+e||0,n=0>e?n.dropRight(-e):n.take(e-t)),n)},$.prototype.takeRightWhile=function(t,e){return this.reverse().takeWhile(t,e).reverse()},$.prototype.toArray=function(){return this.take(Rs)},Me($.prototype,function(t,n){var r=/^(?:filter|map|reject)|While$/.test(n),i=/^(?:first|last)$/.test(n),o=e[i?"take"+("last"==n?"Right":""):n];o&&(e.prototype[n]=function(){var e=i?[1]:arguments,n=this.__chain__,s=this.__wrapped__,a=!!this.__actions__.length,u=s instanceof $,h=e[0],c=u||Sa(s);c&&r&&"function"==typeof h&&1!=h.length&&(u=c=!1);var l=function(t){return i&&n?o(t,1)[0]:o.apply(I,he([t],e))},p={func:Hr,args:[l],thisArg:I},f=u&&!a;if(i&&!n)return f?(s=s.clone(),s.__actions__.push(p),t.call(s)):o.call(I,this.value())[0];if(!i&&c){s=f?s:new $(this);var d=t.apply(s,e);return d.__actions__.push(p),new _(d,n)}return this.thru(l)})}),ee(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(t){var n=(/^(?:replace|split)$/.test(t)?Zo:$o)[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:join|pop|replace|shift)$/.test(t);e.prototype[t]=function(){var t=arguments;return i&&!this.__chain__?n.apply(this.value(),t):this[r](function(e){return n.apply(e,t)})}}),Me($.prototype,function(t,n){var r=e[n];if(r){var i=r.name,o=Ns[i]||(Ns[i]=[]);o.push({name:n,func:r})}}),Ns[zn(I,R).name]=[{name:"wrapper",func:I}],$.prototype.clone=et,$.prototype.reverse=rt,$.prototype.value=qt,e.prototype.chain=qr,e.prototype.commit=jr,e.prototype.concat=ea,e.prototype.plant=Wr,e.prototype.reverse=Yr,e.prototype.toString=Qr,e.prototype.run=e.prototype.toJSON=e.prototype.valueOf=e.prototype.value=Kr,e.prototype.collect=e.prototype.map,e.prototype.head=e.prototype.first,e.prototype.select=e.prototype.filter,e.prototype.tail=e.prototype.rest,e}var I,A="3.10.0",C=1,R=2,S=4,O=8,M=16,z=32,L=64,N=128,D=256,U=30,P="...",F=150,k=16,G=200,B=1,V=2,H="Expected a function",q="__lodash_placeholder__",j="[object Arguments]",W="[object Array]",Y="[object Boolean]",Q="[object Date]",K="[object Error]",X="[object Function]",$="[object Map]",J="[object Number]",Z="[object Object]",tt="[object RegExp]",et="[object Set]",nt="[object String]",rt="[object WeakMap]",it="[object ArrayBuffer]",ot="[object Float32Array]",st="[object Float64Array]",at="[object Int8Array]",ut="[object Int16Array]",ht="[object Int32Array]",ct="[object Uint8Array]",lt="[object Uint8ClampedArray]",pt="[object Uint16Array]",ft="[object Uint32Array]",dt=/\b__p \+= '';/g,gt=/\b(__p \+=) '' \+/g,vt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,mt=/&(?:amp|lt|gt|quot|#39|#96);/g,_t=/[&<>"'`]/g,yt=RegExp(mt.source),bt=RegExp(_t.source),wt=/<%-([\s\S]+?)%>/g,xt=/<%([\s\S]+?)%>/g,Tt=/<%=([\s\S]+?)%>/g,Et=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,It=/^\w*$/,At=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,Ct=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,Rt=RegExp(Ct.source),St=/[\u0300-\u036f\ufe20-\ufe23]/g,Ot=/\\(\\)?/g,Mt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,zt=/\w*$/,Lt=/^0[xX]/,Nt=/^\[object .+?Constructor\]$/,Dt=/^\d+$/,Ut=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Pt=/($^)/,Ft=/['\n\r\u2028\u2029\\]/g,kt=function(){var t="[A-Z\\xc0-\\xd6\\xd8-\\xde]",e="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(t+"+(?="+t+e+")|"+t+"?"+e+"|"+t+"+|[0-9]+","g")}(),Gt=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],Bt=-1,Vt={};Vt[ot]=Vt[st]=Vt[at]=Vt[ut]=Vt[ht]=Vt[ct]=Vt[lt]=Vt[pt]=Vt[ft]=!0,Vt[j]=Vt[W]=Vt[it]=Vt[Y]=Vt[Q]=Vt[K]=Vt[X]=Vt[$]=Vt[J]=Vt[Z]=Vt[tt]=Vt[et]=Vt[nt]=Vt[rt]=!1;var Ht={};Ht[j]=Ht[W]=Ht[it]=Ht[Y]=Ht[Q]=Ht[ot]=Ht[st]=Ht[at]=Ht[ut]=Ht[ht]=Ht[J]=Ht[Z]=Ht[tt]=Ht[nt]=Ht[ct]=Ht[lt]=Ht[pt]=Ht[ft]=!0,Ht[K]=Ht[X]=Ht[$]=Ht[et]=Ht[rt]=!1;var qt={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},jt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Wt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Yt={function:!0,object:!0},Qt={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},Kt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Xt=Yt[typeof n]&&n&&!n.nodeType&&n,$t=Yt[typeof e]&&e&&!e.nodeType&&e,Jt=Xt&&$t&&"object"==typeof t&&t&&t.Object&&t,Zt=Yt[typeof self]&&self&&self.Object&&self,te=Yt[typeof window]&&window&&window.Object&&window,ee=$t&&$t.exports===Xt&&Xt,ne=Jt||te!==(this&&this.window)&&te||Zt||this,re=E();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(ne._=re,define(function(){return re})):Xt&&$t?ee?($t.exports=re)._=re:Xt._=re:ne._=re}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],153:[function(t,e,n){var r,i,o,s,a,u,h,c,l,p,f,d,g,v=function(t,e){function n(){this.constructor=t}for(var r in e)m.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},m={}.hasOwnProperty;u=t("famous"),f=t("lightsaber"),h=f.json,c=f.log,l=f.p,p=f.pjson,r=u.domRenderables.DOMElement,o=u.core.Node,d=Math.sin,a=Math.cos,g=Math.sqrt,s=Math.abs,i=function(t){function e(t){var n,i,o,s;if(e.__super__.constructor.apply(this,arguments),this.start=t.start,this.end=t.end,null==this.start||null==this.end)throw new Error("Missing start [ID: "+(null!=(n=this.start)?n.id:void 0)+"] and/or end [ID: "+(null!=(i=this.end)?i.id:void 0)+"] in 'args' ");this.id=(null!=(o=this.start)?o.id:void 0)+" -> "+(null!=(s=this.end)?s.id:void 0),this.setOrigin(.5,.5,.5),this.setMountPoint(.5,.5,.5),this.setAlign(.5,.5,.5),this.setSizeMode("absolute","absolute","absolute"),this.setPosition(this.start.x,this.start.y,this.start.z-100),this.setRotation(0,0,this.end.angle),this.length=g((this.start.x-this.end.x)*(this.start.x-this.end.x)+(this.start.y-this.end.y)*(this.start.y-this.end.y)),this.curve=this.length/9,new r(this,{content:this.svgCurve()})}return v(e,t),e.prototype.svgCurve=function(){var t,e;return t="M\n  0 0\nC\n  "+this.curve+"     "+this.curve+",\n  "+(this.length-this.curve)+" "+this.curve+",\n  "+this.length+"    0",e='<svg>\n  <path\n    d="'+t+'"\n    stroke="#73BAE7"\n    stroke-opacity="0.2"\n    stroke-width="5"\n    fill="transparent"\n  />\n</svg>',e.replace(/\s+/g," ")},e}(o),e.exports=i},{famous:46,lightsaber:141}],154:[function(t,e,n){var r,i,o,s,a,u,h,c,l,p,f,d,g,v=function(t,e){function n(){this.constructor=t}for(var r in e)m.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},m={}.hasOwnProperty;u=t("famous"),f=t("lightsaber"),h=f.json,c=f.log,l=f.p,p=f.pjson,r=u.domRenderables.DOMElement,i=u.core.Node,d=Math.sin,a=Math.cos,g=Math.sqrt,s=Math.abs,o=function(t){function e(t){var n;if(e.__super__.constructor.apply(this,arguments),this.x=t.x,this.y=t.y,this.z=t.z,this.radius=t.radius,this.angle=t.angle,this.size=t.size,this.id=t.id,null==this.id)throw new Error;if(null==this.z&&(this.z=0),0===this.radius&&(this.angle=0),null!=this.radius&&null!=this.angle){if(null!=this.x||null!=this.y)throw new Error;this.x=this.radius*a(this.angle),this.y=this.radius*d(this.angle)}null==this.size&&(this.size=this.defaultSize),this.setOrigin(.5,.5,.5),this.setMountPoint(.5,.5,.5),this.setAlign(.5,.5,.5),this.setSizeMode("absolute","absolute","absolute"),this.setAbsoluteSize(this.size,this.size,this.size),this.setPosition(this.x,this.y,this.z),new r(this,{content:this.svgDot()}),n=this.addChild(),new r(n,{content:this.id,opacity:.9,properties:{color:"#9FDAFF",textAlign:"left",lineHeight:this.size+"px",fontFamily:"Open Sans",marginLeft:this.size+"px",paddingLeft:"5px"}})}return v(e,t),e.prototype.defaultSize=50,e.prototype.svgDot=function(){var t;return t='<svg style="position: relative; top: -50%; left: -50%;">\n  <defs>\n    <filter id="glow" filterUnits="userSpaceOnUse" x="0%" y="0%" width="140%" height="140%">\n      <feOffset result="offOut" in="SourceGraphic" dx="0" dy="0" />\n      <feGaussianBlur result="blurOut" in="offOut" stdDeviation="10" />\n      <feBlend in="SourceGraphic" in2="blurOut" mode="normal" />\n    </filter>\n  </defs>\n  <circle\n    cx="'+this.size+'"\n    cy="'+this.size+'"\n    r="'+this.size/2+'"\n    fill="#9DDCFA"\n    filter="url(#glow)"\n  />\n</svg>',
t.replace(/\s+/g," ")},e}(i),e.exports=o},{famous:46,lightsaber:141}],155:[function(t,e,n){var r,i,o,s,a=function(t,e){return function(){return t.apply(e,arguments)}};s=t("famous"),r=s.core.FamousEngine,i=t("../layouts/spiral"),o=function(){function t(){this.add=a(this.add,this);var t;r.init(),t=r.createScene(),this.sceneRoot=t.addChild()}return t.prototype.spiralLayout=function(t){return null==t.add&&(t.add=this.add),new i(t)},t.prototype.add=function(t){return this.sceneRoot.addChild(t)},t}(),e.exports=o},{"../layouts/spiral":157,famous:46}],156:[function(t,e,n){var r,i,o,s,a,u,h,c,l,p,f;p=t("lightsaber"),s=p.json,a=p.log,c=p.p,l=p.pjson,r=t("./core/world"),f="id0",h=function(){var t,e;for(e=[],o=t=0;36>=t;o=++t)e.push({id:"id"+o});return e}(),i=function(){var t,e,n;for(n=[],t=0,e=h.length;e>t;t++)u=h[t],n.push({start:f,end:u.id});return n}(),(new r).spiralLayout({rootNodeId:f,nodes:h,edges:i})},{"./core/world":155,lightsaber:141}],157:[function(t,e,n){var r,i,o,s,a,u,h,c,l,p,f,d,g,v,m,_,y,b,w,x,T,E,I,A,C,R,S,O=[].slice;E=t("lightsaber"),_=E.json,y=E.log,w=E.p,x=E.pjson,I=t("lodash"),v=I.defaults,m=I.find,b=I.merge,c=t("../core/node"),o=t("../core/edge"),S=Math.PI,f=Math.abs,d=Math.cos,T=Math.pow,A=Math.round,C=Math.sin,R=Math.sqrt,r=2*S,h=.75*r,l=100,u=.5*l,a=6,s=T(10,5),i=0,g=function(){var t;return t=1<=arguments.length?O.call(arguments,0):[],i?console.debug.apply(console,t):void 0},p=function(){function t(t){var e;this.add=function(){if(null!=(e=t.add))return e;throw new Error}(),this.iterations=0,this.nodes={},this.layout(t)}return t.prototype.layout=function(t){var e,n,r,i,s,a,u,h,c,l,p,f,d,g;for(f=t.rootNodeId?function(){if(null!=(h=m(t.nodes,{id:t.rootNodeId})))return h;throw new Error("input.nodes does not contain node wih ID "+t.rootNodeId)}():t.nodes[0],this.addNode(v(f,{radius:0})),c=t.edges,i=0,a=c.length;a>i;i++)e=c[i],g=e.start,r=e.end,g===f.id&&this.unknownNode(r)&&this.addNode({id:r});for(l=t.edges,p=[],s=0,u=l.length;u>s;s++)e=l[s],d=this.getNode(e.start),n=this.getNode(e.end),p.push(this.add(new o({start:d,end:n})));return p},t.prototype.addNode=function(t){var e;return null==t.radius&&(t=b(t,this.nextAvailableLocation())),e=new c(t),this.saveNode(e),this.add(e)},t.prototype.nextAvailableLocation=function(){if(this.iterations++>s)throw new Error;return this.incrementLocation(),this.available()?{radius:this.radius,angle:this.angle}:this.nextAvailableLocation()},t.prototype.available=function(){var t,e,n,r;r=this.rectangular(this.radius,this.angle),n=this.nodes;for(t in n)if(e=n[t],f(r.x-e.x)<u&&f(r.y-e.y)<u)return!1;return!0},t.prototype.incrementLocation=function(){return null==this.ring&&(this.ring=this.incrementRing()),null==this.angle&&(this.angle=h),this.angle<h+r?this.angle+=r/this.nodes_in_this_ring:(this.incrementRing(),this.angle=h)},t.prototype.incrementRing=function(){return this.ring=null!=this.ring?this.ring+1:1,this.radius=this.ring*l,this.nodes_in_this_ring=this.ring*a,this.ring},t.prototype.rectangular=function(t,e){var n,r;if(null==t||null==e)throw new Error;return n=t*d(e),r=t*C(e),{x:n,y:r}},t.prototype.saveNode=function(t){if(null!=this.nodes[t.id])throw new Error("Node with ID "+t.id+" already exists in @nodes");return this.nodes[t.id]=t},t.prototype.getNode=function(t){return this.nodes[t]||function(){throw new Error("unknown node "+t)}()},t.prototype.knownNode=function(t){return null!=this.nodes[t]},t.prototype.unknownNode=function(t){return!this.knownNode(t)},t}(),e.exports=p},{"../core/edge":153,"../core/node":154,lightsaber:141,lodash:152}]},{},[156]);
